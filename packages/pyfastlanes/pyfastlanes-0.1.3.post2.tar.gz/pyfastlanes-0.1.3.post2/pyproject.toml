[build-system]
requires = [
    # Backend and native‑code helpers
    "scikit-build-core>=0.11,<0.12",
    "cmake>=3.22",
    "ninja; platform_system != 'Windows'",
    # Packaging extras
    "setuptools>=42",
    "wheel",
    "setuptools_scm[toml]>=7,<8",
    # C++/Python bindings
    "pybind11>=2.12,<2.13",
]
build-backend = "scikit_build_core.build"

[project]
name = "pyfastlanes"
version = "0.1.3.post2"
description = "FastLanes File Format"
readme = { file = "README.md", content-type = "text/markdown" }
authors = [{ name = "Azim Afroozeh", email = "azim@cwi.nl" }]
requires-python = ">=3.8"
license = { file = "LICENSE" }
keywords = ["fastlanes", "file-format"]

[tool.setuptools-scm]
version_scheme = "release-branch-semver"

[tool.setuptools.packages.find]
# your Python package lives under the python/ folder
where = ["python"]
include = ["pyfastlanes*"]

[tool.scikit-build]
build-dir = "skbuild-editable"
editable.mode = "redirect"

# CMake flags used for *every* build (editable, wheel, etc.)
cmake.args = [
    "-DFLS_BUILD_PYTHON=ON",
    "-DFLS_ENABLE_CLANG_TIDY=OFF",
    "-DFLS_ENABLE_VERBOSE_OUTPUT=ON"
]

# ⚡️  Skip heavyweight or irrelevant paths when creating the sdist
sdist.exclude = [
    # CMake & scikit‑build output
    "cmake-build-*",
    "build",
    "dist",
    "skbuild-editable",
    # Large data, benchmarks, generated code
    "benchmark",
    "data",
    "scripts/generated_*",
    # Local tooling / IDE
    ".venv",
    ".idea",
    # Generic cruft
    "**/__pycache__",
    "*.so",
]

[tool.scikit-build.wheel]
license-files = ["LICENSE"]

[tool.cibuildwheel]
test-command = "pytest -q tests"
