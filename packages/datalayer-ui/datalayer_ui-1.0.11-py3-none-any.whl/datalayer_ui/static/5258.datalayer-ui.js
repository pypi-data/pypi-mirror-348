"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5258],{46916:(e,t,n)=>{n.d(t,{E:()=>l});var a=n(71791),s=n(99180),r=n(38621),i=n(9387),o=n(18683);function l(e){const{commandRegistry:t,runtimeDesc:n,save:l,sessionConnection:c}=e,[d,u]=(0,i.useState)();return(0,i.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.Q,{variant:"invisible",size:"small",leadingVisual:r.udU,disabled:!n?.location||"busy"===d,onClick:e=>t?.execute(a.nx.runAll),children:"Run all"}),(0,o.jsx)(s.Q,{variant:"invisible",size:"small",leadingVisual:r.wFz,disabled:!n?.location||"busy"!==d,onClick:e=>t?.execute(a.nx.interrupt),children:"Interrupt"})]})}},64991:(e,t,n)=>{n.d(t,{w:()=>i});var a=n(49370),s=n(320),r=n(63711);const i=(e="api/ai-agents/v1")=>{const{configuration:t}=(0,s._O)(),{requestRun:n}=(0,a.X)({notifyOnError:!1});return{createAIAgent:(a,s,i,o,l,{signal:c,baseUrl:d=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,d,"agents"),method:"POST",body:{room_id:a,room_type:s,runtime:{ingress:i,token:o,kernel_id:l}},signal:c}),getAIAgents:({signal:a,baseUrl:s=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,s,"agents"),method:"GET",signal:a}),deleteAIAgent:(a,{signal:s,baseUrl:i=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,i,"agents",a),method:"DELETE",signal:s}),getAIAgent:(a,{signal:s,baseUrl:i=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,i,"agents",a),method:"GET",signal:s}),patchAIAgent:(a,s,i,o,{signal:l,baseUrl:c=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,c,"agents",a),method:"PATCH",body:{runtime:s&&i&&o?{ingress:s,token:i,kernel_id:o}:null},signal:l})}}},81390:(e,t,n)=>{n.d(t,{Ks:()=>i});var a=n(97283),s=n(7282);const r=(0,a.y)((e=>({aiAgents:[],addAIAgent:t=>{e((e=>e.aiAgents.includes(t)?{}:{aiAgents:e.aiAgents.concat([t])}))},deleteAIAgent:t=>{e((e=>({aiAgents:e.aiAgents.filter((e=>e.documentId===t))})))},updateAIAgent:(t,n)=>{e((e=>{const a=e.aiAgents.findIndex((e=>e.documentId===t));return a>=0?(e.aiAgents[a].runtimeId=n,{aiAgents:[...e.aiAgents]}):{}}))}})));function i(e){return(0,s.Pj)(r,e)}},85258:(e,t,n)=>{n.r(t),n.d(t,{NotebookEdit:()=>st,default:()=>rt});var a=n(9387),s=n(20568),r=n(51671),i=n(97789),o=n(16950),l=n(3345),c=n(7856),d=n(99180),u=n(93054),m=n(48453),p=n(64315),h=n(24860),g=n(92243),f=n(3556),x=n(80006),v=n(38621),b=n(42389),j=n(16476),y=n(2159),C=n(5700),k=n(2606),w=n(72217),A=n(9403),S=n(18683);const _=e=>{const{data:t,fileName:n,variant:a,extension:s}=e;return(0,S.jsx)(d.Q,{variant:a,leadingVisual:v.s3U,onClick:e=>(0,A.xD)(t,n,s),children:"Download"})};_.defaultProps={variant:"default",name:"data",extension:"json"};var I=n(154),N=n(50596),R=n(88106),T=n(59179),D=n(5279),E=n(9175),P=n(98754),U=n(65047),M=n(80736),$=n(63948),L=n(43),F=n(50787),z=n(51857),V=function(e){return e[e.None=0]="None",e[e.New=1]="New",e[e.Transfer=2]="Transfer",e}(V||{});function O(e){const{assignKernel:t,sessionConnection:n}=e,{remoteKernels:s,multiServiceManager:r,jupyterLabAdapter:i}=(0,z.xb)(),[o,l]=(0,a.useState)(),[c,u]=(0,a.useState)({}),[m,p]=(0,a.useState)(V.None),[h,g]=(0,a.useState)("");(0,a.useEffect)((()=>{if(n){function e(e){g(`Runtime ${e.kernel?.connectionStatus} - Status: ${e.kernel?.status}`)}return e(n),n?.statusChanged.connect(e),n?.connectionStatusChanged.connect(e),()=>{n?.statusChanged.disconnect(e),n?.connectionStatusChanged.disconnect(e)}}g("No kernel")}),[n]);const f=(0,a.useCallback)((async()=>{r?.remote?.kernels&&await r.remote.kernels.refresh()}),[r?.remote?.kernels]),x=(0,a.useCallback)((()=>{p(V.New)}),[]),b=(0,a.useCallback)((e=>{if(e)switch(m){case V.New:f().then((()=>{l("remote"),t({runtimeDesc:e,kernelModel:r?.remote?.kernels.get().find((t=>t.id===e.id))})}));break;case V.Transfer:l("remote"),t({runtimeDesc:e,transferState:!0})}p(V.None)}),[f,r?.remote,m]);return(0,a.useEffect)((()=>{i?Promise.all([i.jupyterLab.resolveOptionalService(D.co),i.jupyterLab.resolveOptionalService(T.zG)]).then((e=>{u({[D.co.name]:e[0],[T.zG.name]:e[1]})})):u({})}),[i]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(E.W,{children:[(0,S.jsx)(E.W.Button,{leadingVisual:()=>{switch(o){case"browser":return(0,S.jsx)($.A,{});case"remote":return(0,S.jsx)(v.hpF,{});case void 0:return(0,S.jsx)(v.bMW,{})}return(0,S.jsx)(I.Cx,{type:"runtime"})},trailingVisual:()=>n?(0,S.jsx)(P.A,{sx:{paddingTop:"5px"},children:(0,S.jsx)(R.T1,{kernel:n.kernel})}):(0,S.jsx)(S.Fragment,{}),size:"small",variant:"invisible",children:(0,S.jsx)(U.m,{text:h,direction:"s",children:(0,S.jsx)(d.Q,{variant:"invisible",size:"small",children:n?.kernel?.name??"Runtimes"})})}),(0,S.jsx)(E.W.Overlay,{width:"medium",children:(0,S.jsxs)(M.l,{selectionVariant:"single",showDividers:!0,children:[(0,S.jsxs)(M.l.Group,{children:[(0,S.jsxs)(M.l.Item,{selected:void 0===o&&void 0===n,onSelect:()=>{l(void 0),t({runtimeDesc:void 0})},children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)(v.bMW,{})}),"Viewer",(0,S.jsx)(M.l.Description,{variant:"block",children:"A simple Notebook Viewer without Runtime."})]}),(0,S.jsxs)(M.l.Item,{selected:"browser"===o,onSelect:()=>{l("browser"),t({runtimeDesc:{name:"pyodide",location:"browser",language:"python"}})},children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)($.A,{})}),"Browser Runtime",(0,S.jsx)(M.l.Description,{variant:"block",children:"A Browser Runtime based on Pyodide."})]})]}),s.length>0&&(0,S.jsxs)(M.l.Group,{children:[(0,S.jsx)(M.l.GroupHeading,{children:"Cloud Runtimes"}),s.map((e=>(0,S.jsxs)(M.l.Item,{selected:n?.kernel?.id===e.id,onSelect:()=>{l("remote"),t({runtimeDesc:{name:e.environment_name,language:"",location:"remote",displayName:e.kernel_given_name,id:e.id,burningRate:e.burning_rate,podName:e.jupyter_pod_name},kernelModel:e})},children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)(I.Cx,{type:"runtime"})}),e.kernel_given_name,(0,S.jsx)(M.l.Description,{variant:"block",children:e.environment_name})]},e.id)))]}),(0,S.jsx)(M.l.Divider,{}),(0,S.jsxs)(M.l.Group,{children:[(0,S.jsxs)(M.l.Item,{selected:!1,onSelect:x,children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)(L.A,{})}),"Launch a new Runtime…"]}),(0,S.jsxs)(M.l.Item,{disabled:"browser"!==o,selected:!1,onSelect:()=>{p(V.Transfer)},title:"Transfer the state of the current Runtime to a new Remote Runtime.",children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)(v.e0J,{})}),"Transfer state to a new Runtime…"]})]})]})})]}),r?.remote&&m>0&&(0,S.jsx)(F.s,{dialogTitle:m===V.Transfer?"Switch to a new Cloud Runtime":void 0,manager:r.remote,onSubmit:b,markdownParser:c[D.co.name],sanitizer:c[T.zG.name],startKernel:m===V.Transfer?"defer":m===V.New})]})}var W=n(59651),G=n(46343),B=n(11471),K=n(48370),Q=n(10680),H=n(71623),q=n(97734),J=n(24991),X=n(47775),Y=n(61783);function Z(e){const{children:t,connection:n,podName:s,multiServiceManager:r,disabled:i}=e,{addKernelSnapshot:o,jupyterRunUrl:l,kernelSnapshots:c,setKernelSnapshots:d}=(0,z.xb)(),{trackAsyncTask:u}=(0,q.d)(),[m,h]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!1),[x,v]=(0,a.useState)(!1),[b,j]=(0,a.useState)(c[0]?.id??""),[y,C]=(0,a.useState)();(0,a.useEffect)((()=>{(0,J.v2)().then((e=>{d(e),!b&&e.length>0&&j(e[0].id)})).catch((e=>{console.error(`Failed to fetch remote kernel snapshots; ${e}`)}))}),[l]);const k=(0,a.useCallback)((()=>{C(void 0),h(!0)}),[]),w=(0,a.useCallback)((e=>{j(e.target.value)}),[]),A=(0,a.useCallback)((async({id:e,connection:t,podName:n})=>{n?await(0,J.Wm)({id:n,from:e}):t&&await(0,X.M)({connection:t,id:e})}),[]),_=(0,a.useCallback)((async()=>{try{let e,t;v(!0);let a="",i="";if(s&&r?.remote)i=(0,Y.m)("cloud"),t=r.remote.kernels.snapshot({podName:s,name:i,description:i,stop:!1}),a=s.split("-",2).reverse()[0],t.then((t=>{e=t}));else if(n&&r?.browser){const s=n.model;a=s.id,i=(0,Y.m)("browser");let o=!0;t=(0,X._)({connection:r.browser.kernels.connectTo({model:s}),metadata:{filename:`${i}.data`},onUploadProgress:()=>{o&&(o=!1,(0,J.v2)().then((t=>{e=t.find((e=>e.name===i))})))}})}t&&(u(t,{error:{message:(e,t)=>"Empty snapshot"===e?`Runtime ${a} will not be snapshotted as it does not contain any serializable state.`:`Failed to pause runtime ${a} - ${e}`},pending:{message:`Taking a snapshot of runtime ${a}…`},success:{message:()=>`Runtime ${a} successfully snapshotted as ${i}.`}}),await t,e&&o(e))}finally{v(!1)}}),[n,s,r]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(E.W,{children:[(0,S.jsx)(E.W.Button,{leadingVisual:G.A,variant:"invisible",size:"small",disabled:g||x||i,children:t}),(0,S.jsx)(E.W.Overlay,{children:(0,S.jsxs)(M.l,{children:[(0,S.jsx)(M.l.Item,{onSelect:k,disabled:g||0===c.length,children:"Load a runtime snapshot…"}),(0,S.jsx)(M.l.Item,{onSelect:_,disabled:x,children:"Take a runtime snapshot"})]})})]}),m&&(0,S.jsx)(H.l,{title:"Choose a runtime snapshot to load",onClose:()=>{h(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:e=>{e.defaultPrevented||(e.preventDefault(),h(!1))}},{buttonType:"primary",content:g?(0,S.jsx)(B.A,{size:"small"}):"Load",disabled:g,onClick:async e=>{if(!e.defaultPrevented){e.preventDefault(),f(!0);try{C(void 0);const e=c.find((e=>e.id===b));e&&(n||s)?await A({connection:n,id:e.id,podName:s}):C("No runtime snapshot found.")}finally{f(!1),h(!1)}}},autoFocus:!0}],children:(0,S.jsxs)(P.A,{as:"form",children:[(0,S.jsxs)(p.A,{children:[(0,S.jsx)(p.A.Label,{children:"Snapshot"}),(0,S.jsx)(K.A,{name:"snapshot",value:b,onChange:w,block:!0,children:c.map((e=>(0,S.jsx)(K.A.Option,{value:e.id,children:e.name?`${e.name} (${e.id})`:e.id},e.id)))})]}),y&&(0,S.jsx)(Q.A,{variant:"danger",children:y})]})})]})}Z.defaultProps={disabled:!1};var ee=n(63711),te=n(98238),ne=n(58875),ae=n(51066),se=n(29525),re=n(48461),ie=n(55285),oe=n(2381);function le(e,t){let n=e.map((e=>({...e,fileType:t?.getFileTypeForModel(e)})));return n=n.filter((e=>!e.name.startsWith("."))),n.sort(((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name))),n}function ce(e){const{item:t,contents:n,current:s,documentRegistry:r,onContextMenu:i,onSelect:o}=e,l=(0,a.useRef)(null),[c,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(!1),p=(0,a.useCallback)((()=>{m(!0),n.get(t.path).then((e=>{m(!1),d(le(e.content,r))})).catch((()=>{m(!1)}))}),[n,t,r]),h=(0,a.useCallback)((async e=>{null===c&&e&&p()}),[c,t,n]);return(0,S.jsxs)(ae.G.Item,{ref:l,id:`${t.type}-${t.name}`,onExpandedChange:h,onSelect:()=>{o(t,p)},current:t.path===s?.path,children:[(0,S.jsx)(ae.G.LeadingVisual,{children:(0,S.jsx)(ae.G.DirectoryIcon,{})}),(0,S.jsx)("span",{onContextMenu:e=>{e.preventDefault(),s?.path!==t.path&&o(t,p),i(l)},children:t.name}),(0,S.jsx)(ae.G.SubTree,{state:u?"loading":(c?.length??-1)>=0?"done":"initial",children:c?.map((e=>"directory"===e.type?(0,S.jsx)(ce,{item:e,contents:n,current:s,documentRegistry:r,onContextMenu:i,onSelect:o},e.name):(0,S.jsx)(de,{item:e,current:e.path===s?.path,onSelect:e=>o(e,p),onContextMenu:i},e.name)))})]})}function de(e){const{item:t,current:n,onSelect:s,onContextMenu:r}=e,i=(0,a.useRef)(null),o=t.fileType?.icon;return(0,S.jsxs)(ae.G.Item,{ref:i,id:`${t.type}-${t.name}`,current:n,onSelect:()=>{s(t)},children:[(0,S.jsx)(ae.G.LeadingVisual,{children:o?(0,S.jsx)(o.react,{tag:"span"}):(0,S.jsx)(v.oSV,{})}),(0,S.jsx)("span",{onContextMenu:e=>{e.preventDefault(),n||s(t),r(i)},children:t.name})]},t.name)}const ue=1048576;function me(e){const{contents:t,localContents:n,documentRegistry:s}=e,r=(0,ie.aq)(),{trackAsyncTask:i}=(0,q.d)(),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),[u,m]=(0,a.useState)(null),[p,h]=(0,a.useState)(null),[g,x]=(0,a.useState)(!1),[v,b]=(0,a.useState)(!1),j=(0,a.useCallback)((()=>{t.get("").then((e=>{d(!1),l(le(e.content,s))})).catch((e=>{d(!1),console.error(`Failed to fetch folder '' content for manager ${t.serverSettings.appUrl}.`,e)}))}),[t]);(0,a.useEffect)((()=>{j()}),[j]);const y=(0,a.useCallback)((async e=>{const n=()=>{if(!r())return Promise.reject(`Failed to upload ${e.name}; StorageBrowser component is unmounted.`)};n();const a=e.size>ue,s=u?"directory"===u.type?u.path:ee.PathExt.dirname(u.path):"",o=s?ee.PathExt.join(s,e.name):e.name,l=e.name,c=async(a,s)=>{n();const r=new FileReader;r.readAsDataURL(a),await new Promise(((t,n)=>{r.onload=t,r.onerror=t=>n(`Failed to upload "${e.name}":`+t)})),n();const i=r.result.split(",")[1],c={type:"file",format:"base64",name:l,chunk:s,content:i};return await t.save(o,c)},d={error:{message:t=>{const n=`Failed to upload ${e.name}.`;return console.error(n,t),n}},pending:{message:`Uploading ${e.name}…`},success:{message:()=>`${e.name} uploaded.`}};if(!a){const t=c(e);return i(t,d),t.then((()=>{u?u.refresh():j()})),t}{const t=new te.PromiseDelegate;i(t.promise,d);try{let n;for(let a=0;!n;a+=ue){const s=a+ue,r=s>=e.size,i=r?-1:s/ue,o=await c(e.slice(a,s),i);r&&(n=o,t.resolve(n))}return u?u.refresh():j(),n}catch(e){throw t.reject(e),e}}}),[t,u,j]),C=(0,a.useCallback)((e=>{h(p===e?null:e)}),[p]),k=(0,a.useCallback)((()=>{x(!0)}),[]),w=(0,a.useCallback)((()=>{if(u){const e=t.delete(u.path);i(e,{success:{message:()=>`${u.path} deleted.`},pending:{message:`Deleting ${u.path}…`},error:{message:e=>{const t=`Failed to delete ${u.path}.`;return console.error(t,e),t}}}),e.finally((()=>{u.refresh()}))}x(!1)}),[t,u]),A=(0,a.useCallback)((()=>{b(!0)}),[]),_=(0,a.useCallback)((()=>{u&&n&&t.get(u.path).then((e=>{const t=n?.save(e.path,e);i(t,{success:{message:()=>`${u.path} copied to local.`},pending:{message:`Copying to local ${u.path}…`},error:{message:e=>{const t=`Failed to copy to local ${u.path}.`;return console.error(t,e),t}}}),t.finally((()=>{u.refresh()})),b(!1)}))}),[n,u]),I=(0,a.useCallback)(((e,t)=>{m(e.path===u?.path?null:{...e,refresh:t})}),[u]);return(0,S.jsxs)(P.A,{sx:{display:"grid",gridTemplateAreas:'"header" "content"'},children:[(0,S.jsxs)(P.A,{sx:{gridArea:"header",display:"flex",alignItems:"center"},children:[(0,S.jsx)(f.A,{as:"h4",sx:{fontSize:"var(--text-title-size-small)",lineHeight:"var(--text-title-lineHeight-medium)",fontWeight:"var(--text-title-weight-medium)",flex:"1 1 auto"},children:"Contents Browser"}),(0,S.jsxs)(P.A,{children:[(0,S.jsx)(ne.K,{variant:"invisible","aria-label":"Refresh contents browser.",title:"Refresh contents browser.",icon:re.A,onClick:j}),(0,S.jsx)(oe.HF,{label:"Upload a file",multiple:!0,upload:y})]})]}),c?(0,S.jsx)(P.A,{sx:{gridArea:"content",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40px",height:"100vh"},children:(0,S.jsx)(B.A,{})}):(0,S.jsx)(P.A,{sx:{gridArea:"content"},children:o?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ae.G,{children:o?.map((e=>(e.fileType,"directory"===e.type?(0,S.jsx)(ce,{item:e,contents:t,current:u,documentRegistry:s,onContextMenu:C,onSelect:I},e.name):(0,S.jsx)(de,{item:e,current:u?.path===e.path,onSelect:e=>{I(e,j)},onContextMenu:C},e.name))))}),(0,S.jsx)(E.W,{anchorRef:p??void 0,open:null!==p?.current,onOpenChange:()=>{h(null)},children:(0,S.jsx)(E.W.Overlay,{children:(0,S.jsxs)(M.l,{children:[(0,S.jsx)(M.l.Item,{title:"Delete the active item.",onSelect:k,children:"Delete…"}),n&&(0,S.jsx)(M.l.Item,{title:"Copy the active item to the local drive.",onSelect:A,children:"Copy to local drive…"})]})})}),g&&(0,S.jsx)(H.l,{title:"Confirm deletion",onClose:()=>{x(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{x(!1)}},{buttonType:"danger",content:"Delete",onClick:()=>{w()}}],children:`Are you sure you want to delete ${u?.path}?`}),v&&(0,S.jsx)(H.l,{title:"Confirm copy to local",onClose:()=>{b(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{b(!1)}},{buttonType:"danger",content:"Copy to local",onClick:()=>{_()}}],children:`Are you sure you want to copy to local ${u?.path}?`})]}):(0,S.jsx)(se.A,{children:(0,S.jsx)(se.A.Heading,{children:"No contents"})})})]})}var pe=n(46916),he=n(77108),ge=n(77606),fe=n(10815),xe=n(68822);const ve=28,be="DatalayerSpacer",je=3e4;var ye=function(e){return e.PROGRESS="var(--borderColor-accent-emphasis)",e.ERROR="var(--borderColor-danger-emphasis)",e.SUCCESS="var(--borderColor-success-emphasis)",e}(ye||{});const Ce={"-1":ye.ERROR,0:ye.PROGRESS,1:ye.SUCCESS};function ke({awareness:e,currentUserHandle:t}){const[n,s]=(0,a.useState)([]);return(0,a.useEffect)((()=>{const n=()=>{const n=e.getStates();s(Array.from(n.values()).filter((e=>e.user&&e.user?.name!==t&&!(e.user?.agent??"").startsWith(be))).reduce(((e,t)=>{const n=t.user,a=!((t.notification?.timestamp??0)+je<Date.now()),s=n.agent?{avatarUrl:"https://static.vecteezy.com/system/resources/previews/006/662/139/large_2x/artificial-intelligence-ai-processor-chip-icon-symbol-for-graphic-design-logo-web-site-social-media-mobile-app-ui-illustration-free-vector.jpg",color:n.color,displayName:n.agent,handle:"agent",initials:"AI",username:n.agent,notification:a?`${t.notification?.message} ${(0,fe.g)(new Date(t.notification.timestamp))}`:void 0,notificationType:a&&void 0!==t.notification?.message_type?Ce[t.notification?.message_type.toString()]:void 0}:{avatarUrl:n.avatar_url,color:n.color,displayName:n.display_name,handle:n.name,initials:n.initials,username:n.username};return e.map((e=>e.username)).includes(s.username)||e.push(s),e}),[]))};n(),e.on("change",n);const a=setInterval(n,je/3);return()=>{clearInterval(a),e.off("change",n)}}),[e,t]),(0,S.jsx)(he.A,{children:n.map((e=>{let t=`${e.displayName}\n${e.handle}`;return e.notification&&(t+=`\n${e.notification}`),(0,S.jsx)(ge.A,{sx:{border:e.notificationType?`var(--borderWidth-thick) solid ${e.notificationType}`:"none"},title:t,src:e.avatarUrl?(0,xe.$K)(e.avatarUrl):(n=e.color,a=e.initials,"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="12" fill="${n}" stroke="none" /><text x="12" y="12" fill="black">${a}</text></svg>`)),size:ve},e.displayName);var n,a}))})}var we=n(17810),Ae=n(23530),Se=n(81390),_e=n(64991);var Ie=n(48716),Ne=n(54087),Re=n(320),Te=n(44536),De=n(27199),Ee=n(97283),Pe=n(7282);const Ue=(0,Ee.y)(((e,t)=>({datasources:[],updateDatasources:t=>e((e=>({datasources:t})))})));function Me(e){return(0,Pe.Pj)(Ue,e)}var $e=n(48315),Le=n(88037),Fe=n(41630);function ze(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ve extends Le._Q{constructor(e){super(),ze(this,"_rows",void 0),ze(this,"_mimeType",void 0),this._mimeType=e.mimeType,this._rows=[]}renderModel(e){const t=e.data[this._mimeType].split("\n").map((e=>e.split(";")));return this._rows=t,Promise.resolve()}render(){return 0===(this._rows.length>0?this._rows[0].length:0)?(0,S.jsx)("div",{children:"No data found!"}):(0,S.jsx)(Fe.NP,{children:this._rows.map((e=>(0,S.jsx)(P.A,{mt:3,children:e})))})}}const Oe={safe:!0,mimeTypes:["application/vnd.datalayer.csv"],createRenderer:e=>new Ve(e)};var We=n(97543),Ge=n(25344),Be=n(14809),Ke=n(17310),Qe=n(16181);function He(e){const{createAIAgent:t}=(0,_e.w)(),{aiAgents:n,addAIAgent:s}=(0,Se.Ks)(),{cell:r,extensionProps:i}=e,{notebookId:o}=i,[l,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(),[h,f]=(0,a.useState)({prompt:""}),[x,b]=(0,a.useState)({prompt:void 0});(0,a.useEffect)((()=>{const e=(e,t)=>{if("datalayer"===t.key&&u)for(const e of r.model.sharedModel.getMetadata("datalayer")?.ai?.messages??[])if(e.parent_id===u){m(void 0);break}};return r.model.sharedModel.metadataChanged.connect(e),()=>{r.model?.sharedModel.metadataChanged.disconnect(e)}}),[r,u]),(0,a.useEffect)((()=>{u||c(!1)}),[u]),(0,a.useEffect)((()=>{b({...x,prompt:void 0===h.prompt?void 0:h.prompt.length>0})}),[h]);const j=(0,a.useCallback)((async()=>{const e=i.panel.context.sessionContext.session?.kernel,a=e?.serverSettings,l=e?.id;n.find((e=>e.documentId===o&&e.runtimeId===l))||(await t(o,"notebook_persist",a?.baseUrl,a?.token,l),s({documentId:o,runtimeId:l}));const c=(0,Qe.f)();!function(e,t,n){const a=e.model.getMetadata("datalayer")??{},s=a.ai??{prompts:[],messages:[]},r=s.prompts??[];r.push({id:t,prompt:n,username:void 0,timestamp:Date.now()}),s.prompts=r,a.ai=s,e.model.setMetadata("datalayer",a)}(r,c,h.prompt),m(c)}),[n,r,i.panel.context.sessionContext.session?.kernel,h.prompt,o,t]),y=(0,a.useCallback)((e=>{e.ctrlKey&&"Enter"===e.key&&j()}),[j]);return(0,S.jsx)(Fe.NP,{children:(0,S.jsx)(P.A,{display:"flex",style:{justifyContent:"right"},children:(0,S.jsx)(P.A,{className:"dla-cell-ai-agent-button",children:(0,S.jsxs)(E.W,{open:l,onOpenChange:e=>c(e),children:[(0,S.jsx)(E.W.Anchor,{id:"custom-anchor-id",children:(0,S.jsx)(ne.K,{icon:v.SD8,variant:"invisible","aria-label":"AI Agents menu"})}),(0,S.jsx)(E.W.Overlay,{width:"large",children:(0,S.jsxs)(P.A,{as:"form",m:3,children:[(0,S.jsxs)(p.A,{children:[(0,S.jsx)(p.A.Label,{visuallyHidden:!0}),(0,S.jsx)(g.Ay,{block:!0,value:h.prompt,onChange:e=>{f((t=>({...t,prompt:e.target.value})))},disabled:!!u,onKeyDown:y})]}),(0,S.jsxs)(P.A,{sx:{display:"flex",width:"100%",gap:"2px",marginTop:"var(--stack-gap-normal)"},children:[(0,S.jsx)(P.A,{flexGrow:1}),(0,S.jsx)(d.Q,{onClick:e=>c(!1),variant:"default",children:"Cancel"}),(0,S.jsx)(d.Q,{leadingVisual:Ke.A,onClick:j,disabled:!x.prompt||!!u,variant:"primary",children:u?(0,S.jsx)(B.A,{size:"small"}):"Ask AI"})]})]})})]})})})})}var qe=n(94247);const Je=e=>{const{cell:t}=e,{datasources:n}=Me(),[s,r]=(0,a.useState)(),[i,o]=(0,a.useState)("df");(0,a.useEffect)((()=>{const e=(e,t)=>{if("datalayer"===(t?.key??"datalayer")){const t=(e=>{const t=e.getMetadata("datalayer");if(t){const e=t.datasource;if(e)return e.id}})(e);if(t)for(const e of n)if(t===e.id){r(t);break}}};return e(t.model),t.model.metadataChanged.connect(e),()=>{t.model?.metadataChanged.disconnect(e)}}),[t,n]);const l=e=>{const n=t.model.getMetadata("datalayer");e?(t.model.setMetadata("datalayer",{...n,sql:!0,datasource:{id:e.id,variant:e.variant,name:e.name,description:e.description,database:e.database,outputBucket:e.outputBucket,destinationVar:i??"df"}}),r(e.id),t.editor.model.mimeType=qe.bd):(t.model.setMetadata("datalayer",{...n,sql:!1,datasource:{}}),r(void 0),t.editor.model.mimeType=qe.dC)};return(0,S.jsx)(Fe.NP,{children:(0,S.jsx)(N.a,{display:"flex",style:{justifyContent:"right"},children:(0,S.jsx)(N.a,{className:"dla-cell-datasource-button",children:(0,S.jsxs)(E.W,{children:[(0,S.jsx)(E.W.Anchor,{id:"custom-anchor-id",children:(0,S.jsx)(ne.K,{icon:v.bN0,variant:"invisible","aria-label":"Open Datasources menu"})}),(0,S.jsx)(E.W.Overlay,{width:"medium",children:(0,S.jsx)(M.l,{selectionVariant:"single",showDividers:!0,children:(0,S.jsxs)(M.l.Group,{children:[(0,S.jsx)(M.l.GroupHeading,{children:"Datasources"}),0===n.length&&(0,S.jsxs)(M.l.Item,{onSelect:()=>{},children:["No Datasource available",(0,S.jsx)(M.l.Description,{variant:"block",children:"Create a new Datasource to connect your cell."})]}),n.map((e=>(0,S.jsxs)(M.l.Item,{onSelect:()=>l(e),selected:e.id===s,children:[e.name,(0,S.jsx)(M.l.Description,{variant:"block",children:e.description})]},e.id))),(0,S.jsx)(M.l.Divider,{}),(0,S.jsx)(M.l.Item,{onSelect:e=>{e.preventDefault()},children:(0,S.jsxs)(p.A,{children:[(0,S.jsx)(p.A.Label,{children:"Destination variable"}),(0,S.jsx)(h.A,{size:"small",value:i,disabled:!s,onChange:e=>(e=>{o(e);const n=t.model.getMetadata("datalayer");t.model.setMetadata("datalayer",{...n,sql:!0,datasource:{...n.datasource,destinationVar:e??"df"}})})(e.target.value)})]})}),(0,S.jsx)(M.l.Divider,{}),(0,S.jsx)(M.l.Item,{variant:"danger",onSelect:()=>l(void 0),children:"None"})]})})})]})})})})};function Xe(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ye="dla-CellToolbar-Container";class Ze extends Le._Q{constructor(e,t){super(),Xe(this,"_cell",void 0),Xe(this,"_props",void 0),this._cell=e,this._props=t,this.addClass(Ye)}render(){return(0,S.jsxs)(N.a,{display:"flex",children:[(0,S.jsx)(N.a,{flexGrow:1}),(0,S.jsxs)(s.fS,{initialEntries:["/"],children:[(0,S.jsx)(s.BV,{children:(0,S.jsx)(s.qh,{path:"*",element:(0,S.jsx)(He,{cell:this._cell,extensionProps:this._props})})}),(0,S.jsx)(Je,{cell:this._cell,extensionProps:this._props})]})]})}}function et(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tt extends Be.x0{constructor(e,t){super(),et(this,"_panel",void 0),et(this,"_props",void 0),this._panel=e,this._props=t,this.updateConnectedCell=this.updateConnectedCell.bind(this);const n=()=>{const e=this._panel.content.model?.cells;if(e){e.changed.connect(this.updateConnectedCell);for(let t=0;t<e.length;++t)this._registerCellChanges(e.get(t))}};n(),this._panel.content.modelChanged.connect((()=>{n()}))}updateConnectedCell(e,t){t.oldValues.forEach(this._deregisterCellChanges.bind(this)),t.newValues.forEach(this._registerCellChanges.bind(this))}_deregisterCellChanges(e){}_registerCellChanges(e){const t=this._getCodeCell(e);t?(t.displayChanged.connect((()=>{this._updateCodeCell(t)})),t.inViewportChanged.connect((()=>{this._updateCodeCell(t)})),this._updateCodeCell(t)):"code"===e.type&&console.error(`Could not find code cell for model: ${e}`)}_getCodeCell(e){return"code"===e.type?this._panel.content.widgets.find((t=>t.model===e)):null}_updateCodeCell(e){if(e.inputArea){const t=e.layout;if(t){const n=t;n.widgets[1].hasClass(Ye)||n.insertWidget(1,new Ze(e,this._props))}}}}class nt{constructor(){var e,t,n;e=this,n=void 0,(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="_props"))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}init(e){this._props=e}createNew(e,t){new tt(e,this._props)}get component(){return null}}const at=new b.Od;function st(){const{notebookId:e}=(0,s.g)();if(!e)return(0,S.jsx)(S.Fragment,{});const t=(0,we.J)(),b=(0,l.S)(),A=(0,Ae.Z)(),R=function(e){const{getAIAgent:t}=(0,_e.w)(),{aiAgents:n,addAIAgent:s,deleteAIAgent:r,updateAIAgent:i}=(0,Se.Ks)();return(0,a.useEffect)((()=>{let a;const o=setInterval((async()=>{a=new AbortController;try{const o=await t(e,{signal:a.signal});if(!o.success)return void r(e);const l=n.find((t=>t.documentId===e)),c=o.agent.runtime?.id;l?l.runtimeId!==c&&i(e,c):s({documentId:e,runtimeId:c})}catch(t){r(e)}}),6e4);return()=>{a?.abort("Component unmounted"),clearInterval(o)}}),[n,e]),n.find((t=>t.documentId===e))}(e),{checkIsPlatformFeaturesPreviewer:T}=(0,Ie.x)(),D=T(t),{configuration:E}=(0,Re._O)(),{credits:P,token:U}=(0,Te.Y)(),{configuration:M,multiServiceManager:$,jupyterLabAdapter:L,remoteKernels:F}=(0,z.xb)(),[V,G]=(0,a.useState)(at),[B,K]=(0,a.useState)(void 0),[Q,H]=(0,a.useState)(),[Y,ee]=(0,a.useState)(!1),[te,ne]=(0,a.useState)(),[ae,se]=(0,a.useState)(!1),[re,ie]=(0,a.useState)(!0),[oe,le]=(0,a.useState)(""),[ce,de]=(0,a.useState)(null),[ue,he]=(0,a.useState)(),[ge,fe]=(0,a.useState)(),[xe,ve]=(0,a.useState)(null),[be,je]=(0,a.useState)({name:"",nameConfirm:"",description:""}),[ye,Ce]=(0,a.useState)({name:void 0,nameConfirm:void 0,description:void 0}),{enqueueToast:Ee,trackAsyncTask:Pe}=(0,q.d)(),{selectNotebookModel:Ue,reset:Le}=(0,j.Gx)(),{hideBackdrop:Fe,screenCapture:ze,setItem:Ve,setScreenCapture:Be,showBackdrop:Ke,showScreenshot:Qe,space:He,triggerItemsRefresh:qe}=(0,De.l5)(),{cloneNotebook:Je,deleteItem:Xe,getDatasources:Ye,getNotebook:Ze,refreshDatasources:et,refreshNotebook:tt,updateNotebook:st,updateNotebookModel:rt}=(0,Ne.E)(),{updateDatasources:it}=Me(),{updateAIAgent:ot}=(0,Se.Ks)(),{patchAIAgent:lt}=(0,_e.w)(),ct=(0,a.useMemo)((()=>({baseURL:E.spacerRunUrl,token:U,roomName:e,type:"datalayer"})),[E.spacerRunUrl,e,U]),dt=(0,a.useMemo)((()=>[new nt,new y._({factory:C.N})]),[]),ut=(0,a.useMemo)((()=>new o.J),[]),mt=(0,a.useMemo)((()=>[Oe]),[]),pt=(0,a.useMemo)((()=>(0,$e.Kp)()),[]);(0,a.useEffect)((()=>{r.Ft.run=We.kU.run,r.Ft.runAll=We.kU.runAll,r.Ft.runAllAbove=We.kU.runAllAbove,r.Ft.runAllBelow=We.kU.runAllBelow,r.Ft.runAndAdvance=We.kU.runAndAdvance,r.Ft.runAndInsert=We.kU.runAndInsert,r.Ft.runCells=We.kU.runCells}),[]),(0,a.useEffect)((()=>{if(F&&F.length>0&&!te){const e=F[0];gt({runtimeDesc:{name:e.environment_name,language:"",location:"remote",displayName:e.kernel_given_name,id:e.id,burningRate:e.burning_rate,podName:e.jupyter_pod_name},kernelModel:e})}}),[F]),(0,a.useEffect)((()=>{ce&&ce.sharedModel.awareness.setLocalStateField("user",{username:t.id,name:t.handle,display_name:t.displayName,initials:`${t.firstName[0]?.toLocaleUpperCase()??"?"}${t.lastName[0]?.toLocaleUpperCase()||"?"}`,color:pt,avatar_url:t.avatarUrl})}),[ce,t,pt]),(0,a.useEffect)((()=>(Ke(),tt(e).then((t=>{if(Fe(),t.success){const t=Ze(e);t?(he(t),fe(t.nbformat),Ve(t),je({name:t.name,nameConfirm:"",description:t.description})):A("/")}else Ee(t.message,{variant:"error"})})).finally((()=>{Fe()})),()=>{V.dispose(),he(void 0),Le(),Ve(void 0)})),[e]),(0,a.useEffect)((()=>{et().then((e=>{if(e.success){const e=Ye();it(e)}}))}),[e]),(0,a.useEffect)((()=>{R&&oe&&R.runtimeId!==B&&(lt(e,V.serverSettings.baseUrl,V.serverSettings.token,B),ot(e,B))}),[R,B,e,oe,V]),(0,a.useEffect)((()=>{Ce({...ye,name:void 0===be.name?void 0:be.name.length>2,nameConfirm:be.nameConfirm===ue?.name,description:void 0===be.description?void 0:be.description.length>2})}),[be]);const ht=(0,a.useCallback)((async()=>{Ke(),st(e,be.name,be.description).then((e=>{e.success&&(Ee("The notebook is successfully updated.",{variant:"success"}),qe(),he({...ue,name:be.name,description:be.description}))})).finally((()=>{Fe()}))}),[e,be.name,be.description,ue]),gt=(0,a.useCallback)((async({runtimeDesc:a,kernelModel:s,transferState:r})=>{const o=Ue(e);o?.model&&fe(o.model.toJSON()),H(a);const l=a?.location;switch(le(""),l){case void 0:K(void 0),ie(!0),ee(!1),G(at);break;case"browser":if($?.browser){if(L){if(!L.jupyterLab.hasPlugin("@jupyterlite/pyodide-kernel-extension:kernel")){const e=await Promise.all([n.e(484),n.e(5378)]).then(n.bind(n,28924));L.jupyterLab.registerPluginModule(e)}L.jupyterLab.isPluginActivated("@jupyterlite/pyodide-kernel-extension:kernel")||await L.jupyterLab.activatePlugin("@jupyterlite/pyodide-kernel-extension:kernel")}K(void 0),ie(!1),ee(!0),G($.browser)}else console.error("Unable to use browser kernel. No service manager for it.");break;case"remote":{if(!$?.remote){console.error("Unable to use a remote kernel. No service manager for it.");break}let e;if(r&&V&&V===$?.browser&&te?.kernel)try{Ke();let t=!0;const n=te.kernel.id,a=`pyodide-${n}`,s=(0,X._)({connection:te.kernel,metadata:{filename:`${a}.data`},onUploadProgress:()=>{t&&(t=!1,(0,J.v2)().then((t=>{e=t.find((e=>e.name===a))})))}});if(Pe(s,{error:{message:e=>`Failed to save the browser kernel state. ${e}`},pending:{message:"Saving the browser kernel state…"},success:{message:()=>"Browser kernel state saved."}}),await s,!e)throw Error("Unable to find snapshot for pyodide state.");await $.browser.kernels.shutdown(n)}finally{Fe()}if(!s){const{name:n,displayName:r,params:i}=a,o=await($?.remote?.kernels.startNew({name:n,runtimeType:"notebook",givenName:r,creditsLimit:i?.creditsLimit??(P?.available??0)/Math.max(M.maxCellKernels-F.filter((e=>"cell"!==e.kernel_type)).length,1),capabilities:i?.capabilities,snapshot:e?.id},{username:t?.handle,handleComms:!0}));s=await $.remote.kernels.findById(o.id),o.dispose()}ee(!1),K(s.id),ie(!1);const n=$.remote.kernels.getServices(s.jupyter_pod_name);le(s.jupyter_pod_name);const o=new i.ServiceManager({contents:n?.contents,kernels:n?.kernels,kernelspecs:n?.kernelspecs,serverSettings:n?.serverSettings,sessions:n?.sessions,events:{dispose:()=>{}},terminals:{connectionFailure:{connect:()=>{}},dispose:()=>{},isAvailable:()=>!1}});G(o),ve("storage");break}}vt(void 0)}),[M,P,L,e,$,F,V,te]),ft=(0,a.useCallback)((async t=>{b({title:"Are you sure?",content:"Please confirm you want to clone this notebook in your private library."}).then((t=>{t&&(Ke(),Je(e).then((e=>{Fe(),e.success&&(Ee(e.message,{variant:"success"}),qe(),A("/my-library"))})))}))}),[b,ue]),xt=(0,a.useCallback)((e=>{de(e)}),[]),vt=(0,a.useCallback)((e=>{ne(e||void 0)}),[]),bt=(0,a.useCallback)((()=>{if(!re&&ce?.cells){Ke("Saving the notebook...");const t=ce.toJSON();rt(e,t).then((n=>{n.success&&(Ee("The notebook is successfully updated.",{variant:"success"}),he({...ue,id:e,nbformat:t}))})).finally((()=>{Fe()}))}}),[e,ce,re]),jt=(0,a.useCallback)((()=>{ve("storage"!==xe&&V&&V!==at?"storage":null)}),[xe,V]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(c.z,{"aria-label":"Notebook Editor",children:[(0,S.jsx)(c.z.TitleArea,{variant:"subtitle",children:(0,S.jsx)(c.z.Title,{children:"Notebook Editor"})}),(0,S.jsx)(c.z.Actions,{children:ue&&He&&(0,S.jsxs)(N.a,{sx:{flex:"0 0 auto",display:"flex",alignItems:"center"},children:[$?.remote&&te&&te.kernel&&(0,S.jsx)(W.m,{kernelId:te.kernel.id,serviceManager:$.remote,onClick:()=>{A("/runtimes")}},"credits-indicator"),(0,S.jsx)(O,{assignKernel:gt,sessionConnection:te},"kernel-picker"),(0,S.jsx)(Z,{connection:te?.kernel??void 0,multiServiceManager:$,podName:oe,disabled:void 0===Q?.location,children:"Snapshots"}),(0,S.jsx)(d.Q,{title:"Browse content on the Remote Runtime",variant:"invisible",size:"small",disabled:!V||V===at,leadingVisual:()=>(0,S.jsx)(I.Cx,{type:"content"}),onClick:jt,children:"Storage"},"content"),(0,S.jsx)(pe.E,{commandRegistry:ut,runtimeDesc:Q,save:bt,sessionConnection:te},"toolbar"),(0,S.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:v.Nc$,onClick:ft,children:"Duplicate"},"clone"),D&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(d.Q,{title:"Capture screen",variant:"invisible",size:"small",leadingVisual:()=>(0,S.jsx)(v.rVi,{}),onClick:()=>{Qe()},children:"Capture"},"capture-screen"),(0,S.jsx)(d.Q,{title:"Share",variant:"invisible",size:"small",leadingVisual:()=>(0,S.jsx)(I.Cx,{type:"share"}),onClick:e=>se(!ae),children:"Share"},"share"),(0,S.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:()=>(0,S.jsx)(I.Cx,{type:"page"}),onClick:t=>A(`/new/page/notebook/${e}`),children:"Publish"},"public")]}),(0,S.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:v.L64,onClick:e=>{ve("properties"===xe?null:"properties")},children:"Properties"},"properties"),"datalayer"===ct.type&&ce&&(0,S.jsx)(ke,{awareness:ce.sharedModel.awareness,currentUserHandle:t.handle},"peers")]})})]}),(0,S.jsxs)(u.O7,{children:[(0,S.jsxs)(u.O7.Content,{"aria-label":"Notebook Editor",width:"full",padding:"none",children:[ze&&(0,S.jsx)(N.a,{mt:3,children:(0,S.jsxs)(N.a,{display:"flex",children:[(0,S.jsx)(N.a,{children:(0,S.jsx)("img",{src:ze})}),(0,S.jsx)(N.a,{children:(0,S.jsx)(m.A,{href:"javascript: return false;",onClick:e=>Be(void 0),children:(0,S.jsx)(v.uv5,{})})})]})}),ae&&(0,S.jsx)(N.a,{sx:{flexGrow:1},children:(0,S.jsx)(Ge.a,{})}),ge&&(void 0===Q?.location?(0,S.jsx)(N.a,{sx:{"& .jp-Cell":{marginTop:30}},children:(0,S.jsx)(k.j,{nbformat:ge,outputs:!0})}):(0,S.jsx)(N.a,{sx:{"& .jp-WindowedPanel":{margin:0},"& .jp-WindowedPanel-viewport":{padding:0},"& .dla-CellSidebar-Container":{position:"relative",marginLeft:"auto"},"& .jp-Cell .dla-CellSidebar-Container":{display:"none"},"& .jp-Cell.jp-mod-active .dla-CellSidebar-Container":{display:"block"}},children:(0,S.jsx)(w.k,{commands:ut,extensions:dt,id:e,collaborationServer:ct,nbformat:ge,readonly:re,renderers:mt,kernelId:B,serviceManager:V,startDefaultKernel:Y,height:"calc(100vh - 150px)",maxHeight:"calc(100vh - 150px)",cellSidebarMargin:32,onNotebookModelChanged:xt,onSessionConnection:vt})}))]}),null!==xe&&(0,S.jsx)(u.O7.Pane,{"aria-label":"storage"===xe?"Remote Runtime Storage":"Notebook Properties",position:"start",width:"large",children:"storage"===xe&&V.contents?(0,S.jsx)(me,{contents:V.contents,documentRegistry:L?.jupyterLab.docRegistry}):"properties"===xe?(0,S.jsxs)(N.a,{as:"form",sx:{label:{marginTop:2}},children:[(0,S.jsxs)(p.A,{children:[(0,S.jsx)(p.A.Label,{children:"Name"}),(0,S.jsx)(h.A,{block:!0,value:be.name,onChange:e=>{je((t=>({...t,name:e.target.value})))}}),!1===ye.name&&(0,S.jsx)(p.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,S.jsxs)(p.A,{children:[(0,S.jsx)(p.A.Label,{children:"Description"}),(0,S.jsx)(g.Ay,{block:!0,value:be.description,onChange:e=>{je((t=>({...t,description:e.target.value})))}}),!1===ye.description&&(0,S.jsx)(p.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,S.jsx)(p.A,{children:(0,S.jsx)(d.Q,{variant:"primary",disabled:!ye.name||!ye.description,sx:{marginTop:2},onClick:ht,children:"Update Notebook Properties"})}),(0,S.jsx)(N.a,{mt:3}),(0,S.jsx)(_,{variant:"default",data:ge,fileName:`notebook-${e}`,extension:"ipynb"}),(0,S.jsxs)(N.a,{sx:{marginTop:3},children:[(0,S.jsx)(f.A,{as:"h2",sx:{fontSize:4,fontWeight:"normal",color:"danger.fg",mb:2},children:"Danger zone"}),(0,S.jsxs)(N.a,{sx:{border:"1px solid",borderColor:"danger.emphasis",borderRadius:2,p:3,alignItems:"center",justifyContent:"space-between",gap:3},children:[(0,S.jsxs)(N.a,{sx:{display:"grid",gap:1},children:[(0,S.jsx)(x.A,{sx:{fontSize:1,fontWeight:"bold",color:"danger.fg"},children:"Confirm the notebook name to delete"}),(0,S.jsx)(p.A,{children:(0,S.jsx)(h.A,{block:!0,value:be.nameConfirm,onChange:e=>{je((t=>({...t,nameConfirm:e.target.value})))}})}),(0,S.jsx)(x.A,{sx:{fontSize:1,color:"fg.muted"},children:"This operation is not reversible."})]}),(0,S.jsx)(d.Q,{variant:"danger",disabled:!ye.nameConfirm,onClick:async()=>{Ke("Deleting the notebook..."),Xe(ue.id).then((e=>{e.success&&(Ee("The notebook is successfully deleted.",{variant:"success"}),A("/my-library"))})).finally((()=>{Fe()}))},children:"Delete notebook"})]})]})]}):(0,S.jsx)(S.Fragment,{})})]})]})}const rt=st}}]);