import{u as h}from"./useBlueprintRun-CBOvzWTA.js";import{d as $,c as R,l as S,r as x,at as O,au as V,o as c,e as v,f as s,G as W,t as y,s as g,x as _,H as A,N as w,X as F,ac as M,C as N,_ as z,i as k,a as T,z as q,A as G,W as D,P as J,b as I,y as j,Z as P}from"./index-ChWW_c_j.js";const E=["disabled"],H=["disabled"],K={class:"material-symbols-outlined"},L=$({__name:"WdsButtonSplit",props:{variant:{type:String,default:"primary"},size:{type:String,default:"default"},disabled:{type:Boolean,required:!1}},emits:{mainClick:()=>!0,dropdownOpen:()=>!0,dropdownClose:()=>!0},setup(r,{expose:m,emit:a}){const p=r,b=R(()=>[`WdsButtonSplit--size-${p.size}`,`WdsButtonSplit--variant-${p.variant}`,p.disabled?"WdsButtonSplit--disabled":void 0]),B=a,n=S("btn"),o=S("dropdown"),e=x(!1),{floatingStyles:d}=O(n,o,{placement:"bottom-end",middleware:[V(12)]});function l(f=!e.value){e.value=f,e.value?B("dropdownOpen"):B("dropdownClose")}return m({toggleDropdown:l}),(f,u)=>(c(),v("div",{ref_key:"btn",ref:n,class:N(["WdsButtonSplit",b.value])},[s("button",{type:"button",class:"WdsButtonSplit__main",disabled:r.disabled,onClick:u[0]||(u[0]=i=>f.$emit("mainClick"))},[W(f.$slots,"button",{},void 0,!0)],8,E),u[2]||(u[2]=s("hr",{class:"WdsButtonSplit__divider"},null,-1)),s("button",{class:"WdsButtonSplit__dropdownTrigger",type:"button",disabled:r.disabled,onClickCapture:u[1]||(u[1]=i=>l())},[s("i",K,y(e.value?"keyboard_arrow_up":"keyboard_arrow_down"),1)],40,H),g(M,null,{default:_(()=>[e.value?(c(),v("div",{key:0,ref_key:"dropdown",ref:o,style:A(w(d))},[W(f.$slots,"dropdown",{},void 0,!0)],4)):F("",!0)]),_:3})],2))}}),X=z(L,[["__scopeId","data-v-cb5182fd"]]),Z={class:"BlueprintToolbarBlocksDropdown"},Q={class:"BlueprintToolbarBlocksDropdown__list"},U={class:"BlueprintToolbarBlocksDropdown__list__item__description"},Y={class:"BlueprintToolbarBlocksDropdown__list__item__title"},tt=$({__name:"BlueprintToolbarBlocksDropdown",props:{components:{type:Array,required:!0}},emits:{jumpToComponent:r=>typeof r=="string",runBranch:r=>typeof r=="string"},setup(r){const m=r,a=k(T.core);function p(n){const o=a.getComponentDefinition(n.type);return(o==null?void 0:o.name)??n.type}function b(n){if(n.type!=="blueprints_uieventtrigger"||!!n.content.defaultResult)return!0;const e=(n.outs??[]).map(l=>a.getComponentById(l.toNodeId)).flatMap(l=>Object.values(l.content??{}));return e.length===0?!0:!e.some(l=>l.includes("@{result}"))}const B=R(()=>m.components.map(n=>{var l;const o=a.getComponentDefinition(n.type),e=((l=n.content)==null?void 0:l.alias)||p(n),d=(o==null?void 0:o.name)??n.type;return{id:n.id,disabled:!b(n),title:e,description:e===d?void 0:d}}));return(n,o)=>(c(),v("div",Z,[o[2]||(o[2]=s("p",{class:"BlueprintToolbarBlocksDropdown__header"}," Start blueprint from ",-1)),s("div",Q,[(c(!0),v(q,null,G(B.value,e=>(c(),v("div",{key:e.id,class:N(["BlueprintToolbarBlocksDropdown__list__item",{"BlueprintToolbarBlocksDropdown__list__item--disabled":e.disabled}])},[g(D,{variant:"primary",size:"smallIcon","custom-size":"20px",disabled:e.disabled,"data-writer-tooltip":e.disabled?"Can not run without a default result. Go to this block to define a default result.":"Run the branch",onClick:d=>n.$emit("runBranch",e.id)},{default:_(()=>o[0]||(o[0]=[s("i",{class:"material-symbols-outlined"},"play_arrow",-1)])),_:2},1032,["disabled","data-writer-tooltip","onClick"]),s("div",null,[s("p",U,y(e.description),1),s("p",Y,y(e.title),1)]),g(D,{variant:"neutral",size:"smallIcon","custom-size":"20px","data-writer-tooltip":"Jump to the blueprint",onClick:d=>n.$emit("jumpToComponent",e.id)},{default:_(()=>o[1]||(o[1]=[s("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])],2))),128))])]))}}),et=z(tt,[["__scopeId","data-v-e742152c"]]),nt={ref:"root",class:"BlueprintToolbar","data-writer-unselectable":!0},ot=$({__name:"BlueprintToolbar",emits:{autogenClick:()=>!0},setup(r){const m=k(T.core),a=k(T.builderManager),p=k(T.componentId),b=S("runBlueprintBtn"),{run:B,isRunning:n}=h(m,p),o=R(()=>m.getComponents(p).filter(i=>{var t;return((t=m.getComponentDefinition(i.type))==null?void 0:t.category)==="Triggers"})),e=J([]);function d(){e.value=P(a.selection.value),a.setSelection(null)}function l(){var i;if((i=e.value)!=null&&i.length){a.setSelection(null);for(const t of e.value)a.appendSelection(t.componentId,t.instancePath,t.source);e.value=[]}}function f(i){var t;a.setSelection(i,void 0,"click"),(t=b.value)==null||t.toggleDropdown(!1)}async function u(i){var t;(t=b.value)==null||t.toggleDropdown(!1),await B(i)}return(i,t)=>(c(),v("div",nt,[g(D,{variant:"tertiary",size:"icon","data-automation-action":"run-autogen","data-writer-tooltip":"Autogen","data-writer-tooltip-placement":"bottom",onClick:t[0]||(t[0]=C=>i.$emit("autogenClick"))},{default:_(()=>t[4]||(t[4]=[s("i",{class:"material-symbols-outlined"},"wand_shine",-1)])),_:1}),o.value.length?(c(),I(X,{key:0,ref_key:"runBlueprintBtn",ref:b,class:"BlueprintToolbar__runBlueprintDropdown",variant:"special",disabled:w(n),onMainClick:t[2]||(t[2]=C=>u()),onDropdownOpen:d,onDropdownClose:l},{button:_(()=>[t[5]||(t[5]=s("i",{class:"material-symbols-outlined"},"play_arrow",-1)),j(" "+y(w(n)?"Running...":"Run blueprint"),1)]),dropdown:_(()=>[g(et,{components:o.value,onJumpToComponent:f,onRunBranch:t[1]||(t[1]=C=>u(C))},null,8,["components"])]),_:1},8,["disabled"])):(c(),I(D,{key:1,class:"BlueprintToolbar__runBlueprint","data-automation-action":"run-blueprint",variant:"special",disabled:w(n),onClick:t[3]||(t[3]=C=>u())},{default:_(()=>[t[6]||(t[6]=s("i",{class:"material-symbols-outlined"},"play_arrow",-1)),j(" "+y(w(n)?"Running...":"Run blueprint"),1)]),_:1},8,["disabled"]))],512))}}),it=z(ot,[["__scopeId","data-v-946b79ab"]]);export{it as default};
