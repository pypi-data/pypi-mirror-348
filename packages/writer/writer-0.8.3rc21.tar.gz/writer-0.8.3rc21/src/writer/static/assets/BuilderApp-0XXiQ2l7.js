function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./SharedMoreDropdown-DKv_HNef.js","./index-ChWW_c_j.js","./index-CPCeQU9V.css","./SharedMoreDropdown-BWKlox8E.css","./BuilderEmbeddedCodeEditor-CbK-r9w6.js","./BuilderEmbeddedCodeEditor-DiDqfWdt.css","./BuilderSidebarToolkit-BbjOOp8E.js","./BuilderSidebarPanel-BMJVzhd3.js","./BuilderSidebarPanel-BrLsNxVM.css","./BuilderSidebarToolkit-BvZDShKD.css","./BuilderSidebarComponentTree-CtaOZfpV.js","./useComponentDescription-FHKxu8gg.js","./marked.esm-273vDTCT.js","./BuilderSidebarComponentTree-0YajaJke.css","./BuilderSettings-D5bjbcWj.js","./instancePath-BsbOTTI8.js","./BuilderSettings-C2WRfSor.css","./ComponentRenderer-CZs4z773.js","./ComponentRenderer-B76bKRZO.css","./BuilderInstanceTracker-Dr0XhpSH.js","./BuilderInstanceTracker-BECcXNnW.css","./BuilderInsertionOverlay-B7-TsHNC.js","./BuilderInsertionOverlay-D2XS0ij9.css","./BuilderInsertionLabel-CDlWX-mE.js","./BuilderInsertionLabel-_YS5WPfq.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as F,i as q,a as z,r as K,u as de,c as k,o,e as p,f as n,y as R,C as U,_ as E,s as D,N as w,O as we,P as Se,Q as He,R as ut,w as fe,n as ne,S as ye,T as Ze,U as Ge,x,W as J,b as I,t as T,V as Ue,X as S,l as Le,q as Pe,v as qe,H as ze,I as _e,Y as ct,Z as ve,$ as Ne,a0 as Y,a1 as De,a2 as ie,a3 as me,a4 as Re,a5 as pt,a6 as vt,a7 as Oe,G as ae,z as j,A as re,a8 as mt,a9 as ft,aa as _t,ab as Ye,ac as yt,ad as Q,M as ee,ae as Te,af as gt,ag as ht,ah as bt,ai as Ie,aj as wt,ak as kt,al as Je,am as Bt,D as Ct,an as $t,ao as Ve}from"./index-ChWW_c_j.js";import{marked as St}from"./marked.esm-273vDTCT.js";const Dt={class:"BuilderSwitcher"},Tt=F({__name:"BuilderSwitcher",setup(e){const i=q(z.core),t=q(z.builderManager);let u=K(null);const r=de(i),m=d=>{const C=t.getMode();if(C!=d){switch(u.value=d,d){case"ui":r.track("nav_ui_opened");break;case"preview":r.track("nav_preview_opened");break;case"blueprints":r.track("nav_blueprints_opened");break}t.setMode(d),(d=="preview"||C=="blueprints"||d=="blueprints")&&t.setSelection(null)}},h=k(()=>t.getMode());return(d,C)=>(o(),p("div",Dt,[n("button",{"data-automation-action":"set-mode-ui",class:U({active:h.value=="ui"}),type:"button",onClick:C[0]||(C[0]=b=>m("ui"))},C[3]||(C[3]=[n("i",{class:"icon material-symbols-outlined"},"grid_3x3",-1),R(" Interface ")]),2),n("button",{"data-automation-action":"set-mode-blueprints",class:U({active:h.value=="blueprints"}),type:"button",onClick:C[1]||(C[1]=b=>m("blueprints"))},C[4]||(C[4]=[n("i",{class:"icon material-symbols-outlined"},"linked_services",-1),R(" Blueprints ")]),2),n("button",{class:U({active:h.value=="preview"}),"data-automation-action":"set-mode-preview",type:"button",onClick:C[2]||(C[2]=b=>m("preview"))},C[5]||(C[5]=[n("i",{class:"icon material-symbols-outlined"},"visibility",-1),R(" Preview ")]),2)]))}}),Lt=E(Tt,[["__scopeId","data-v-0cbf6a77"]]),Pt={class:"BuilderStateExplorer"},It=F({__name:"BuilderStateExplorer",setup(e){const i=q(z.core);return(t,u)=>(o(),p("div",Pt,[D(we,{data:w(i).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),xt=E(It,[["__scopeId","data-v-eafb7b97"]]),At=F({__name:"WdsStateDot",props:{state:{type:String,required:!0}},setup(e){return(i,t)=>(o(),p("div",{class:U(["WdsStateDotState",`WdsStateDotState--${e.state}`])},null,2))}}),Xe=E(At,[["__scopeId","data-v-4eacfc04"]]),he=Se([]);function xe(){function e(t){he.value=he.value.filter(u=>u.id!==t)}function i(t){const u=new Date().getTime();he.value=[...he.value,{...t,id:u}],t.closable||setTimeout(()=>e(u),t.delayMs??3e3)}return{pushToast:i,removeToast:e,toasts:He(he)}}function Ft(e){const i=new AbortController,t=de(e),u=Ze(),{pushToast:r}=xe(),{writerApi:m,apiBaseUrl:h}=ut({signal:i.signal}),d=K(!1),C=Se(),b=Se(),B=k(()=>e.writerApplication.value!==void 0),$=k(()=>{var y;return Number((y=e.writerApplication.value)==null?void 0:y.organizationId)||void 0}),a=k(()=>{var y;return(y=e.writerApplication.value)==null?void 0:y.id}),l=k(()=>{var M,O;const y=(O=(M=b.value.writer)==null?void 0:M.teamIds)==null?void 0:O[0];if(!y)return;const N=`/organization/${$.value}/team/${y}/framework/${a.value}`;return new URL(N,h)}),f=k(()=>{if(!(!$.value||!a.value))return new URL(`/aistudio/organization/${$.value}/agent/${a.value}/deploy`,h)}),c=k(()=>b.value.lastDeployedAt?new Date(b.value.lastDeployedAt):void 0),v=k(()=>!!(B.value&&b.value)),s=k(()=>{var y;return((y=b.value)==null?void 0:y.status)==="deployed"});fe(e.writerApplication,g,{immediate:!0}),ne(()=>{document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await g()},{signal:i.signal})});async function g(){if(e.writerApplication.value)try{b.value=await m.fetchApplicationDeployment($.value,a.value)}catch(y){u.error("Failed to fetch deployment information",y),b.value=void 0}}async function _(){if(e.writerApplication.value){if(!s.value){const y=`/aistudio/organization/${$.value}/agent/${a.value}/deploy`,N=new URL(y,h);window.open(N,"_blank");return}d.value=!0,C.value=void 0;try{await m.publishApplication($.value,a.value,{applicationVersionId:b.value.applicationVersion.id,applicationVersionDataId:b.value.applicationVersionData.id}),await g();const y=l.value?{label:"See it live",func:()=>window.open(l.value,"_blank"),icon:"open_in_new"}:void 0;r({type:"success",message:"agent deployed",action:y}),t.track("deployment_succeeded")}catch(y){t.track("deployment_failed",{error:String(y)}),C.value=y,u.error("Deploy failed",y),r({type:"error",message:"deploy failed"})}finally{d.value=!1}}}return ye(()=>i.abort()),{isCloudApp:B,canDeploy:v,writerDeployUrl:f,hasBeenPublished:s,publishApplication:_,isDeploying:He(d),lastDeployedAt:c}}const Et={class:"BuilderHeader"},Mt=["href"],Rt={key:1,src:Ge,alt:"Writer Framework logo"},Ut={class:"BuilderHeader__toolbar"},Ot=F({__name:"BuilderHeader",setup(e){const i=q(z.core),t=K(!1),u=de(i),{canDeploy:r,isDeploying:m,publishApplication:h,hasBeenPublished:d,lastDeployedAt:C,writerDeployUrl:b}=Ft(i),B=new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});async function $(){u.track("nav_deploy_clicked"),d.value?a.value=!0:await h()}const a=K(!1),l=[{desc:"Cancel",fn:()=>a.value=!1},{desc:"Yes, deploy changes",fn:async()=>{a.value=!1,await h()}}],f=k(()=>C.value?`Editor Last saved ${B.format(C.value)}`:void 0),c=k(()=>d.value===!0?"Deploy changes":(d.value===!1,"Configure deployment")),v=k(()=>{let _="";switch(i.syncHealth.value){case"offline":_+="Offline. Not syncing.";break;case"connected":_+="Online. Syncing...";break;case"idle":_+="Sync not initialised.";break;case"suspended":_+="Sync suspended.";break}return i.featureFlags.value.length>0&&(_+=` Feature flags: ${i.featureFlags.value.join(", ")}`),_}),s=k(()=>{switch(i.syncHealth.value){case"offline":case"suspended":case"idle":return"error";default:return"deployed"}});function g(){u.track("nav_state_explorer_opened"),t.value=!0}return(_,y)=>(o(),p("div",Et,[n("div",null,[w(b)?(o(),p("a",{key:0,href:w(b).toString(),target:"_blank",class:"BuilderHeader__goBack"},y[1]||(y[1]=[n("img",{src:Ge,alt:"Writer Framework logo"},null,-1)]),8,Mt)):(o(),p("img",Rt))]),D(Lt,{class:"BuilderHeader__switcher"}),n("div",Ut,[y[4]||(y[4]=n("hr",null,null,-1)),D(J,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"State Explorer","data-writer-tooltip-placement":"bottom",onClick:g},{default:x(()=>y[2]||(y[2]=[n("i",{class:"material-symbols-outlined"},"code",-1)])),_:1}),w(r)?(o(),I(J,{key:0,size:"small",loading:w(m),"data-writer-tooltip":f.value,"data-writer-tooltip-placement":"bottom","data-automation-key":"deploy",onClick:$},{default:x(()=>[R(T(c.value)+" ",1),a.value?(o(),I(Ue,{key:0,title:"Are you sure you want to deploy these changes?",size:"normal",actions:l},{default:x(()=>y[3]||(y[3]=[n("p",{class:"BuilderHeader__toolbar__deployModal__text"}," This will replace the current live version of this agent everywhere it is currently deployed. ",-1)])),_:1})):S("",!0)]),_:1},8,["loading","data-writer-tooltip"])):S("",!0),D(Xe,{state:s.value,"data-writer-tooltip":v.value,"data-writer-tooltip-placement":"left"},null,8,["state","data-writer-tooltip"]),t.value?(o(),I(Ue,{key:1,title:"State Explorer","display-close-button":"",onClose:y[0]||(y[0]=N=>t.value=!1)},{default:x(()=>[D(xt)]),_:1})):S("",!0)])]))}}),Wt=E(Ot,[["__scopeId","data-v-0323eaa0"]]),qt={class:"text"},zt=200,Kt=4,Nt=F({__name:"BuilderTooltip",setup(e){const i=Le("rootEl"),t=K(!1),u=K(null);let r=null,m=null;const h=K("top"),d=K({top:0,left:0});async function C(){if(!r||(u.value=r.dataset.writerTooltip,!u.value))return;const l=r.dataset.writerTooltipGap?parseInt(r.dataset.writerTooltipGap):Kt;if(t.value=b(r),!t.value)return;await _e();const{x:f,y:c,width:v,height:s}=r.getBoundingClientRect(),{width:g,height:_}=i.value.getBoundingClientRect();switch(h.value){case"top":d.value.top=c-_-l,d.value.left=f+v/2-g/2;break;case"right":d.value.top=c+s/2-_/2,d.value.left=f+v+l;break;case"left":d.value.left=f-g-l,d.value.top=c+s/2-_/2;break;case"bottom":d.value.top=c+s+l,d.value.left=f+v/2-g/2;break}}function b(l){return l.getAttribute("data-writer-tooltip-strategy")==="overflow"?l.scrollWidth>l.clientWidth:!0}function B(l){const c=l.target.closest("[data-writer-tooltip]");if(c)r!==c&&(t.value=!1);else{t.value=!1,r=null;return}r=c,h.value=r.dataset.writerTooltipPlacement??"top",setTimeout(()=>$(c),zt)}async function $(l){l===r&&(m==null||m.disconnect(),m=new MutationObserver(C),m.observe(r,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement","data-writer-tooltip-strategy"]}),C())}const a=k(()=>{const{top:l,left:f}=d.value;return{top:`${l}px`,left:`${f}px`}});return ne(()=>{document.documentElement.addEventListener("mouseover",B)}),ye(()=>{document.documentElement.removeEventListener("mouseover",B),m==null||m.disconnect()}),(l,f)=>Pe((o(),p("div",{ref_key:"rootEl",ref:i,class:"BuilderTooltip",style:ze(a.value)},[n("div",{class:U(["arrow",h.value])},null,2),n("div",qt,T(u.value),1)],4)),[[qe,t.value]])}}),Vt=E(Nt,[["__scopeId","data-v-7ba01c7c"]]),jt={class:"BuilderAsyncLoader"},Ht=F({__name:"BuilderAsyncLoader",setup(e){return(i,t)=>(o(),p("div",jt,[D(ct)]))}}),te=E(Ht,[["__scopeId","data-v-bb820549"]]),Zt=""+new URL("art-paper-WsD9P5Lu.svg",import.meta.url).href,Gt="data:image/svg+xml,%3csvg%20width='120'%20height='160'%20viewBox='0%200%20120%20160'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='16.0273'%20y='89.9375'%20width='80.1422'%20height='55.209'%20rx='7.12375'%20fill='%23A95EF8'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M47.9297%20135.352H13.3542C9.41988%20135.352%206.23047%20138.541%206.23047%20142.475V152.27C6.23047%20156.205%209.41987%20159.394%2013.3542%20159.394H97.9487C101.883%20159.394%20105.072%20156.205%20105.072%20152.27V142.475C105.072%20138.541%20101.883%20135.352%2097.9487%20135.352H63.3737C63.3737%20136.103%2063.174%20136.848%2062.7859%20137.542C62.3979%20138.237%2061.8291%20138.868%2061.112%20139.399C60.395%20139.931%2059.5437%20140.352%2058.6068%20140.64C57.6699%20140.928%2056.6658%20141.076%2055.6517%20141.076C54.6376%20141.076%2053.6335%20140.928%2052.6966%20140.64C51.7597%20140.352%2050.9085%20139.931%2050.1914%20139.399C49.4744%20138.868%2048.9056%20138.237%2048.5175%20137.542C48.1295%20136.848%2047.9297%20136.103%2047.9297%20135.352Z'%20fill='%23721CC9'/%3e%3crect%20x='27.6055'%20y='103.295'%20width='56.99'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='38.293'%20y='112.199'%20width='35.6187'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='46.3047'%20y='121.104'%20width='19.5903'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20y='10.3691'%20width='40.0647'%20height='30.0485'%20rx='7.12375'%20transform='rotate(-15%200%2010.3691)'%20fill='%23EDE2FF'/%3e%3cpath%20d='M15.0475%2021.5308C15.2249%2020.8687%2016.0526%2020.6469%2016.5373%2021.1316L21.9902%2026.5846C22.475%2027.0693%2022.2532%2027.897%2021.5911%2028.0744L14.1421%2030.0703C13.48%2030.2477%2012.8741%2029.6418%2013.0515%2028.9797L15.0475%2021.5308Z'%20fill='%23D4B2F7'/%3e%3cpath%20d='M25.3727%2010.4659C25.5501%209.80376%2026.3777%209.58199%2026.8624%2010.0667L34.9516%2018.1559C35.4363%2018.6406%2035.2145%2019.4682%2034.5524%2019.6456L23.5024%2022.6065C22.8403%2022.7839%2022.2344%2022.178%2022.4118%2021.5159L25.3727%2010.4659Z'%20fill='%23D4B2F7'/%3e%3crect%20x='68.2383'%20y='23.1523'%20width='54.3186'%20height='40.0711'%20rx='7.12375'%20transform='rotate(17.6282%2068.2383%2023.1523)'%20fill='%23D4B2F7'/%3e%3cpath%20d='M72.1976%2052.7145C71.7609%2052.9406%2071.5902%2053.4779%2071.8163%2053.9146C72.0424%2054.3514%2072.5797%2054.5221%2073.0164%2054.296L72.1976%2052.7145ZM82.1128%2048.5839L82.8321%2048.059L82.3818%2047.4419L81.7034%2047.7931L82.1128%2048.5839ZM86.9945%2055.274L86.2752%2055.7989L86.71%2056.3948L87.3764%2056.0784L86.9945%2055.274ZM104.339%2047.7366C104.504%2047.2733%20104.262%2046.764%20103.798%2046.599L96.2487%2043.9102C95.7854%2043.7452%2095.2761%2043.987%2095.1111%2044.4503C94.9461%2044.9136%2095.1879%2045.4229%2095.6512%2045.5879L102.362%2047.9779L99.972%2054.6888C99.807%2055.1521%20100.049%2055.6614%20100.512%2055.8264C100.975%2055.9914%20101.485%2055.7496%20101.65%2055.2863L104.339%2047.7366ZM73.0164%2054.296L82.5222%2049.3746L81.7034%2047.7931L72.1976%2052.7145L73.0164%2054.296ZM81.3935%2049.1087L86.2752%2055.7989L87.7138%2054.7491L82.8321%2048.059L81.3935%2049.1087ZM87.3764%2056.0784L103.882%2048.2423L103.118%2046.6334L86.6126%2054.4696L87.3764%2056.0784Z'%20fill='%23F6EFFD'/%3e%3c/svg%3e",We=150;function Yt(e){const i=K(structuredClone(ve(e.sourceFiles.value)));fe(e.sourceFiles,(s,g)=>{let _=!1,y=structuredClone(ve(i.value));const N=h(g).map(t);for(const M of Ne(s)){const O=Y(M,g),W=Y(M,s);if(me(W))continue;if(O===void 0||De(W)){y=Re(M,y,structuredClone(ve(W))),_=!0;continue}if(!ie(O))continue;const H=!O.complete&&W.complete,ue=O.complete&&W.complete;if(!H&&!ue)continue;const ce=t(M);if(N.includes(ce))continue;const oe=Y(M,y);ie(oe)&&(_=!0,oe.complete=!0,oe.content=W.content)}for(const M of pt(y))Y(M,s)===void 0&&(y=vt(M,y),_=!0);_&&(i.value=y)});function t(s){return s.join("/")}const u=Se(),r=k(()=>Array.from(Ne(i.value))),m=k(()=>h(e.sourceFiles.value));function h(s){return r.value.filter(g=>{const _=Y(g,i.value);if(De(_))return!1;if(!ie(_))return!0;const y=Y(g,s);return ie(y)?!_.complete||!y.complete?!1:_.content!==y.content:!0})}const d=k(()=>{if(u.value!==void 0)return Y(u.value,i.value)}),C=k({get(){return ie(d.value)?d.value.content:""},set(s){if(u.value===void 0)return;const g=Y(u.value,i.value);ie(g)&&(g.content=s)}});function b(s=1){const g=`new-file-${s}.txt`;return Y([g],i.value)?b(s+1):g}async function B(){const s=b();i.value=Re([s],ve(i.value)),l([s]),await e.sendCreateSourceFileRequest([s])}const $=k(()=>{var g;return(g=u.value)!=null&&g.length?u.value.at(-1).split(".").at(-1):""}),a=k(()=>{switch($.value){case"py":return"python";case"md":case"markdown":return"markdown";default:return $.value}});function l(s){u.value=s,ie(d.value)&&!d.value.complete&&e.requestSourceFileLoading(s)}async function f(s){if(!(!u.value||!d.value)&&(d.value.type==="file"&&await e.sendCodeSaveRequest(C.value,u.value),s)){const g=[...ve(u.value)];u.value=void 0;try{await e.sendRenameSourceFileRequest(g,s)}catch(_){throw u.value=g,_}l(s)}}function c(s){return new Promise((g,_)=>{const y=new FileReader;y.addEventListener("loadend",N=>{const M=N.target.result;if(M instanceof ArrayBuffer){const O=String.fromCharCode.apply(null,new Uint8Array(M));return g(O)}g(M.split(",")[1])}),y.addEventListener("error",()=>{_()}),y.readAsDataURL(s)})}async function v(s){const g=We*1024*1024;if(s.size>g)throw Error(`Cannot upload file bigger than ${We}mb`);const _=[s.name];if(Y(_,e.sourceFiles.value))throw Error(`The file ${s.name} already exists`);i.value=Re(_,ve(i.value),{type:"binary",uploading:!0});const y=await c(s);await e.sendFileUploadRequest(_,y)}return{code:C,sourceFileDraft:i,fileOpen:d,filepathOpen:u,pathsUnsaved:m,openedFileLanguage:a,save:f,upload:v,openFile:l,openNewFile:B,getNewFilename:b}}const Jt={class:"BuilderDropFileZone"},Xt=F({__name:"BuilderDropFileZone",setup(e){return(i,t)=>(o(),p("div",Jt,[t[0]||(t[0]=n("img",{src:Gt,alt:"Drop file illustration"},null,-1)),t[1]||(t[1]=n("h2",null,"Upload files",-1)),n("p",null,"Files can be up to "+T(w(We))+"mb",1)]))}}),Qt=E(Xt,[["__scopeId","data-v-92e0a561"]]),ea={class:"BuilderPanel__collapser"},ta={class:"material-symbols-outlined"},aa={class:"BuilderPanel__title"},na={class:"BuilderPanel__titleCompanion"},oa=["data-order"],la={key:0,class:"BuilderPanel__contents__leftPanel"},sa={class:"BuilderPanel__actions"},ia={class:"BuilderPanel__actionsCompanion"},ra={class:"material-symbols-outlined"},da={class:"BuilderPanel__mainContents"},ua=F({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{},enableLeftPanel:{type:Boolean},enableDropFile:{type:Boolean}},emits:{openned:e=>typeof e=="boolean",filesDrop:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:i}){const t=q(z.builderManager),u=["code","log"],r=e,m=i,h=k(()=>r.enableDropFile&&d.value),d=K(!1);function C(c,v){r.enableDropFile&&(c.preventDefault(),d.value=v)}function b(c){if(d.value=!1,!r.enableDropFile)return;c.preventDefault();const v=[];if(c.dataTransfer.items)for(const s of c.dataTransfer.items){if(s.kind!=="file")continue;const g=s.getAsFile();g&&v.push(g)}else for(const s of c.dataTransfer.files)v.push(s);v.length>0&&m("filesDrop",v)}const B=k(()=>!t.openPanels.value.has(r.panelId)),$=k(()=>u.indexOf(r.panelId));function a(c){if(t.openPanels.value.has(c)){t.openPanels.value.delete(c),m("openned",!1);return}t.openPanels.value.add(c),m("openned",!0)}function l(c){const v=ft(c);if(v&&c.key==r.keyboardShortcutKey.toLowerCase()){c.preventDefault(),a(r.panelId);return}r.actions.forEach(s=>{if(!s.keyboardShortcut)return;const{key:g,modifierKey:_}=s.keyboardShortcut;g.toLowerCase()==c.key&&(!v&&_||(c.preventDefault(),s.callback()))})}function f(c){if(!c)return"";let v=" (";return c.modifierKey&&(v+=Oe()),v+=c.key,v+=")",v}return ne(async()=>{document.addEventListener("keydown",l)}),ye(()=>{document.removeEventListener("keydown",l)}),(c,v)=>(o(),p("div",{class:U(["BuilderPanel",{collapsed:B.value}])},[n("div",ea,[D(J,{variant:"neutral",size:"smallIcon","data-automation-action":"toggle-panel","data-automation-key":c.panelId,"data-writer-tooltip":`Toggle ${c.name} (${w(Oe)()}${c.keyboardShortcutKey})`,onClick:v[0]||(v[0]=s=>a(c.panelId))},{default:x(()=>[n("i",ta,T(B.value?"expand_less":"expand_more"),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),n("div",aa,T(c.name),1),n("div",na,[ae(c.$slots,"titleCompanion",{},void 0,!0)]),B.value?S("",!0):(o(),I(mt,{key:0,to:c.contentsTeleportEl},[n("div",{style:ze({order:$.value}),"data-order":$.value,class:U(["BuilderPanel__contents",{"BuilderPanel__contents--leftPanel":c.enableLeftPanel,"BuilderPanel__contents--dropingFile":h.value}]),onDrop:b,onDragover:v[1]||(v[1]=s=>C(s,!0)),onDragleave:v[2]||(v[2]=s=>C(s,!1))},[h.value?(o(),I(Qt,{key:0})):(o(),p(j,{key:1},[c.enableLeftPanel?(o(),p("div",la,[ae(c.$slots,"leftPanel",{},void 0,!0)])):S("",!0),n("div",sa,[n("div",ia,[ae(c.$slots,"actionsCompanion",{},void 0,!0)]),(o(!0),p(j,null,re(c.actions,(s,g)=>(o(),I(J,{key:g,"data-writer-tooltip":s.name+f(s.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:s.isDisabled,onClick:s.callback},{default:x(()=>[n("i",ra,T(s.icon),1)]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),n("div",da,[ae(c.$slots,"default",{},void 0,!0)])],64))],46,oa)],8,["to"]))],2))}}),Qe=E(ua,[["__scopeId","data-v-a30a0b3d"]]),ca={class:"BuilderTree"},pa=["draggable","data-automation-key","aria-expanded"],va={class:"material-symbols-outlined"},ma=["data-writer-tooltip"],fa={key:1,class:"BuilderTree__main__dropdown"},_a=F({__name:"BuilderTree",props:{name:{type:String,required:!0},query:{type:String,required:!1,default:void 0},variant:{type:String,required:!1,default:void 0},noNestedSpace:{type:Boolean,required:!1},dataAutomationKey:{type:String,required:!1,default:void 0},hasChildren:{type:Boolean},draggable:{type:Boolean},matched:{type:Boolean},selected:{type:Boolean},disabled:{type:Boolean},dropdownOptions:{type:Array,required:!1,default:void 0}},emits:{expandBranch:()=>!0,select:e=>!!e,dragover:e=>!!e,dragstart:e=>!!e,dragend:e=>!!e,drop:e=>!!e,dropdownSelect:e=>typeof e=="string"},setup(e,{expose:i,emit:t}){const u=Q(()=>ee(()=>import("./SharedMoreDropdown-DKv_HNef.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),r=e,m=t;i({expand:B,toggleCollapse:$});const h=K(!1),d=K(!1),C=k(()=>!r.matched),b=k(()=>!r.hasChildren);function B(){h.value=!1,m("expandBranch")}function $(a){a??(a=!h.value),a!==h.value&&(h.value=a)}return(a,l)=>(o(),p("div",ca,[n("div",{class:U(["BuilderTree__main",{selected:e.selected,notMatched:C.value,childless:b.value}]),tabindex:"0",draggable:e.draggable,"data-automation-key":e.dataAutomationKey,"aria-expanded":!h.value,onMouseenter:l[2]||(l[2]=f=>d.value=!0),onMouseleave:l[3]||(l[3]=f=>d.value=!1),onClick:l[4]||(l[4]=f=>a.$emit("select",f)),onKeydown:l[5]||(l[5]=Ye(f=>a.$emit("select",f),["enter"])),onDragover:l[6]||(l[6]=f=>a.$emit("dragover",f)),onDragstart:l[7]||(l[7]=f=>a.$emit("dragstart",f)),onDragend:l[8]||(l[8]=f=>a.$emit("dragend",f)),onDrop:l[9]||(l[9]=f=>a.$emit("drop",f))},[e.hasChildren?(o(),I(J,{key:0,class:"BuilderTree__main__collapser",variant:"neutral",size:"icon",disabled:e.disabled,onClick:l[0]||(l[0]=_t(f=>$(void 0),["stop"]))},{default:x(()=>[n("i",va,T(h.value?"expand_more":"expand_less"),1)]),_:1},8,["disabled"])):S("",!0),ae(a.$slots,"nameLeft",{},void 0,!0),n("span",{class:U(["BuilderTree__main__name",{"BuilderTree__main__name--disabled":e.disabled,"BuilderTree__main__name--root":e.variant==="root"}]),"data-writer-tooltip":e.name,"data-writer-tooltip-strategy":"overflow"},T(e.name),11,ma),ae(a.$slots,"nameRight",{},void 0,!0),e.dropdownOptions&&d.value?(o(),p("div",fa,[D(w(u),{options:e.dropdownOptions,"trigger-custom-size":"16px",onSelect:l[1]||(l[1]=f=>a.$emit("dropdownSelect",f))},null,8,["options"])])):S("",!0)],42,pa),D(yt,null,{default:x(()=>[Pe(n("div",{class:U(["BuilderTree__children",{"BuilderTree__children--noNestedSpace":e.noNestedSpace}])},[ae(a.$slots,"children",{},void 0,!0)],2),[[qe,!h.value&&e.hasChildren]])]),_:3})]))}}),ya=E(_a,[["__scopeId","data-v-53da0b82"]]),ga=["width","height","viewBox","aria-valuenow"],ha=["r","cx","cy","stroke","stroke-width"],ba=["r","cx","cy","stroke","stroke-width","stroke-dasharray","stroke-dashoffset"],wa=F({__name:"WdsProgressLinear",props:{progress:{type:Number,required:!1,default:100},sizePx:{type:Number,required:!1,default:12},strokeWidth:{type:Number,required:!1,default:2}},setup(e){const i=e,t=k(()=>i.sizePx/2),u=k(()=>i.sizePx/2-i.strokeWidth/2),r=k(()=>2*Math.PI*u.value),m=k(()=>r.value*((100-i.progress)/100)),h=k(()=>`0 0 ${i.sizePx} ${i.sizePx}`);return(d,C)=>(o(),p("svg",{width:e.sizePx,height:e.sizePx,viewBox:h.value,style:{transform:"rotate(-90deg)"},role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[n("circle",{r:u.value,cx:t.value,cy:t.value,fill:"transparent",stroke:w(Te).Blue1,"stroke-width":e.strokeWidth},null,8,ha),n("circle",{r:u.value,cx:t.value,cy:t.value,fill:"transparent",stroke:w(Te).Blue5,"stroke-width":e.strokeWidth,"stroke-dasharray":r.value,"stroke-dashoffset":m.value},null,8,ba)],8,ga))}}),ka=F({__name:"BuilderCodePanelFileUploading",props:{timeMs:{type:Number,required:!0}},setup(e){const i=e,t=K(0);return ne(()=>{let u;const r=m=>{u||(u=m);const h=m-u;t.value=Math.min(h/i.timeMs*100,100),t.value<100&&requestAnimationFrame(r)};requestAnimationFrame(r)}),(u,r)=>(o(),I(wa,{class:"BuilderCodePanelFileUploading",progress:t.value,"size-px":12,"stroke-width":2},null,8,["progress"]))}}),Ba=E(ka,[["__scopeId","data-v-449f2dac"]]),je=[{label:"Delete",value:"delete",icon:"delete"}],Ca=F({__name:"BuilderCodePanelSourceFilesTree",props:{sourceFiles:{type:Object,required:!0},path:{type:Array,default:()=>[]},pathActive:{type:Array,default:()=>[]},pathsUnsaved:{type:Array,default:()=>[]},displayAddFileButton:{type:Boolean}},emits:{select:e=>Array.isArray(e),delete:e=>Array.isArray(e),addFile:()=>!0},setup(e,{emit:i}){const t=e,u=i;function r(l){return l.join("/")}const m=k(()=>r(t.pathActive)),h=k(()=>t.pathsUnsaved.map(r)),d=k(()=>me(t.sourceFiles)?Object.entries(t.sourceFiles.children).sort((l,f)=>l[0].localeCompare(f[0])):[]);function C(l){const f=Y([...t.path,l],t.sourceFiles);return De(f)&&f.uploading}function b(l){const f=r([...t.path,l]);return h.value.includes(f)}function B(l){return r([...t.path,l])===m.value}function $(l){if(!me(t.sourceFiles)||C(l))return;const f=t.sourceFiles.children[l];me(f)||u("select",[...t.path,l])}function a(l,f){l==="delete"&&u("delete",[...t.path,f])}return(l,f)=>(o(),p("div",null,[(o(!0),p(j,null,re(d.value,([c,v])=>(o(),I(ya,{key:c,name:c,matched:"","has-children":w(me)(v),selected:B(c),disabled:C(c),"right-click-options":je,"dropdown-options":w(me)(v)||w(De)(v)?je:void 0,onSelect:s=>$(c),onDropdownSelect:s=>a(s,c)},gt({children:x(()=>[D(et,{"source-files":v,"path-active":e.pathActive,"paths-unsaved":e.pathsUnsaved,path:[...e.path,c],onSelect:f[0]||(f[0]=s=>l.$emit("select",s)),onDelete:f[1]||(f[1]=s=>l.$emit("delete",s))},null,8,["source-files","path-active","paths-unsaved","path"])]),_:2},[C(c)||b(c)?{name:"nameLeft",fn:x(()=>[C(c)?(o(),I(Ba,{key:0,"time-ms":2e3})):b(c)?(o(),I(Xe,{key:1,state:"newDraft"})):S("",!0)]),key:"0"}:void 0]),1032,["name","has-children","selected","disabled","dropdown-options","onSelect","onDropdownSelect"]))),128))]))}}),et=E(Ca,[["__scopeId","data-v-42a4456e"]]),$a=["disabled"],Sa={key:0,class:"material-symbols-outlined"},Da={class:"WdsButtonLink__text"},Ta={key:1,class:"material-symbols-outlined"},La=F({__name:"WdsButtonLink",props:{variant:{type:String,default:"primary"},weight:{type:String,default:"default"},leftIcon:{type:String,required:!1,default:void 0},rightIcon:{type:String,required:!1,default:void 0},text:{type:String,required:!0},disbaled:{type:Boolean}},setup(e){const i=e,t=k(()=>[`WdsButtonLink--variant-${i.variant}`,`WdsButtonLink--weight-${i.weight}`]);return(u,r)=>(o(),p("button",{class:U(["WdsButtonLink",t.value]),disabled:e.disbaled,type:"button"},[e.leftIcon?(o(),p("i",Sa,T(e.leftIcon),1)):S("",!0),n("span",Da,T(e.text),1),e.rightIcon?(o(),p("i",Ta,T(e.rightIcon),1)):S("",!0)],10,$a))}}),tt=E(La,[["__scopeId","data-v-f12b9e55"]]),Pa={class:"BuilderCodePanelFileUploadBtn"},Ia=F({__name:"BuilderCodePanelFileUploadBtn",emits:{selected:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:i}){const t=Le("input"),u=i;function r(){var m;(m=t.value.files)!=null&&m.length&&u("selected",t.value.files)}return(m,h)=>(o(),p("form",Pa,[Pe(n("input",{ref_key:"input",ref:t,type:"file",multiple:"true",onChange:r},null,544),[[qe,!1]]),D(tt,{"left-icon":"upload",text:"Upload",onClick:h[0]||(h[0]=d=>w(t).click())})]))}}),xa={class:"BuilderCodePanel__tree"},Aa={class:"BuilderCodePanel__tree__actions"},Fa={key:1,class:"BuilderCodePanel__noPreview"},Ea={class:"BuilderCodePanel__actionsCompanion"},Ma=F({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(e){const i=Q(()=>ee(()=>import("./SharedMoreDropdown-DKv_HNef.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),t=Q({loader:()=>ee(()=>import("./BuilderEmbeddedCodeEditor-CbK-r9w6.js").then(P=>P.a),__vite__mapDeps([4,1,2,5]),import.meta.url),loadingComponent:te}),u=q(z.core),r=[{label:"Rename file",value:"rename",icon:"edit"},{label:"Delete file",value:"delete",icon:"delete"}],m=de(u),{sourceFileDraft:h,openFile:d,upload:C,openNewFile:b,code:B,openedFileLanguage:$,filepathOpen:a,fileOpen:l,pathsUnsaved:f,save:c}=Yt(u);async function v(P){await Promise.all([...P].map(s))}async function s(P){try{await C(P),_({type:"success",message:`File ${P.name} uploaded`})}catch(V){_({type:"error",message:V.message})}}const g=k(()=>{var P;return(P=l.value)==null?void 0:P.type}),{pushToast:_}=xe(),y=Ze();function N(P){const V=new AbortController;ne(()=>{document.addEventListener("keydown",async Z=>{const Ee=Z.metaKey||Z.ctrlKey,le=Z.key==="s"||Z.key==="S";!Ee||!le||(Z.preventDefault(),await P())},{signal:V.signal})}),ye(()=>V.abort())}N(ge);const M=Le("filenameEl"),O=K(""),W=K(!1),H=k(()=>{var P;return((P=a.value)==null?void 0:P.join("/"))??""}),ue=k(()=>H.value!=="main.py"),ce=k(()=>H.value!==O.value),oe=k(()=>W.value||H.value==="main.py"),ke=k(()=>ce.value?!1:a.value===void 0?!0:!f.value.map(P=>P.join("/")).includes(H.value));fe(a,()=>{var P;O.value=((P=a.value)==null?void 0:P.join("/"))??""}),fe(u.sessionTimestamp,()=>{W.value=!1});function Ae(P){P&&(m.track("nav_code_opened"),a.value===void 0&&d(["main.py"]))}async function Be(){var P;H.value!=="main.py"&&(await _e(),(P=M.value)==null||P.focus())}async function Fe(P){switch(P){case"rename":return Be();case"delete":await $e(a.value)}}async function Ce(){await b(),Be()}async function $e(P){await u.sendDeleteSourceFileRequest(P),_({type:"success",message:"The file was deleted"}),a.value.join("/").startsWith(P.join("/"))&&d(["main.py"])}async function ge(){if(a.value===void 0)return _({type:"error",message:"There is no file open"});if(ke.value)return _({type:"info",message:"There are not file changes to save"});W.value=!0;try{await c(ce.value?O.value.split("/"):void 0),_({type:"success",message:"The file was saved"}),m.track("nav_code_file_updated",{path:a.value})}catch(P){y.error("The file hasn't been saved.",P),_({type:"error",message:"The file hasn't been saved"});return}finally{W.value=!1}}return(P,V)=>(o(),I(Qe,{"panel-id":"code",name:"Code","contents-teleport-el":P.contentsTeleportEl,actions:[],scrollable:!1,"enable-left-panel":"","keyboard-shortcut-key":"J",class:"BuilderCodePanel","enable-drop-file":"",onFilesDrop:v,onOpenned:Ae},{leftPanel:x(()=>[n("div",xa,[D(et,{"path-active":w(a),"paths-unsaved":w(f),"source-files":w(h),onAddFile:Ce,onSelect:w(d),onDelete:$e},null,8,["path-active","paths-unsaved","source-files","onSelect"]),n("div",Aa,[D(tt,{"left-icon":"add",text:"Add file",onClick:Ce}),D(Ia,{onSelected:v})])])]),actionsCompanion:x(()=>[n("div",Ea,[D(ht,{ref_key:"filenameEl",ref:M,modelValue:O.value,"onUpdate:modelValue":V[1]||(V[1]=Z=>O.value=Z),disabled:!ue.value,class:"BuilderCodePanel__actionsCompanion__filename",autofocus:"",variant:"ghost",onKeydown:Ye(ge,["enter"])},null,8,["modelValue","disabled"]),D(J,{variant:"primary",size:"small",disabled:W.value||ke.value,class:"BuilderCodePanel__actionsCompanion__saveBtn",onClick:ge},{default:x(()=>V[3]||(V[3]=[n("i",{class:"material-symbols-outlined"},"keyboard_backspace",-1),R(" Save file ")])),_:1},8,["disabled"]),D(w(i),{disabled:oe.value,options:r,onSelect:Fe},null,8,["disabled"])])]),default:x(()=>[g.value==="file"?(o(),I(w(t),{key:0,modelValue:w(B),"onUpdate:modelValue":V[0]||(V[0]=Z=>bt(B)?B.value=Z:null),variant:"full",language:w($),disabled:W.value},null,8,["modelValue","language","disabled"])):S("",!0),g.value==="binary"?(o(),p("div",Fa,V[2]||(V[2]=[n("img",{class:"BuilderCodePanel__noPreview__img",src:Zt},null,-1),n("p",{class:"BuilderCodePanel__noPreview__title"},"Can’t Preview File",-1),n("p",{class:"BuilderCodePanel__noPreview__desc"}," Non-text files are not available to view here ",-1)]))):S("",!0)]),_:1},8,["contents-teleport-el"]))}}),Ra=E(Ma,[["__scopeId","data-v-59d54f01"]]),Ua={class:"BuiderLogBlueprintExecutionTrace"},Oa={key:0,class:"trace"},Wa={class:"type"},qa={key:0},za={key:1},Ka={class:"main"},Na={key:0},Va={key:1},ja={key:2},Ha={key:3},Za={class:"details"},Ga={class:"data","data-automation-key":"result"},Ya={key:1,class:"nothing"},Ja={class:"data","data-automation-key":"return-value"},Xa={class:"environment"},Qa={class:"data"},en={key:1,class:"nothing"},tn={class:"callStack"},an={class:"eyebrow"},nn=F({__name:"BuilderLogBlueprintExecutionTrace",props:{executionItem:{}},emits:["closeModal"],setup(e,{emit:i}){const t=q(z.core),u=q(z.builderManager),r=de(t),m=i,{goToComponentParentPage:h}=Ie(t,u),d=e,C=k(()=>{var a;const $=((a=d.executionItem.executionEnvironment)==null?void 0:a.call_stack)??[];return Object.fromEntries($.map(l=>[l,t.getComponentById(l)]))}),b=k(()=>{var $;return(($=d.executionItem.executionEnvironment)==null?void 0:$.trace)??[]});ne(()=>{r.track("blueprints_logs_trace_opened")});async function B($){m("closeModal"),u.setMode("blueprints"),await _e(),h($),await _e(),u.setSelection($,void 0,"log")}return($,a)=>{var l,f,c;return o(),p("div",Ua,[b.value.length>0?(o(),p("div",Oa,[(o(!0),p(j,null,re(b.value,(v,s)=>(o(),p("div",{key:s,class:"traceEntry"},[n("div",Wa,[v.type=="functionCall"?(o(),p("span",qa,"⚡️")):S("",!0),v.type=="reasoning"?(o(),p("span",za,"🧠")):S("",!0)]),n("div",Ka,[v.thought?(o(),p("div",Na,[a[0]||(a[0]=n("strong",null,"Thought.",-1)),R(" "+T(v.thought),1)])):S("",!0),v.action?(o(),p("div",Va,[a[1]||(a[1]=n("strong",null,"Action.",-1)),R(" "+T(v.action),1)])):S("",!0),v.name?(o(),p("div",ja,T(v.name),1)):S("",!0),v.parameters?(o(),p("div",Ha,[D(we,{"hide-root":!0,data:v.parameters,"initial-depth":1,class:"data"},null,8,["data"])])):S("",!0)])]))),128))])):S("",!0),n("div",Za,[n("div",null,[a[2]||(a[2]=n("h3",null,"Result",-1)),a[3]||(a[3]=n("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),n("div",Ga,[(l=$.executionItem)!=null&&l.result?(o(),I(we,{key:0,data:$.executionItem.result,"initial-depth":1,class:"data"},null,8,["data"])):(o(),p("div",Ya,"No result."))])]),n("div",null,[a[4]||(a[4]=n("h3",null,"Return value",-1)),a[5]||(a[5]=n("p",null," The value being returned, which is used to determine the result of 'Run blueprint' blocks and 'Chat completion' tool calls. ",-1)),n("div",Ja,[(f=$.executionItem)!=null&&f.returnValue?(o(),I(we,{key:0,data:$.executionItem.returnValue,"initial-depth":1,class:"data"},null,8,["data"])):(o(),p(j,{key:1},[R(" No return value. ")],64))])])]),n("div",Xa,[a[6]||(a[6]=n("h3",null,"Execution environment",-1)),a[7]||(a[7]=n("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),n("div",Qa,[(c=$.executionItem)!=null&&c.executionEnvironment?(o(),I(we,{key:0,data:$.executionItem.executionEnvironment,"initial-depth":1,class:"data"},null,8,["data"])):(o(),p("div",en,"Empty execution environment."))])]),n("div",tn,[a[9]||(a[9]=n("h3",null,"Call stack",-1)),(o(!0),p(j,null,re(C.value,(v,s)=>{var g,_,y;return o(),p("div",{key:s,class:U(["component",{active:s==$.executionItem.componentId}])},[n("div",null,[n("div",an,[s==$.executionItem.componentId?(o(),p(j,{key:0},[R(" This block · ")],64)):S("",!0),R(" "+T(((g=w(t).getComponentDefinition(v==null?void 0:v.type))==null?void 0:g.name)??"Unavailable component")+" · Id: "+T(s),1)]),R(" "+T(((_=v==null?void 0:v.content)==null?void 0:_.alias)??((y=w(t).getComponentDefinition(v==null?void 0:v.type))==null?void 0:y.name)??"Unavailable component"),1)]),v?(o(),I(J,{key:0,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:N=>B(s)},{default:x(()=>a[8]||(a[8]=[n("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])):S("",!0)],2)}),128))])])}}}),on=E(nn,[["__scopeId","data-v-6ee8bb1e"]]),ln={class:"BuilderListItem"},sn=["viewBox"],rn=["d","stroke"],dn=["d","stroke"],un={class:"BuilderListItem__content"},cn=F({__name:"BuilderListItem",props:{isLast:{type:Boolean,required:!1},height:{type:Number,required:!1,default:1e3},color:{type:String,required:!1,default:Te.Blue2},colorLast:{type:String,required:!1,default:Te.Blue2}},setup(e){const i=e,t=k(()=>i.height/2),u=k(()=>`0 0 17 ${i.height}`),r=k(()=>["M1 0",`V${t.value-8}`,`C1 ${t.value-4}.4183 4.58172 ${t.value} 9 ${t.value}`,"H17"].join(" ")),m=k(()=>[`M1 ${t.value-8}`,`V${i.height}`].join(" "));return(h,d)=>(o(),p("div",ln,[(o(),p("svg",{viewBox:u.value,fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMax meet",class:"BuilderListItem__anchor"},[e.isLast?S("",!0):(o(),p("path",{key:0,d:m.value,stroke:e.colorLast,"stroke-width":"1"},null,8,rn)),n("path",{d:r.value,stroke:e.color,"stroke-width":"1"},null,8,dn)],8,sn)),n("div",un,[ae(h.$slots,"default",{},void 0,!0)])]))}}),pn=E(cn,[["__scopeId","data-v-33f3edcd"]]),vn={class:"BuilderLogBlueprintExecution"},mn={class:"name"},fn={key:0},_n={class:"eyebrow"},yn={class:"outcome"},gn={class:"result"},hn={class:"time"},bn={key:0,class:"message markdown"},wn=F({__name:"BuilderLogBlueprintExecution",props:{executionLog:{}},setup(e){const i=q(z.core),t=q(z.builderManager),{goToComponentParentPage:u}=Ie(i,t),r=e,m=K(null),h=k(()=>({summary:[...r.executionLog.summary.filter(B=>!!B.outcome).map(B=>({...B,component:i.getComponentById(B.componentId),componentDef:i.getComponentById(B.componentId)?i.getComponentDefinition(i.getComponentById(B.componentId).type):void 0}))]}));async function d(b){t.setMode("blueprints"),await _e(),u(b),await _e(),t.setSelection(b,void 0,"log")}function C(b){return b<0?"N/A":b<.1?"< 0.1s":`${b.toFixed(2)}s`}return(b,B)=>{const $=wt("dompurify-html");return o(),p("div",vn,[(o(!0),p(j,null,re(h.value.summary,(a,l)=>(o(),I(pn,{key:l,"is-last":l+1===h.value.summary.length},{default:x(()=>{var f,c,v,s,g,_,y,N,M,O,W,H;return[n("div",{class:U(["itemWrapper",{"itemWrapper--first":l===0,"itemWrapper--last":l+1===h.value.summary.length}])},[n("div",{class:U(["item",{selected:w(t).isComponentIdSelected(a.componentId)}])},[n("div",mn,[(c=(f=a.component)==null?void 0:f.content)!=null&&c.alias?(o(),p("div",fn,[n("div",_n,T(((v=a.componentDef)==null?void 0:v.name)??"Unavailable component"),1),R(" "+T((g=(s=a.component)==null?void 0:s.content)==null?void 0:g.alias),1)])):(o(),p(j,{key:1},[R(T(((_=a.componentDef)==null?void 0:_.name)??"Unavailable component"),1)],64)),a.component?(o(),I(J,{key:2,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:ue=>d(a.componentId)},{default:x(()=>B[1]||(B[1]=[n("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])):S("",!0)]),n("div",yn,[a.outcome!=="in_progress"?(o(),p(j,{key:0},[n("div",{class:U(["ball",(M=(N=(y=a.componentDef)==null?void 0:y.outs)==null?void 0:N[a.outcome])==null?void 0:M.style])},null,2),R(" "+T(((H=(W=(O=a.componentDef)==null?void 0:O.outs)==null?void 0:W[a.outcome])==null?void 0:H.name)??a.outcome),1)],64)):(o(),p(j,{key:1},[B[2]||(B[2]=n("div",{class:"ballContainer"},[n("div",{class:"ball inProgress"})],-1)),B[3]||(B[3]=R(" In progress... "))],64))]),n("div",gn,[m.value==l?(o(),I(Ue,{key:0,title:"Trace",size:"wide",actions:[{desc:"Done",fn:()=>m.value=null}]},{default:x(()=>[D(on,{"execution-item":a,onCloseModal:B[0]||(B[0]=()=>m.value=null)},null,8,["execution-item"])]),_:2},1032,["actions"])):S("",!0),a.result||a.returnValue||a.executionEnvironment?(o(),I(J,{key:1,variant:"special",size:"small",onClick:()=>m.value=l},{default:x(()=>B[4]||(B[4]=[n("i",{class:"material-symbols-outlined"},"find_in_page",-1),R(" Trace ")])),_:2},1032,["onClick"])):S("",!0)]),n("div",hn,T(C(a.executionTimeInSeconds)),1),a.message?Pe((o(),p("div",bn,null,512)),[[$,w(St).parse(a.message)]]):S("",!0)],2)],2)]}),_:2},1032,["is-last"]))),128))])}}}),kn=E(wn,[["__scopeId","data-v-d778122d"]]),Bn={class:"BuilderLogIndicator"},Cn={key:0,class:"number error"},$n={key:1,class:"number info"},Sn=F({__name:"BuilderLogIndicator",setup(e){const i=q(z.builderManager),t=k(()=>i.getLogEntries().reduce((u,r)=>(r.type in u||(u[r.type]=0),u[r.type]++,u),{}));return(u,r)=>(o(),p("div",Bn,[t.value.error>0?(o(),p("div",Cn,[r[0]||(r[0]=n("div",{class:"icon"},[n("i",{class:"material-symbols-outlined"},"error")],-1)),R(" "+T(t.value.error??0),1)])):S("",!0),t.value.info>0?(o(),p("div",$n,[r[1]||(r[1]=n("div",{class:"icon"},[n("i",{class:"material-symbols-outlined"},"info")],-1)),R(" "+T(t.value.info??0),1)])):S("",!0)]))}}),Dn=E(Sn,[["__scopeId","data-v-34a7a9ff"]]),Tn={key:0,class:"entries"},Ln={class:"icon"},Pn={key:0,class:"material-symbols-outlined"},In={key:1,class:"material-symbols-outlined"},xn={class:"title"},An={class:"time"},Fn={class:"content"},En={key:0,class:"codeContainer"},Mn={key:1,class:"emptyMessage"},Rn=F({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(e){const i=q(z.core),t=q(z.builderManager),u=de(i);function r(d){d&&u.track("nav_logs_opened")}const m=[{icon:"delete",name:"Clear log",callback:()=>{t.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],h=k(()=>t.getLogEntries());return(d,C)=>(o(),I(Qe,{"panel-id":"log",name:"Log","contents-teleport-el":d.contentsTeleportEl,actions:m,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel",onOpenned:r},{titleCompanion:x(()=>[D(Dn)]),default:x(()=>[h.value.length>0?(o(),p("div",Tn,[(o(!0),p(j,null,re(h.value,(b,B)=>(o(),p(j,{key:B},[n("div",{class:U(["entry",b.type])},[n("div",Ln,[b.type=="error"?(o(),p("i",Pn,"error")):(o(),p("i",In,"info"))]),n("div",xn,T(b.title)+T(b.repeated>0?` · Repeated ${b.repeated} times`:""),1),n("div",An,T(b.timestampReceived.toLocaleTimeString()),1),n("div",Fn,[R(T(b.message)+" ",1),b.code?(o(),p("div",En,[n("code",null,T(b.code),1)])):S("",!0)])],2),b.blueprintExecution?(o(),I(kn,{key:0,"execution-log":b.blueprintExecution},null,8,["execution-log"])):S("",!0)],64))),128))])):S("",!0),h.value.length==0?(o(),p("div",Mn,C[0]||(C[0]=[n("div",null,[R(" Exceptions and other relevant messages will be shown here."),n("br"),R("Also, you can include print statements in event handlers to create log entries. ")],-1)]))):S("",!0)]),_:1},8,["contents-teleport-el"]))}}),Un=E(Rn,[["__scopeId","data-v-dd30a100"]]),On={class:"switches"},Wn=F({__name:"BuilderPanelSwitcher",setup(e){const i=q(z.builderManager),t=Le("screenEl");return(u,r)=>(o(),p("div",{class:U(["BuilderPanelSwitcher",{openPanels:w(i).openPanels.value.size>0}])},[n("div",{ref_key:"screenEl",ref:t,class:"screen"},null,512),n("div",On,[D(Ra,{"contents-teleport-el":w(t)},null,8,["contents-teleport-el"]),D(Un,{"contents-teleport-el":w(t)},null,8,["contents-teleport-el"])])],2))}}),qn=E(Wn,[["__scopeId","data-v-75a489c0"]]),zn=["href"],Kn={class:"material-symbols-outlined"},Nn=["disabled"],Vn={class:"material-symbols-outlined"},jn=F({__name:"BuilderSidebarButton",props:{icon:{type:String,required:!0},active:{type:Boolean},disabled:{type:Boolean},href:{type:String,required:!1,default:void 0}},setup(e){return(i,t)=>e.href?(o(),p("a",{key:0,class:"BuilderSidebarButton",href:e.href},[n("span",Kn,T(e.icon),1)],8,zn)):(o(),p("button",{key:1,class:U(["BuilderSidebarButton",{"BuilderSidebarButton--active":e.active}]),role:"button",disabled:e.disabled},[n("span",Vn,T(e.icon),1)],10,Nn))}}),be=E(jn,[["__scopeId","data-v-eb301559"]]),Hn={class:"BuilderSidebar"},Zn={class:"BuilderSidebar__toolbar"},Gn={key:0,class:"BuilderSidebar__toolbar__top"},Yn={key:1,class:"BuilderSidebar__toolbar__center"},Jn={class:"BuilderSidebar__toolbar__bottom"},Xn={key:0,class:"BuilderSidebar__pane"},Qn={class:"BuilderSidebar__pane__header"},eo=F({__name:"BuilderSidebar",setup(e){const i=Q({loader:()=>ee(()=>import("./BuilderSidebarToolkit-BbjOOp8E.js"),__vite__mapDeps([6,7,1,2,8,9]),import.meta.url),loadingComponent:te}),t=Q({loader:()=>ee(()=>import("./BuilderSidebarComponentTree-CtaOZfpV.js"),__vite__mapDeps([10,7,1,2,8,11,12,13]),import.meta.url),loadingComponent:te});function u(g){return typeof g=="string"&&["layers","add"].includes(g)}const r=q(z.core),m=q(z.builderManager),h=k(()=>b()),{undo:d,redo:C,getUndoRedoSnapshot:b}=Ie(r,m),B=k(()=>m.mode.value==="preview"),$=kt("activePane",u),a=K(B.value?void 0:$.value);fe(a,()=>$.value=a.value),fe(B,()=>{B.value&&a.value});const l=k(()=>({layers:m.mode.value==="ui"?"Interface Layers":"Blueprint Layers",add:"Add block"})),f=Oe();async function c(g){if(!(!(Je()?g.metaKey:g.ctrlKey)||g.target.closest("textarea, input, select")))switch(g.key){case"i":g.preventDefault(),a.value="layers";break;case"b":g.preventDefault(),a.value="add";break}}const v=new AbortController;ne(()=>{document.addEventListener("keydown",c,{signal:v.signal})}),ye(()=>v.abort());function s(g){a.value=a.value===g?void 0:g}return(g,_)=>(o(),p("div",Hn,[n("div",Zn,[B.value?S("",!0):(o(),p("div",Gn,[D(be,{icon:"stacks","data-writer-tooltip-placement":"right","data-writer-tooltip":`${l.value.layers} (${w(f)}I)`,active:a.value==="layers","data-automation-action":"sidebar-layers",onClick:_[0]||(_[0]=y=>s("layers"))},null,8,["data-writer-tooltip","active"]),D(be,{icon:"dashboard_customize","data-writer-tooltip-placement":"right","data-writer-tooltip":`${l.value.add} (${w(f)}B)`,active:a.value==="add","data-automation-action":"sidebar-add",onClick:_[1]||(_[1]=y=>s("add"))},null,8,["data-writer-tooltip","active"])])),B.value?S("",!0):(o(),p("div",Yn,[_[5]||(_[5]=n("hr",null,null,-1)),D(be,{icon:"undo","data-automation-key":"undo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Undo (${w(f)}Z)`,disabled:!h.value.isUndoAvailable,onClick:_[2]||(_[2]=y=>w(d)())},null,8,["data-writer-tooltip","disabled"]),D(be,{"data-automation-key":"redo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Redo (${w(f)}Y)`,icon:"redo",disabled:!h.value.isRedoAvailable,onClick:_[3]||(_[3]=y=>w(C)())},null,8,["data-writer-tooltip","disabled"])])),n("div",Jn,[D(be,{href:"https://dev.writer.com/framework/",icon:"help","data-writer-tooltip-placement":"right","data-writer-tooltip":"Docs"})])]),a.value&&!B.value?(o(),p("div",Xn,[n("div",Qn,[n("h2",null,T(l.value[a.value]),1),D(J,{variant:"neutral",size:"smallIcon",onClick:_[4]||(_[4]=y=>a.value=void 0)},{default:x(()=>_[6]||(_[6]=[n("span",{class:"material-symbols-outlined"}," left_panel_close ",-1)])),_:1})]),a.value==="add"?(o(),I(w(i),{key:0})):S("",!0),a.value==="layers"?(o(),I(w(t),{key:1})):S("",!0)])):S("",!0)]))}}),to=E(eo,[["__scopeId","data-v-0db8e5f4"]]),ao={class:"WdsToast__icon"},no={class:"material-symbols-outlined"},oo={class:"material-symbols-outlined"},lo=F({__name:"WdsToast",props:{type:{type:String,required:!0},message:{type:String,required:!0},closable:{type:Boolean},action:{type:Object,required:!1,default:void 0}},emits:{close:()=>!0},setup(e){const i=e,t=k(()=>{switch(i.type){case"info":return"info";case"success":return"check";case"error":return"close";default:return"question_mark"}});return(u,r)=>(o(),p("div",{class:U(["WdsToast",`WdsToast--${e.type}`])},[n("div",ao,[n("span",no,T(t.value),1)]),n("p",null,T(e.message),1),e.action?(o(),p("button",{key:0,class:"WdsToast__action",onClick:r[0]||(r[0]=(...m)=>e.action.func&&e.action.func(...m))},[R(T(e.action.label)+" ",1),n("span",oo,T(e.action.icon),1)])):S("",!0),e.closable?(o(),I(J,{key:1,class:"WdsToast__close",variant:"neutral",size:"smallIcon",onClick:r[1]||(r[1]=m=>u.$emit("close"))},{default:x(()=>r[2]||(r[2]=[n("span",{class:"material-symbols-outlined"},"close",-1)])),_:1})):S("",!0)],2))}}),so=E(lo,[["__scopeId","data-v-e8cc4657"]]),io={class:"BuilderToasts"},ro=F({__name:"BuilderToasts",setup(e){const{toasts:i,removeToast:t}=xe();return(u,r)=>(o(),p("div",io,[D(Bt,{name:"list",tag:"div"},{default:x(()=>[(o(!0),p(j,null,re(w(i),m=>(o(),I(so,{key:m.id,class:"BuilderToasts__toast",closable:m.closable,message:m.message,type:m.type,action:m.action,onClick:h=>w(t)(m.id)},null,8,["closable","message","type","action","onClick"]))),128))]),_:1})]))}}),uo=E(ro,[["__scopeId","data-v-6c357255"]]),co={class:"builderMain"},po={class:"rendererWrapper"},vo=F({__name:"BuilderApp",setup(e){const i=Q({loader:()=>ee(()=>import("./BuilderSettings-D5bjbcWj.js"),__vite__mapDeps([14,1,2,15,11,4,5,12,16]),import.meta.url),loadingComponent:te}),t=Q({loader:()=>ee(()=>import("./ComponentRenderer-CZs4z773.js"),__vite__mapDeps([17,1,2,15,18]),import.meta.url),loadingComponent:te}),u=Q({loader:()=>ee(()=>import("./BuilderInstanceTracker-Dr0XhpSH.js"),__vite__mapDeps([19,1,2,20]),import.meta.url),loadingComponent:te}),r=Q({loader:()=>ee(()=>import("./BuilderInsertionOverlay-B7-TsHNC.js"),__vite__mapDeps([21,1,2,22]),import.meta.url),loadingComponent:te}),m=Q({loader:()=>ee(()=>import("./BuilderInsertionLabel-CDlWX-mE.js"),__vite__mapDeps([23,1,2,24]),import.meta.url),loadingComponent:te}),h=q(z.core),d=q(z.builderManager),C=de(h),b=xe(),{candidateId:B,candidateInstancePath:$,isCandidacyConfirmed:a,dropComponent:l,assignInsertionCandidacy:f,removeInsertionCandidacy:c}=$t(h),{createAndInsertComponent:v,undo:s,redo:g,moveComponent:_,moveComponentUp:y,moveComponentDown:N,cutComponent:M,isPasteAllowed:O,isCopyAllowed:W,isCutAllowed:H,isDeleteAllowed:ue,isGoToParentAllowed:ce,isGoToChildAllowed:oe,isGoToNextSiblingAllowed:ke,isGoToPrevSiblingAllowed:Ae,pasteComponent:Be,copyComponent:Fe,removeComponentsSubtree:Ce,goToParent:$e,goToChild:ge,goToNextSibling:P,goToPrevSibling:V,moveComponentToParent:Z,moveComponentInsideNextSibling:Ee}=Ie(h,d,C),le=k(()=>d.getMode()),at=k(()=>d.firstSelectedId.value);async function nt(L){if(L.key=="Escape"){d.setSelection(null);return}const G=Je()?L.metaKey:L.ctrlKey;if(L.target.closest("textarea, input, select"))return;if(L.key=="z"&&G){L.preventDefault(),s();return}if(L.key=="y"&&G){L.preventDefault(),g();return}if(!d.isSingleSelectionActive.value||!d.firstSelectedItem.value)return;const{componentId:A,instancePath:pe}=d.firstSelectedItem.value;if(L.key=="Delete"){const se=d.selection.value.filter(Me=>ue(Me.componentId)).map(Me=>Me.componentId);Ce(...se);return}if(G)if(L.shiftKey)switch(L.key){case"ArrowDown":L.preventDefault(),ke(A)&&P(A);break;case"ArrowUp":L.preventDefault(),Ae(A)&&V(A);break;case"ArrowLeft":L.preventDefault(),ce(A)&&$e(A,pe);break;case"ArrowRight":L.preventDefault(),oe(A)&&ge(A);break}else switch(L.key){case"ArrowDown":L.preventDefault(),N(A);break;case"ArrowUp":L.preventDefault(),y(A);break;case"ArrowLeft":L.preventDefault(),Z(A);break;case"ArrowRight":L.preventDefault(),Ee(A);break;case"v":if(!O(A))return;try{await Be(A)}catch(se){b.pushToast({type:"error",message:String(se)})}break;case"c":W(A)&&Fe(A);break;case"x":H(A)&&M(A);break}}function ot(L){le.value!=="preview"&&f(L)}function lt(L){if(le.value==="preview")return;d.setSelection(null);const G=l(L);if(!G)return;const{draggedType:X,draggedId:A,parentId:pe,position:se}=G;A?_(A,pe,se):v(X,pe,se)}function st(L){if(le.value==="preview"||L.target.closest("[data-writer-unselectable]"))return;const X=L.target.closest("[data-writer-id]");if(!X)return;const A=X.dataset.writerId,pe=X.dataset.writerInstancePath;d.isComponentIdSelected(A)&&d.selectionStatus.value!==Ve.Multiple||(L.preventDefault(),L.stopPropagation(),d.handleSelectionFromEvent(L,A,pe,"click"))}function it(){d.isSettingsBarCollapsed.value=!1}const rt=L=>{if(le.value==="preview")return;const X=L.target.closest("[data-writer-id]").dataset.writerId,{type:A}=h.getComponentById(X);d.selectionStatus.value===Ve.Multiple&&(d.setSelection(X,void 0,"click"),d.isSettingsBarCollapsed.value=!0),L.dataTransfer.setData(`application/json;writer=${A},${X}`,"{}")};function dt(L){d.setSelection(null),c(L)}const Ke=new AbortController;return ne(()=>{document.addEventListener("keydown",nt,{signal:Ke.signal})}),ye(()=>Ke.abort()),(L,G)=>(o(),p("div",{class:"BuilderApp",tabindex:"-1",style:ze(w(Ct))},[n("div",{class:U(["mainGrid",{openPanels:w(d).openPanels.value.size>0}])},[D(Wt,{class:"builderHeader"}),D(to,{class:"sidebar"}),n("div",co,[n("div",po,[D(w(t),{class:U(["componentRenderer",{settingsOpen:w(d).isSingleSelectionActive}]),onDragover:ot,onDragstart:rt,onDragend:dt,onDrop:lt,onClickCapture:st,onDblclick:it},null,8,["class"])]),w(d).isSingleSelectionActive?(o(),I(w(i),{key:at.value??"noneSelected"})):S("",!0)]),D(qn,{class:"panelSwitcher"})],2),le.value!=="preview"?(o(),p(j,{key:0},[w(B)&&!w(a)?(o(),p(j,{key:0},[(o(),I(w(u),{key:w($),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":w($),"match-size":!0},{default:x(()=>[D(w(r))]),_:1},8,["instance-path"])),(o(),I(w(u),{key:w($),class:"insertionLabelTracker","instance-path":w($),"vertical-offset-pixels":-48},{default:x(()=>[D(w(m),null,{default:x(()=>[R(T(w(h).getComponentDefinition(w(h).getComponentById(w(B)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):S("",!0)],64)):S("",!0),G[0]||(G[0]=n("div",{id:"modal"},null,-1)),D(Vt,{id:"tooltip"}),D(uo)],4))}}),mo=E(vo,[["__scopeId","data-v-81e3a55b"]]),yo=Object.freeze(Object.defineProperty({__proto__:null,default:mo},Symbol.toStringTag,{value:"Module"}));export{te as B,tt as W,ya as a,pn as b,yo as c,xe as u};
