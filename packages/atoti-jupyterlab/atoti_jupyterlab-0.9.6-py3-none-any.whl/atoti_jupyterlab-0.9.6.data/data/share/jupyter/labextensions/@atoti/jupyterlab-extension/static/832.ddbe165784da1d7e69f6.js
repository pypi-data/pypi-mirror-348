/*! For license information please see 832.ddbe165784da1d7e69f6.js.LICENSE.txt */
"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[832,4389,6770,9151,5723],{27644:(e,t,r)=>{r.d(t,{L:()=>n});const n=["KPIValue","KPIGoal","KPIStatus","KPITrend","KPIStart","KPIExpiry"]},77565:(e,t,r)=>{r.d(t,{S:()=>n});const n=r(27644).L.map((e=>e.toLowerCase()))},99894:(e,t,r)=>{r.d(t,{o:()=>d});var n=r(74389),i=r(90923),a=r(93345),s=r(97630),o=r(75816);const{useToken:l}=i.theme,d=(0,a.forwardRef)((({label:e,style:t,children:r,isActive:i},d)=>{const c=(0,a.useRef)(null),{token:u}=l(),p=(0,s.DP)(),h=(0,o.useHasOverflow)(c);return(0,n.FD)("div",{ref:d,style:{border:`1px solid ${i?p.primaryColor:u.colorBorder}`,...t,position:"relative",display:"inline-flex",alignItems:"center",paddingTop:`${u.paddingXS}px`,borderRadius:`${u.borderRadius}px`},children:[(0,n.Y)(o.Tooltip,{title:e,trigger:h?["hover"]:[],children:(0,n.Y)("span",{ref:c,css:{position:"absolute",top:"0px",transform:"translateY(-55%)",width:"min-content",maxWidth:"80%",left:u.marginSM,paddingInline:`${u.paddingXS}px`,backgroundColor:t?.backgroundColor,fontSize:10,lineHeight:1.26,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:e})}),r]})}))},30832:(e,t,r)=>{r.r(t),r.d(t,{EmptyWidget:()=>Ft,FiltersBar:()=>it,FiltersEditor:()=>ar,InvalidMdxTypeError:()=>Cr,IsContextMenuOpenProvider:()=>h,MdxInconsistentWithDashboardOrPageFiltersError:()=>Mr,NoDataOverlay:()=>cn,ResizableEditor:()=>Kt,TitleBarMenu:()=>un,Widget:()=>St,WidgetErrorFallback:()=>zr,WidgetIconTooltip:()=>Wr,WidgetInDashboard:()=>Mt,WidgetLoadingBar:()=>tn,WidgetLoadingOverlay:()=>Hr,WidgetLoadingOverlayProvider:()=>jr,addFilters:()=>mn,deriveMappingFromMdx:()=>qr,deriveStateFromMdx:()=>Er,deserializeWidgetState:()=>jt,driveFiltersFromState:()=>je,ensureValidHiddenSubTotalsQueryContextEntry:()=>Zr,filterWidgetState:()=>gn,getAttributeType:()=>mt,getFilteredQuery:()=>cr,getFilteredWidgetState:()=>yn,getFiltersBySection:()=>pr,getFiltersFromSelection:()=>hn,getHiddenSubtotalsLevelCoordinatesFromQueryContext:()=>Jr,getKpiPropertyCaption:()=>Lr,getQueryTotalsMetaData:()=>Xr,getSafeMapping:()=>Br,getStringifiedQuery:()=>hr,getSwitchAvailability:()=>bt,getTargetCube:()=>We,getUpdatedActiveRowIndex:()=>on,getWidgetQuery:()=>mr,isAllMeasuresInMapping:()=>pt,isCompositeHierarchyInMapping:()=>wr,isDataVisualizationWidgetPlugin:()=>vt,isDataVisualizationWidgetState:()=>xt,isHierarchyInMapping:()=>vr,isKpiPropertyInMapping:()=>br,isMappingEmpty:()=>Dt,isMeasureInMapping:()=>fr,isNamedSetInMapping:()=>xr,isWidgetInDashboard:()=>at,isWidgetWithQueryState:()=>Oe,serializeWidgetState:()=>Lt,stringifyWidgetMdx:()=>Et,updateHiddenSubTotalsQueryContextEntry:()=>_r,updateQueryContextEntry:()=>Gr,useContextualizedQuery:()=>$r,useCube:()=>er,useFilters:()=>Je,useIsContextMenuOpen:()=>m,useIsQueryLazyLoaded:()=>ut,useIsQuerySuspended:()=>or,useMdxInViews:()=>Be,useQueryContexts:()=>rt,useSuspendedQueryResult:()=>lr,useSwitchedWidgetState:()=>wt,useUserFilters:()=>Qe,useWidgetName:()=>Ht,useWidgetQueryResult:()=>gr,withLoadingOverlay:()=>sn,withStateCleanup:()=>yr,withWidgetLoadingBar:()=>nn,withWidgetQueryErrorBoundary:()=>Qr,withoutIrrelevantRenders:()=>an});var n=r(40570),i=r(93345),a=r.n(i),s=r(77261),o=r(74389);class l extends Error{actionHandlerKey;availableActionHandlers;constructor(e,t){super(`No action handler with key "${e}" was found. Available action handlers are: ${JSON.stringify(t)}`),this.actionHandlerKey=e,this.availableActionHandlers=t}}var d=r(77483),c=r(95819),u=r(75816);const p=(0,i.createContext)(!1),h=p.Provider;function m(){return(0,i.useContext)(p)}var g=r(90923),y=r(84420);const f=(0,i.createContext)(void 0),b=({children:e,...t})=>(0,o.Y)(f.Provider,{value:t,children:e}),v=()=>{const e=(0,i.useContext)(f);if(void 0===e)throw new Error("Missing `MenuWithItemsProps` provider");const{keys:t,actionProps:r,closeContextMenu:n,...a}=e,s=(0,y.uC)(t),[l,d]=(0,i.useState)([]),c=(0,i.useRef)(!1),u=[],p=[];for(const e of s){!1===e.doesContextMenuCloseOnClick&&p.push(e.key);const t=e.useMenuItem(r);t&&u.push({key:e.key,...t})}return(0,o.Y)(g.Menu,{openKeys:l,onOpenChange:e=>{0!==e.length||!0!==c.current?d(e):c.current=!1},onClick:e=>{p.some((t=>e.keyPath.includes(t)))?c.current=!0:n?.()},...a,items:u})},x=({children:e,widgetKey:t,keys:r,actionProps:n})=>{const[a,s]=(0,i.useState)(!1);return(0,o.Y)(h,{value:a,children:(0,o.Y)(b,{keys:r,actionProps:n,closeContextMenu:()=>s(!1),css:{maxWidth:600},children:(0,o.Y)(u.Dropdown,{onOpenChange:s,dropdownRender:()=>(0,o.Y)(v,{}),trigger:["contextMenu"],children:e},t)})})};var w=r(90147),S=r(31529),C=r(52970),M=r(52216),N=r(94108),k=r(20548),K=r(92133),F=r(5427),D=r(91362),T=r(58544),O=r(47091),Y=r(6316),I=r(78102),P=r(84629),q=r(7679),E=r(27362);function L(e,t){if("members"===e.type&&(0,Y.t)(e))return 0===e.members.length||void 0!==(0,I.D)(e.members[0][0],t);try{return(0,P.q)(e,t),!0}catch(e){if(e instanceof q.O||e instanceof E.h)return!1;throw e}}const W=({filter:e,cubesPerServer:t})=>(0,S.flatMap)(Object.entries(t),(([e,t])=>t.map((t=>({cube:t,serverKey:e}))))).filter((({cube:t})=>L(e,t)));var B=r(97630),$=r(95889),R=r(56934),A=r(38868),V=r(71715),j=r(92673),H=r(70070);const z=H.A.default??H.A,U=j.A.default??j.A,Q=a().forwardRef(((e,t)=>(0,o.Y)(z,{...e,ref:t,icon:U})));var G=r(20952);const _=H.A.default??H.A,J=G.A.default??G.A,X=a().forwardRef(((e,t)=>(0,o.Y)(_,{...e,ref:t,icon:J})));var Z=r(48845),ee=r(75763),te=r(81247),re=r(72879),ne=r(65895),ie=r(28715),ae=r(19879),se=r(85785),oe=r(86998),le=r(67545),de=r(12377),ce=r(99894);const ue=({cube:e,filter:t,onFilterChanged:r,style:n})=>{const[a,s]=(0,i.useState)(!1),[l,d]=(0,i.useState)(!1),{formatMessage:c}=(0,$.useIntl)(),{useToken:p}=g.theme,{token:h}=p(),m=(0,i.useMemo)((()=>{switch(t.type){case"existenceOfValue":return{element:(0,o.Y)(ee.N,{doesExist:t.doesExist,onChange:e=>r({...t,doesExist:e})}),caption:c({id:"aui.filters.existenceOfValue."+(t.doesExist?"exist":"doesNotExist")})};case"topBottomMembers":const n=(0,P.q)({dimensionName:t.dimensionName,hierarchyName:t.hierarchyName},e),i=Object.values(n.levels),a=n.levels[t.levelName].index;let s=c({id:`aui.filters.topBottomMode.${t.topBottomMode}`});return a>1&&"ofEachParent"===t.scope&&(s+=` ${c({id:"aui.filters.in-each"})} ${i[a-1].caption}`),{element:(0,o.Y)(te.c,{topBottomMode:t.topBottomMode,scope:t.scope,levels:i,levelIndex:a,onTopBottomModeChange:e=>r({...t,topBottomMode:e}),onScopeChange:e=>r({...t,scope:e})}),caption:s};case"lowerOrGreaterValue":return{element:(0,o.Y)(re.X,{lowerOrGreaterMode:t.lowerOrGreaterMode,lowerOrGreaterLimit:t.lowerOrGreaterLimit,onModeChange:e=>r({...t,lowerOrGreaterMode:e}),onLimitChange:e=>r({...t,lowerOrGreaterLimit:e})}),caption:`${c({id:`aui.filters.lowerOrGreaterMode.${t.lowerOrGreaterMode}`})} ${t.lowerOrGreaterLimit}`};case"valuesRange":return{element:(0,o.Y)(ne.s,{isBetween:t.isBetween,lowerLimit:t.lowerLimit,upperLimit:t.upperLimit,onIsBetweenChange:e=>r({...t,isBetween:e}),onLowerLimitChange:e=>r({...t,lowerLimit:e}),onUpperLimitChange:e=>r({...t,upperLimit:e})}),caption:`${c({id:"aui.filters.betweenMode."+(t.isBetween?"isBetween":"isNotBetween")})} ${t.lowerLimit} ${c({id:"aui.and"})} ${t.upperLimit}`};case"captionsContaining":return{element:(0,o.Y)(ie.g,{containingMode:t.containingMode,token:t.token,onContainingModeChange:e=>r({...t,containingMode:e}),onTokenChange:e=>r({...t,token:e})}),caption:`${c({id:`aui.filters.containingMode.${t.containingMode}`})} "${t.token}"`};case"lowerOrGreaterCaptions":return{element:(0,o.Y)(ae.s,{lowerOrGreaterMode:t.lowerOrGreaterMode,token:t.token,onLowerOrGreaterModeChange:e=>r({...t,lowerOrGreaterMode:e}),onTokenChange:e=>r({...t,token:e})}),caption:`${c({id:`aui.filters.alphabeticallyBeforeOrAfterMode.${t.lowerOrGreaterMode}`})} "${t.token}"`};case"captionsRange":return{element:(0,o.Y)(se.$,{isBetween:t.isBetween,lowerToken:t.lowerToken,upperToken:t.upperToken,onIsBetweenChange:e=>r({...t,isBetween:e}),onLowerTokenChange:e=>r({...t,lowerToken:e}),onUpperTokenChange:e=>r({...t,upperToken:e})}),caption:`${c({id:"aui.filters.alphabeticallyBetweenMode."+(t.isBetween?"isBetween":"isNotBetween")})} "${t.lowerToken}" ${c({id:"aui.and"})} "${t.upperToken}"`};case"recentDates":return{element:(0,o.Y)(oe.T,{numberOfRecentDates:t.numberOfRecentDates,onNumberOfRecentDatesChange:e=>r({...t,numberOfRecentDates:e})}),caption:`${c({id:"aui.filters.recentDates"})} ${t.numberOfRecentDates}`};default:throw new Error(`Filter not supported by ${ue.name}`)}}),[e,t,r,c]),y="topBottomMembers"===t.type,f="measureName"in t,b={keepThe:c({id:"aui.filters.keepThe"}),whose:f?`${c({id:"aui.filters.whose"})} ${t.measureName}`:"",that:f?"":c({id:"aui.that"}),limit:y?t.limit:"",members:c({id:"aui.filters.members"}),of:c({id:"aui.filters.of"})},v="recentDates"===t.type?(0,o.FD)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,o.FD)("div",{style:{display:"flex",alignItems:"center"},children:[(0,o.Y)(u.Text,{small:!0,children:b.keepThe}),(0,o.Y)(u.Text,{small:!0,children:" "}),m.element,(0,o.Y)(u.Text,{small:!0,children:" "}),b.members]}),(0,o.FD)(u.Text,{small:!0,children:[b.of," ",t.levelName]})]}):(0,o.FD)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,o.FD)("div",{style:{display:"flex",alignItems:"center"},children:[(0,o.Y)(u.Text,{small:!0,children:b.keepThe}),y?(0,o.Y)(g.InputNumber,{type:"number",min:1,style:{width:100,margin:"0 8px"},value:t.limit,onChange:e=>{null!==e&&r({...t,limit:e})}}):(0,o.Y)(u.Text,{small:!0,children:" "}),(0,o.FD)(u.Text,{small:!0,children:[t.levelName," ",b.that]})]}),f&&(0,o.Y)("div",{children:(0,o.Y)(u.Text,{small:!0,children:b.whose})}),(0,o.Y)("div",{style:{display:"flex"},children:m.element})]}),x="recentDates"===t.type?(0,o.FD)("span",{children:[b.keepThe," ",m.caption," ",b.members," ",(0,o.Y)("br",{}),b.of," ",t.levelName]}):(0,o.FD)("span",{children:[b.keepThe," ",b.limit," ",t.levelName,f?(0,o.FD)(o.FK,{children:[(0,o.Y)("br",{}),b.whose,(0,o.Y)("br",{})]}):(0,o.FD)(o.FK,{children:[" ",b.that,(0,o.Y)("br",{})]}),m.caption]});return(0,o.Y)(ce.o,{label:t.levelName,style:n,isActive:a,children:(0,o.Y)(u.Popover,{open:a,placement:"bottomLeft",trigger:"click",showArrow:!1,overlayStyle:{padding:0},onOpenChange:e=>{e&&d(!1),s(e)},content:v,children:(0,o.Y)(u.Tooltip,{title:x,open:l&&!a,onOpenChange:d,children:(0,o.FD)("span",{role:"button",style:{cursor:"pointer",padding:"0px 5px",display:"flex",alignItems:"center",gap:"4px",height:"100%",whiteSpace:"nowrap"},children:[(0,o.Y)(le.V,{cube:e,filter:t,maxMeasureCaptionWidth:100}),(0,o.Y)(de.A,{style:{color:h.colorTextQuaternary}})]})})})})};var pe=r(22431),he=r(83125),me=r(43262),ge=r(35228),ye=r(31572),fe=r(88504),be=r(80458),ve=r(56590),xe=r(31853),we=r(60986),Se=r(17656);const Ce=e=>{const{cube:t,isHierarchyVirtual:r,isHierarchySlicing:n,serverKey:a,onFilterChanged:s,searchValue:l,filter:d,mdxInView:c,filtersAbove:u,queryContext:p}=e,h=(0,B.DP)(),{formatMessage:m}=(0,$.useIntl)(),[{expansion:y,levelIndex:f,selectedMemberNamePathsHistory:b},v]=(0,i.useReducer)(ye.k9,{},(()=>(0,fe.$)(d,t))),x=(0,i.useCallback)((e=>{v({type:"virtualHierarchyMemberSelected",selectedMemberNamePaths:e});const t=(0,w.produce)(d,(t=>{t.members=e}));s(t)}),[d,s]),S=(0,i.useCallback)((({membersTree:e,expansionAction:t})=>{v({type:"memberExpanded",membersTree:e,expansionAction:t})}),[v]),C=(0,i.useCallback)((({searchTree:e,previousSelectedPaths:t,newSelectedPaths:r,isHierarchySlicing:n})=>{const i=(0,ve.g0)({searchTree:e,previousSelectedPaths:t,newSelectedPaths:r,isHierarchySlicing:n}),a=(0,xe.p)({action:i,previousSelectedMemberNamePaths:d.members}),o={...d,members:a};s(o)}),[d,s]),M=(0,i.useCallback)((e=>{const t=(0,w.produce)(d,(t=>{t.members=e,t.includeAllMembers=!1}));s(t)}),[d,s]),N=(0,Y.t)(d),k=d.selectionMode??(n?"single":"multiple");return(0,o.FD)("div",{css:{width:"100%",height:350,backgroundColor:h.grayScale[0],display:"flex",flexDirection:"column"},children:[r?(0,o.Y)(we.y,{serverKey:a,selectedMemberNamePaths:d.members,selectedMemberNamePathsHistory:b,cubeName:t.name,dimensionName:d.dimensionName,hierarchyName:d.hierarchyName,onSelectionChanged:x,levelIndex:f,onLevelIndexChanged:e=>{v({type:"levelIndexChanged",levelIndex:e})},filters:u,queryContext:p,selectionMode:k}):N?(0,o.Y)(ge.e,{serverKey:a,cubeName:t.name,selectedMeasureNames:d.members.map((([e])=>e)),onMeasureSelected:e=>{const t=(0,w.produce)(d,(t=>{t.members=e.map((e=>[e]))}));s(t)}}):(0,o.Y)(Se.C,{levelIndex:f,expansion:y,isSearchVisible:!1,searchValue:l,selectedMemberNamePaths:d.members,serverKey:a,cubeName:t.name,dimensionName:d.dimensionName,hierarchyName:d.hierarchyName,onMemberSelected:({membersTree:e,nodePaths:t,isAllMemberSelected:r})=>{const n={...d,includeAllMembers:r,members:r?[]:(0,be.G)(t,e)};s(n)},onMemberExpanded:S,onSearchResultSelected:C,onMemberRemovedInTooltip:M,hasCheckbox:()=>!0,selectionMode:k,isAllMemberSelected:Boolean(d.includeAllMembers),mdxInView:c,filters:u,queryContext:p}),(0,o.FD)("div",{css:{borderTop:`1px solid ${h.grayScale[5]}`,width:"100%",paddingTop:5,marginTop:5,flexShrink:0,display:"flex",flexDirection:"column"},children:[!N&&(0,o.Y)(g.Checkbox,{checked:"multiple"===k,onChange:e=>{(e=>{const t={...d,selectionMode:e};"single"===e&&(t.includeAllMembers=!1,d.members.length>1&&(t.members=[d.members[0]])),s(t)})(e.target.checked?"multiple":"single")},children:m({id:"aui.filters.selectMultiple"})}),(0,o.Y)(g.Checkbox,{checked:d.isExclusionFilter,onChange:e=>{const t={...d,isExclusionFilter:e.target.checked};s(t)},children:m({id:"aui.filters.excludeFilter"})})]})]})},{Text:Me}=g.Typography,{useToken:Ne}=g.theme,ke="130px",Ke=e=>{const{formatMessage:t}=(0,$.useIntl)(),r=(0,B.DP)(),{cube:a,serverKey:s,onFilterChanged:l,filter:d,filtersAbove:c,queryContext:p,mdxInView:h,style:m}=e,[y,f]=(0,i.useState)(),{token:b}=Ne(),v=(0,Y.t)(d),x=v?void 0:(0,P.q)(d,a),C=(0,i.useCallback)((e=>{const t=(0,w.produce)(d,(t=>{t.members.splice(e,1)}));l(t)}),[d,l]),M=d.members.map(((e,t)=>({key:t,value:{namePath:e,index:t}}))),[N,k]=(0,i.useState)(!1),K=(0,i.useRef)(null),F=(0,i.useRef)(null);(0,pe.A)(F,(()=>{k(!1),f(void 0)}));const[D,T]=(0,u.usePopupSize)(K,`${d.dimensionName}-${d.hierarchyName}`),O=d.members.length>0&&x?Object.values(x.levels)[d.members[0].length-1]:void 0,I=(0,he.O)(d,a),q=I?t({id:"aui.defaultMember"},{caption:I.captionPath.at(-1)}):void 0,E=q&&!N?(0,o.Y)(Me,{ellipsis:{tooltip:q},css:n.css`
          pointer-events: auto;
        `,children:q}):t({id:"aui.filters.searchMembers"});return(0,o.FD)(ce.o,{ref:F,label:v?t({id:"aui.dataVisualization.measures"}):O?.caption||x.caption,isActive:N,style:m,children:[d.isExclusionFilter&&(0,o.Y)(u.Tooltip,{trigger:["hover"],title:t({id:"aui.excluded"}),children:(0,o.Y)(V.IconExclude,{"data-testid":"exclude-icon",style:{marginLeft:b.marginSM,opacity:0===d.members.length?"0.4":"initial"}})}),(0,o.Y)(n.ClassNames,{children:({css:e})=>(0,o.Y)(g.Select,{showArrow:!0,bordered:!1,className:e`
              .ant-select-selection-overflow-item-rest {
                .ant-select-selection-item {
                  height: 20px;
                  background: ${r.grayScale[1]};
                }
              }

              .ant-select-selection-placeholder {
                margin-left: 2px;
              }

              ${0===d.members.length&&I&&!N?`.ant-select-selection-placeholder {\n                position: relative;\n                left: -3px;\n                transform: none;\n                max-width: ${ke};\n                transition: none;\n              }\n              .ant-select-selection-overflow {\n                flex-grow: 0;\n              }\n                `:""}
            `,style:{minWidth:0===d.members.length?ke:void 0,width:"max-content"},open:N,onClick:()=>k((e=>!e)),popupMatchSelectWidth:!1,placeholder:E,searchValue:y,mode:"tags",value:M,maxTagCount:2,onSearch:f,tagRender:({value:e})=>{const{namePath:t,index:r}=e,n=v||x?.slicing?t:t.slice(1),i=n.length>2;return(0,o.Y)(g.Tag,{closable:!0,onClose:()=>{C(r)},style:{display:"inline-flex"},children:(0,o.Y)("span",{css:{maxWidth:ke,display:"inline-flex",flexWrap:"nowrap",gap:2,"span:last-child":{flexShrink:3},"span:not(:last-child)":{flexShrink:5}},children:(0,S.flatMap)((i?[n[0],(0,o.Y)(u.Tooltip,{style:{flexShrink:0},title:n.slice(1,-1).join(" / "),children:"…"}),n.at(-1)]:n).map((e=>["string"==typeof e?(0,o.Y)(Me,{ellipsis:{tooltip:e},children:e}):e,"/"]))).slice(0,-1)})},n.join("/"))},dropdownRender:()=>(0,o.FD)("div",{ref:K,onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),style:{width:T,display:"inline-flex",padding:"4px 8px"},children:[(0,o.Y)(Ce,{cube:a,onFilterChanged:l,isHierarchyVirtual:Boolean(x?.virtual),isHierarchySlicing:Boolean(x?.slicing),serverKey:s,searchValue:y,filter:d,filtersAbove:c,queryContext:p,mdxInView:h}),(0,o.Y)(me.A,{onResize:D})]})})})]})};var Fe=r(33900),De=r(7845),Te=r(43760);function Oe(e){return"query"in e}const Ye=e=>{const{filter:t,section:r,isCorrupt:i,widgetState:a}=e,s=(0,B.DP)(),{useToken:l}=g.theme,{token:d}=l(),{formatMessage:c}=(0,$.useIntl)(),p=(0,Y.t)(t),h={backgroundColor:"widget"===r?d.colorBgBase:s.grayScale[1],color:i?s.errorColor:void 0,border:`1px solid ${i?s.errorColor:d.colorBorder}`},m=Oe(a)&&a.query.mdx?(0,De.getCubeName)(a.query.mdx):void 0,y=i?c({id:"aui.filters.noMatchingCubeForHierarchy"},{missingHierarchy:`[${t.dimensionName}].[${t.hierarchyName}]`,section:r,cubeName:m}):c({id:"aui.dataVisualization.loadingDataModels"});return(0,o.Y)(ce.o,{label:p?c({id:"aui.dataVisualization.measures"}):t.hierarchyName,style:h,children:(0,o.Y)(u.Tooltip,{title:y,trigger:["hover"],children:(0,o.FD)("div",{style:{minWidth:ke,display:"flex",height:"100%",alignItems:"center",padding:"0 2px 0 2px",position:"relative"},children:[(0,o.Y)(n.ClassNames,{children:({css:e})=>(0,o.Y)(g.Skeleton,{className:e({flexGrow:1,".ant-skeleton-paragraph li":{height:"22px !important",backgroundColor:`${i?(0,Te.j)(s.errorColor,.15):void 0} !important`}}),active:!i,paragraph:{rows:1,width:"100%"},title:!1})}),i?(0,o.Y)(Fe.A,{style:{position:"absolute",color:s.errorColor,right:4}}):null]})})})};var Ie=r(24359),Pe=r(42658),qe=r(58117),Ee=r(78402);function Le({cubeName:e,dataModels:t}){const r=[];for(const n in t)for(const i of Object.values(t[n].catalogs))for(const t in i.cubes){if(t===e)return n;r.push(t)}throw new Ee.N(e,r)}function We({dataModels:e,serverKey:t,cubeName:r,lastUsedCube:n}){const i=Object.keys(e);if(0===i.length)throw new N.d({existingServerKeys:i});if(t&&!i.includes(t))throw new N.d({serverKey:t,existingServerKeys:i});if(t&&r){const n=e[t];return{cube:(0,qe.W)(n,r),dataModel:n,serverKey:t}}if(t&&!r){const r=e[t],n=function({serverKey:e,dataModel:t}){const r=Object.values(t.catalogs).find((({cubes:e})=>Object.values(e).length>0));if(void 0===r)throw new Pe.F(e);return Object.values(r.cubes)[0]}({serverKey:t,dataModel:r});return{serverKey:t,dataModel:r,cube:n}}if(!t&&r)return We({dataModels:e,serverKey:Le({cubeName:r,dataModels:e}),cubeName:r});if(n)try{return We({dataModels:e,serverKey:n.serverKey,cubeName:n.cubeName})}catch(e){if(!(e instanceof N.d||e instanceof Ee.N))throw e}return We({dataModels:e,serverKey:i[0]})}function Be({dashboardState:e,pageKey:t,widgetState:r}){const n=(0,F.W)(e,t),a=(0,M.W)(),s=(0,Ie.A)(),o={dashboard:e?(0,S.flatMap)(e.pages,(({content:e})=>Object.values(e))):[],page:n?Object.values(n.content):[],widget:[r]},l=(0,S.mapValues)(o,(e=>e.filter((e=>Oe(e)&&Boolean(e.query.mdx))).map((e=>{const t=e.query.mdx,{serverKey:r}=e;return{cube:We({dataModels:a,serverKey:r,cubeName:(0,De.getCubeName)(t),lastUsedCube:s}).cube,mdx:t}})))),d=(0,i.useRef)(l);return["dashboard","page","widget"].some((e=>l[e].length!==d.current[e].length||l[e].some((({mdx:t},r)=>t!==d.current[e][r].mdx))))&&(d.current=l),d.current}const $e=(0,i.lazy)((async()=>{const{FiltersBarDateRangePicker:e}=await r.e(7156).then(r.bind(r,77156));return{default:e}})),Re=e=>{const{filter:t,onFilterChanged:r,dashboardState:n,pageKey:a,widgetState:s,filtersAbove:l,section:d,queryContext:c,cube:u,serverKey:p}=e,h=Be({dashboardState:n,pageKey:a,widgetState:s})[d],{useToken:m}=g.theme,{token:y}=m(),f=(0,B.DP)(),b={backgroundColor:"widget"===d?y.colorBgBase:f.grayScale[1]};switch(t.type){case"members":return(0,o.Y)(Ke,{cube:u,serverKey:p,onFilterChanged:r,filter:t,filtersAbove:l,mdxInView:h,queryContext:c,style:b});case"previousOrNextTimePeriods":case"timePeriodToDate":case"dateRange":return(0,o.Y)(i.Suspense,{fallback:(0,o.Y)("div",{}),children:(0,o.Y)($e,{filter:t,onFilterChanged:r,serverKey:p,cube:u,filtersAbove:l,mdxInView:h,queryContext:c,style:b})});case"topBottomMembers":case"lowerOrGreaterValue":case"valuesRange":case"lowerOrGreaterCaptions":case"captionsRange":case"captionsContaining":case"existenceOfValue":case"recentDates":return(0,o.Y)(ue,{cube:u,filter:t,onFilterChanged:r,style:b});default:return null}},Ae=e=>{const{filter:t,...r}=e,n=(0,Z.d5)(),i=Object.values(n).some((e=>e.isDataModelLoading)),{applicableCubes:a,filter:s}=t,l=a[0];if(i||!l)return(0,o.Y)(Ye,{filter:s,section:r.section,isCorrupt:!i&&!l,widgetState:r.widgetState});const{cube:d,serverKey:c}=l;return(0,o.Y)(Re,{...r,filter:s,cube:d,serverKey:c})},Ve=e=>{const{dashboardState:t,pageKey:r,widgetState:a,filters:s,queryContextBySection:l,onFilterChanged:d,section:c,isIconVisible:p}=e,h=(0,B.DP)(),{formatMessage:m}=(0,$.useIntl)(),g=(0,i.useRef)(null),{width:y}=(0,u.useDebouncedComponentSize)(g),f=s[c],[{isLeftScrollArrowVisible:b,isRightScrollArrowVisible:v},x]=(0,i.useState)({isLeftScrollArrowVisible:!1,isRightScrollArrowVisible:!1}),w=`1px solid ${h.grayScale[5]}`,S={display:"flex",alignItems:"center",height:"100%",background:h.grayScale[3],borderLeft:w,borderRight:w},C={fontSize:16,margin:6,marginTop:8},M={height:"100%",minWidth:24,zIndex:2,background:h.grayScale[0],position:"absolute",display:"flex",justifyContent:"center"},N=(0,i.useCallback)((()=>{if(g.current){const{scrollLeft:e,scrollWidth:t,clientWidth:r}=g.current,n=e>0,i=e+r<t;b===n&&v===i||x({isLeftScrollArrowVisible:n,isRightScrollArrowVisible:i})}}),[b,v]),k=e=>{g.current?.scrollBy({left:"left"===e?-60:60})};if((0,i.useEffect)((()=>{N()}),[y,N]),!f||0===f.length)return null;const K=f.reduce(((e,t,r)=>{const{filter:n}=t;return n.isPinned&&e.push([t,r]),e}),[]);if(0===K.length)return null;const F=(0,R.D)({sectionName:c,queryContextBySection:l});return(0,o.FD)("div",{style:{display:"flex",alignItems:"stretch",overflow:"hidden",position:"relative"},css:n.css`
        .left-scroll-arrow,
        .right-scroll-arrow {
          visibility: collapse;
        }

        :hover {
          .left-scroll-arrow {
            visibility: ${b?"visible":"collapse"};
          }
          .right-scroll-arrow {
            visibility: ${v?"visible":"collapse"};
          }
        }
      `,children:[p&&"dashboard"===c&&(0,o.Y)(u.Tooltip,{mouseLeaveDelay:0,placement:"bottom",title:m({id:"aui.filters.section.dashboardFilters"}),children:(0,o.Y)("div",{style:S,children:(0,o.Y)(V.IconDashboardFilters,{style:C})})}),p&&"page"===c&&(0,o.Y)(u.Tooltip,{mouseLeaveDelay:0,placement:"bottom",title:m({id:"aui.filters.section.pageFilters"}),children:(0,o.Y)("div",{style:S,children:(0,o.Y)(V.IconPageFilters,{style:C})})}),(0,o.FD)("div",{style:{display:"flex",overflow:"hidden",alignItems:"center"},ref:g,onScroll:N,onWheel:e=>{g.current?.scrollBy({left:e.deltaY<0||e.deltaX<0?-20:20})},children:[(0,o.Y)("div",{className:"left-scroll-arrow",style:{...M,boxShadow:`5px 0 2px -1px ${h.grayScale[5]}`},onClick:()=>{k("left")},children:(0,o.Y)(Q,{})}),(0,o.Y)("div",{style:{display:"flex",gap:"6px",height:"32.5px",margin:"0px 6px",flexShrink:0},children:K.map((([e,n])=>{const{filter:i,applicableCubes:l}=e,u=l[0],p=u?(0,A.f)({filtersBySection:s,position:{sectionName:c,tileIndex:n},cube:u.cube,serverKey:u.serverKey}):[],h="timePeriodToDate"===i.type||"dateRange"===i.type||"previousOrNextTimePeriods"===i.type?"calendar":i.type;return(0,o.Y)(Ae,{filter:e,onFilterChanged:e=>d(e,n),dashboardState:t,widgetState:a,pageKey:r,filtersAbove:p,section:c,queryContext:F},`${e.filter.dimensionName}.${e.filter.hierarchyName}.${h}.${n}`)}))}),(0,o.Y)("div",{className:"right-scroll-arrow",style:{...M,boxShadow:`-5px 0 2px -1px ${h.grayScale[5]}`,right:0},onClick:()=>{k("right")},children:(0,o.Y)(X,{})})]})]})};function je(e){Oe(e)&&(delete e.areFiltersDrivenByMdx,e.query?.mdx&&(e.query.mdx=(0,De.removeAllFilters)(e.query.mdx)))}var He=r(5828),ze=r(48454);const Ue=[];function Qe(){const[e]=(0,He.J)("canUseUserFilters"),[t]=(0,ze.v)("userFilters");return e&&t?t:Ue}const Ge=[],_e=({cubesPerServer:e,filters:t})=>t.map((t=>({filter:t,applicableCubes:W({filter:t,cubesPerServer:e})})));function Je({dashboardState:e,widgetState:t,pageKey:r}){const n=Qe(),a=(0,M.W)(),s=(0,Ie.A)(),o=e?.filters??Ge,l=(0,F.W)(e,r)?.filters??Ge,d=t&&Oe(t)?t.serverKey:void 0,c=t&&Oe(t)?t.query.mdx:void 0,u=t&&Oe(t)?t.filters??Ge:Ge,p=c?(0,De.getCubeName)(c):void 0,h=(0,i.useMemo)((()=>{try{return We({dataModels:a,serverKey:d,cubeName:p,lastUsedCube:s}).cube}catch(e){if(e instanceof N.d||e instanceof Ee.N)return;throw e}}),[a,s,d,p]),m=(0,i.useMemo)((()=>(0,S.mapValues)(a,T.X)),[a]);return(0,i.useMemo)((()=>({...(0,S.mapValues)({user:n,dashboard:o,page:l},(e=>_e({filters:e,cubesPerServer:m}))),widget:u.map((e=>({filter:e,applicableCubes:h&&d&&L(e,h)?[{cube:h,serverKey:d}]:[]})))})),[o,l,n,u,m,h,d])}const Xe=[];function Ze({dashboardState:e,widgetState:t,pageKey:r,userQueryContext:n}){const i=e?.queryContext,a=(0,F.W)(e,r)?.queryContext,s=t?.queryContext;return{user:n??Xe,dashboard:i??Xe,page:a??Xe,widget:s??Xe}}const et=[];function tt(){const[e]=(0,He.J)("canUseUserQueryContext"),[t]=(0,ze.v)("userQueryContext");return e&&t?t:et}function rt({widgetState:e,dashboardState:t,pageKey:r}){const n=tt();return(0,i.useMemo)((()=>Ze({dashboardState:t,widgetState:e,pageKey:r,userQueryContext:n})),[t,e,r,n])}function nt(e){return"dashboardState"in e&&Boolean(e.dashboardState)&&Boolean(e.pageKey)&&Boolean(e.leafKey)}const it=e=>{const t=(0,B.DP)(),r=nt(e)?(0,k.B)(e.dashboardState,e.pageKey,e.leafKey):e.widgetState,n=(0,M.W)(),{dashboardState:a,pageKey:s,leafKey:l,onDashboardChanged:d}={dashboardState:void 0,pageKey:void 0,leafKey:void 0,onDashboardChanged:void 0,...e},c=Je({widgetState:r,dashboardState:a,pageKey:s}),u=(0,i.useMemo)((()=>(0,S.pick)(c,e.filterTypes)),[c,e.filterTypes]),p=(0,i.useMemo)((()=>e.filterTypes.includes("dashboard")&&a?.pinnedDefaultFilters?a.pinnedDefaultFilters.map((e=>{const t={...e,type:"members",members:[],isPinned:!0},r=(0,S.mapValues)(n,T.X);return{filter:t,applicableCubes:W({filter:t,cubesPerServer:r})}})):[]),[a?.pinnedDefaultFilters,n,e.filterTypes]),h=(0,i.useMemo)((()=>e.filterTypes.includes("dashboard")?(0,w.produce)(u,(e=>{e.dashboard.unshift(...p)})):u),[u,p,e.filterTypes]),m=rt({widgetState:r,dashboardState:a,pageKey:s}),g=(0,i.useMemo)((()=>(0,S.filter)(h,(e=>e.some((({filter:e})=>e.isPinned)))).length),[h]),y=g>1;return g>0&&r?(0,o.Y)("div",{css:{display:"flex",overflow:"hidden",alignItems:"center",...!e.filterTypes.includes("widget")&&{background:t.grayScale[1],borderBottom:`1px solid ${t.grayScale[5]}`}},children:e.filterTypes.map(((t,i)=>(0,o.Y)("div",{style:{height:44,display:"flex",alignItems:"stretch",overflow:"hidden"},children:(0,o.Y)(C.ErrorBoundary,{resetKeys:[n],fallbackRender:({error:e})=>{if(e instanceof N.d)return null;throw e},children:(0,o.Y)(Ve,{isIconVisible:y,section:t,filters:h,queryContextBySection:m,onFilterChanged:(r,n)=>{((t,r,n)=>{const i=e=>{e.filters&&(e.filters[n]=t)};if(nt(e)){if(a&&s&&l&&d){const e=(0,w.produce)(a,(e=>{if("dashboard"===r){const r=e.pinnedDefaultFilters?.findIndex((e=>(0,O.q)(e,t)))??-1;-1===r?i(e):(e.pinnedDefaultFilters?.splice(r,1),e.filters=e.filters??[],e.filters.unshift(t)),(0,K.y)(e,je)}if("page"===r){const t=(0,F.W)(e,s);t&&(i(t),(0,D.T)(t,je))}if("widget"===r){const t=(0,k.B)(e,s,l);t&&(i(t),je(t))}}));d(e)}}else{const t=(0,w.produce)(e.widgetState,(e=>{i(e),je(e)}));e.onWidgetChanged(t)}})(r,t,n)},widgetState:r,dashboardState:a,pageKey:s})})},i)))}):null};function at(e){return"dashboardState"in e}function st(e){return()=>e}const ot=[],lt=e=>{const{widgetPlugin:t,onChange:r,isSelected:a,...s}=e,u=(t.useOnDataModelNodeClicked??st)(e.widgetState);(0,c.gO)((e=>{if(a){const t=u(e);r(t)}}));const p=t?.contextMenuItems??ot,h=(0,i.useMemo)((()=>({...s,onWidgetChange:r})),[s,r]),m=function(e){const t=e.widgetState.behavior?.actionHandler,r=(0,d.h)();let n;for(const i of Object.values(r)){const r=i.key===t?.key,a=r?t?.configuration:void 0,s=i.useOnElementsActioned({...e,configuration:a,onWidgetChange:e.onWidgetChange});r&&(n=s)}if(t&&!n)throw new l(t.key,Object.keys(r));return n}(h),{leafKey:g,pageKey:y,dashboardState:f,onDashboardChange:b}=at(e)?e:{leafKey:void 0,pageKey:void 0,dashboardState:void 0,onDashboardChange:void 0},v=Oe(e.widgetState)&&(0,o.Y)("div",{style:{flexGrow:0,marginRight:2,marginLeft:2,paddingLeft:14},children:(0,o.Y)(it,{dashboardState:f,leafKey:g,pageKey:y,filterTypes:["widget"],onDashboardChanged:b,widgetState:e.widgetState,onWidgetChanged:e.onChange})});return(0,o.Y)(x,{widgetKey:e.widgetState.widgetKey,keys:p,actionProps:h,children:(0,o.FD)("div",{css:n.css`
          height: 100%;
          display: flex;
          flex-direction: column;
        `,children:[v,(0,o.Y)("div",{css:{flexGrow:1,minHeight:0},children:(0,o.Y)(t.Component,{...e,onElementsActioned:m})})]})})};var dt=r(30540),ct=r(21958);function ut({queryId:e,widgetState:t}){const r=(0,ct.J)({queryId:e,serverKey:t&&Oe(t)?t.serverKey:void 0});return!(!r?.data||!(0,dt.isCellSet)(r.data))&&r.data.axes.some((({range:e})=>e&&!e.entireAxis))}const pt=e=>"allMeasures"===e.type,ht={primaryNumeric:"numeric",primaryOrdinal:"ordinal",secondaryNumeric:"numeric",secondaryOrdinal:"ordinal",subplot:"ordinal"};function mt(e){return ht[e]}const gt=(e,t,r)=>{for(let n=0;n<t.length&&0!==r.length;n++){const i=t[n],a=i.maxNumberOfFields||1/0;for(;e[i.name].length<a&&r.length>0;){const t=r.shift();t&&e[i.name].push(t)}}};function yt(e,t){return t.doesSupportMeasuresRedirection?e:e.filter((e=>!pt(e)))}function ft(e,t){const r=t.attributes??{},n=(0,S.mapValues)(r,(()=>[])),i=function(e){const t=Object.entries(e).map((([e,t])=>({...t,name:e}))),r=(0,S.groupBy)(t,(e=>mt(e.role)));return(0,S.mapValues)(r,(e=>(0,S.groupBy)(e,"role")))}(r);return Object.entries(e).forEach((([e,r])=>{const a=[],s=i?.[e]||[];if(Object.entries(r).forEach((([e,r])=>{const i=[],o=s?.[e]||[];!function({mapping:e,attributes:t,fields:r,unmappedFields:n,widgetPlugin:i}){r.forEach(((r,a)=>{const s=yt(r,i),o=t[a];if(o){const t=o.maxNumberOfFields||1/0;s.forEach((r=>{e[o.name].length<t?e[o.name].push(r):n.push(r)}))}else n.push(...s)}))}({mapping:n,attributes:o,fields:r,unmappedFields:i,widgetPlugin:t}),i.length>0&&gt(n,o,a),a.push(...i)})),a.length>0&&gt(n,(0,S.flatten)(Object.values(s)),a),a.length>0)throw new Error(`The chosen widget type does not support the current mapping: too many chosen ${e} fields.`)})),n}function bt(e,t,r){const n=Object.entries(e).reduce(((e,[n,i])=>{const a=mt(t[n].role),s=yt(i,r);return{...e,[a]:e[a]+s.length}}),{numeric:0,ordinal:0}),i=r.attributes||{},a=Object.values(i).reduce(((e,t)=>{const r=mt(t.role);return{...e,[r]:e[r]+(t.maxNumberOfFields||1/0)}}),{numeric:0,ordinal:0});return n.numeric>a.numeric?{status:"tooManyNumeric",maxNumberOfFields:a.numeric}:n.ordinal>a.ordinal?{status:"tooManyOrdinal",maxNumberOfFields:a.ordinal}:{status:"ok"}}const vt=e=>"dataVisualization"===e.category,xt=(e,t)=>{if(e.widgetKey!==t.key)throw new Error(`Expected widgetPlugin's key to be ${e.widgetKey} but was ${t.key}`);return vt(t)};function wt(e,t){const[r]=(0,s.useWidgetPlugins)(e?[e.widgetKey]:[]),n=e&&xt(e,r)?e.switchedTo:void 0,a=ut({queryId:t,widgetState:e}),[o]=(0,s.useWidgetPlugins)(n?[n]:[]);return(0,i.useMemo)((()=>{const t=void 0!==o?.lazyLoading;if(!(e&&xt(e,r)&&vt(r)&&o&&vt(o))||a&&!t)return e;const n=function(e,t,r){const n=e.mapping,i=t.attributes||{},a=r.attributes||{},s=t.doesSupportMeasuresRedirection,o=r.doesSupportMeasuresRedirection,l=ft(function(e,t){const r={};return Object.entries(t).forEach((([t,n])=>{const i=mt(n.role);(0,S.defaultsDeep)(r,{[i]:{[n.role]:[]}}),r[i][n.role].push(e[t]||[])})),r}(n,i),r);if(s&&!o){const e=(0,S.findKey)(l,(e=>e.some(pt)));e&&(l[e]=l[e].filter((e=>!pt(e))))}else if(!s&&o){const t=e.query.mdx,r="ROWS"===(t&&(0,De.getMeasuresAxisName)(t))?"primaryOrdinal":"secondaryOrdinal",n=(0,S.findKey)(a,(e=>e.role===r));n&&l[n].push({type:"allMeasures"})}return l}(e,r,o);return(0,w.produce)(e,(e=>{e.widgetKey=o.key,Reflect.deleteProperty(e,"switchedTo"),e.mapping=n}))}),[o,r,e,a])}const St=e=>{const{onSelectionChange:t}=e,[r,a]=(0,i.useState)(e.widgetState),o=e.onChange?e.widgetState:r,l=e.onChange??a,d=wt(o),[c]=(0,s.useWidgetPlugins)([d.widgetKey]),[u,p]=(0,i.useState)(void 0),h=(0,i.useCallback)((e=>{p(e),t&&t(e)}),[p,t]);return(0,n.createElement)(lt,{...e,widgetState:d,widgetPlugin:c,selection:u,onSelectionChange:h,onChange:l,key:d.widgetKey})};var Ct=r(81442);const Mt=e=>{const t=e.widgetState.widgetKey,[r]=(0,s.useWidgetPlugins)([t]),a=(0,Ct.b)(),l=(0,i.useMemo)((()=>({...a,widget:e.leafKey,page:e.pageKey})),[a,e.leafKey,e.pageKey]);return(0,o.Y)(Ct.t,{value:l,children:(0,n.createElement)(lt,{...e,widgetPlugin:r,key:t})})},Nt={whenInRows:{paddingRight:8}},kt={whenInRows:{paddingLeft:8,paddingTop:2}},Kt=e=>(0,o.Y)(u.DynamicResizable,{widthThreshold:400,firstChildStyle:Nt,secondChildStyle:kt,children:e.children}),Ft=()=>{const e=(0,B.DP)();return(0,o.FD)("div",{css:n.css`
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      `,children:[(0,o.FD)("svg",{viewBox:"64 64 896 896",width:"64",height:"64",fill:"currentColor",children:[(0,o.Y)("path",{d:"M134.4 269.5l-1.9 1.8c-14.3 14.1-14.2 32.7-14.2 39.7.4 149.2.4 300.9.4 447.7v99.6a44.7 44.7 0 0044.6 44.7l184.1 1c16.5-.7 31.7-8.1 41.7-21.2a52.4 52.4 0 009.4-45.7A120.8 120.8 0 00388 811c-.8-1.3-1.5-2.7-2.2-4.1-5.5-10-10.3-18.7-11.5-26.5-3.2-21.2 3.7-42.3 18.1-55 9.2-8.2 20.8-12.3 34.3-12.3a82.6 82.6 0 0122.7 3.5c18.2 5.1 26.9 19.4 30.5 27.5a59.4 59.4 0 01-.8 50c-1.3 2.9-3 5.9-4.7 9.1-5.3 9.7-11.2 20.7-14.7 34.2a52.7 52.7 0 0051.1 65.9h66c36.6 0 73.8.1 110.5.5h1.6c7.1 0 23.3-.8 36.2-12.7l-57.1-60v.5l-91.9-.3c-10.8 0-21.6 0-32.3-.3H541c.9-1.5 1.9-3.3 2.8-5.2a130.6 130.6 0 001.9-111c-14.9-33.3-42.8-57.9-76.6-67.5a156 156 0 00-42.4-6.2 128.8 128.8 0 00-26.5 2.7 120.9 120.9 0 00-55.5 27.6c-32.6 28.9-48.5 74.9-41.5 120 2.4 15.4 14 40.6 14 40.6H190.7v-72.6c0-140.7 0-286.1-.4-429.4h1.3l-57.2-60.2",fill:"currentColor"}),(0,o.Y)("path",{d:"M924.9 566a50.6 50.6 0 00-.5-6.8c-6.8-43.6-31.6-79.1-67.9-97.3s-76.4-16.7-113.4 2.7l-1.2.6c.1-21.4.1-42.8 0-63.7 0-29.9 0-60.8.3-91.1.1-7.2.3-26.2-14.2-40.7s-33.3-14.1-39.6-14.1c-31.9.4-64.6.4-96.1.4h-52.2c.8-1.4 1.6-3 2.4-4.6 19-39.5 19-83 .2-119.6s-51.7-59.3-92-66.2a47.1 47.1 0 00-7.4-.6h-28.9a48.7 48.7 0 00-7.6.6c-42.3 7.2-74.1 30.3-91.8 66.9-19.9 41-19.9 81.1.1 119l3.6 6.6c-49 .2-99.2.3-148.5-.3-5.8-.1-23-.3-36.8 12l57.3 60.2c50.1.5 100.5.2 149.4 0h7.7c7.2-.1 26.2-.1 41.1-16a44.6 44.6 0 0011.5-24.8c3.5-28.3-8.3-48.2-16.9-62.8-1.8-3-3.5-5.9-4.9-8.6-9.1-17.3-8.8-33.9 1-54 7.3-15.2 18.4-23.3 36.8-26.8h23.9c17.1 3.5 30.6 13.2 38.1 27.7 8.4 16.3 8 36.4-1.1 55.3a97.3 97.3 0 01-4.8 8.5c-5.4 9.2-12.7 21.7-15 39.7-.9 6.9-3.6 27.7 11.3 44.4 6.4 7.2 18.2 15.9 37.7 15.6 28.5-.2 57.5-.2 85.6-.2 25.5 0 51.7 0 77.9-.2-.2 24.7-.2 49.5-.2 73.6.1 31.8.1 64.7-.3 96.9-.3 18.3 5.3 32.4 16.6 42s25.6 12.5 43.1 9.4 29-10.5 39.1-16.5l8.4-4.9c16.4-8.5 33.3-9.3 47.6-2.1s25.2 22.8 28.7 42.3V594c-3.9 20.1-14.6 35.7-29.7 42.9s-31.2 5.7-47.6-3.5l-4.8-2.7c-15.1-8.6-35.7-20.3-62.3-18.4a44.3 44.3 0 00-20.8 6.9c-21.2 13.8-20.3 44.5-20 46.9 0 .2.1.4.1.6v8.3c-.3 51.4-.5 104.4 0 157l57 60 1.3-1.2c14.3-14.3 14-33.4 14-39.6-.6-51.6-.5-104-.3-155.1 37 20.8 78.8 22.9 114.5 5.7s62.5-53.5 69.9-98.1a45.6 45.6 0 00.6-7.5z",fill:e.primaryColor})]}),(0,o.Y)("h4",{className:"ant-typography",css:n.css`
          font-size: 14px;
          line-height: 22px;
          font-weight: 400;
          color: rgba(0, 0, 0, 0.85);
          margin: 0px;
        `,children:"Drag widget to dashboard."})]})},Dt=e=>!e||Object.values(e).every((e=>!e||e.every(pt)));var Tt=r(1386);class Ot extends Error{mappingType;attributeName;constructor(e,t){super(`Can not serialize the "${t}" field with "${e}" type in mapping. Available types are: 'allMeasures', 'measure', 'gluedHierarchy', 'hierarchy', 'kpiProperty'.`),this.mappingType=e,this.attributeName=t}}const Yt=e=>"mapping"in e,It=e=>{const t=(0,De.quote)(e.dimensionName,e.hierarchyName,e.levelName);return e.expandedDownTo?`${t} => ${(0,De.quote)(e.dimensionName,e.hierarchyName,e.expandedDownTo)}`:t};function Pt(e){return"style"in e}var qt=r(31286);function Et(e){const t={...e,filters:e.filters?.map(qt.V)};return void 0===t.filters&&delete t.filters,Oe(t)&&Oe(e)&&e.query.mdx&&(t.query={...e.query,mdx:(0,De.stringify)(e.query.mdx)}),t}function Lt(e){return Et(function(e){return Yt(e)?(0,w.produce)(e,(e=>{const{mapping:t}=e;return Object.entries(t).forEach((([t,r])=>{const n=r.map((e=>{if(void 0===e.type)return e;switch(e.type){case"compositeHierarchy":return e.hierarchies.map(It).join(" => ");case"hierarchy":return It(e);case"allMeasures":return"ALL_MEASURES";case"measure":return(0,De.quote)("Measures",e.measureName);case"kpiProperty":{const{kpiName:t,propertyName:r,underlyingMeasureName:n}=e;return(0,Tt.L)({kpiName:t,kpiPropertyName:r,underlyingMeasureName:n})}case"namedSet":return(0,De.quote)(e.name);default:throw new Ot(e.type,t)}}));e.mapping[t]=n})),e})):e}(function(e){if(!Pt(e))return e;const t=e.style?.tupleImpactingRowStyle;if(!t)return e;const r={...e.style,tupleImpactingRowStyle:t.map((({dimensionName:e,hierarchyName:t,namePath:r})=>(0,Y.t)({dimensionName:e})?(0,De.quote)(e,...r):(0,De.quote)(e,t,...r)))};return{...e,style:r}}(e)))}var Wt=r(27644),Bt=r(77565);class $t extends Error{attributeName;serializedMappingField;constructor(e,t){super(`Can not deserialize the "${t}" field with stringified value "${e}" in mapping.`),this.attributeName=t,this.serializedMappingField=e}}const Rt=/^\[.*\]$/,At=e=>"mapping"in e;var Vt=r(63747);function jt(e){const t=function(e){return At(e)?(0,w.produce)(e,(e=>{const t=e.mapping;return Object.entries(t).forEach((([t,r])=>{const n=r.map((e=>{if("ALL_MEASURES"===e)return{type:"allMeasures"};if(e.startsWith("[Measures]."))return{type:"measure",measureName:(0,De.unquote)(e)[1]};if(e.startsWith("KPI")){const t=function(e){const t=new Error(`Unable to parse string "${e}" as a KPI property.`),r=e.indexOf("(");let n=1,i=r+1;for(;n>0&&i<e.length;)"("===e[i]&&n++,")"===e[i]&&n--,i++;if(n>0)throw t;const a=i-1,s=e.slice(0,r),o=e.slice(r+1,a),l=e.slice(a+3),d=Wt.L.find(((e,t)=>Bt.S[t]===s.toLowerCase()));if(!d)throw t;return{kpiName:o,kpiPropertyName:d,underlyingMeasureName:l}}(e);return{type:"kpiProperty",propertyName:t.kpiPropertyName,kpiName:t.kpiName,underlyingMeasureName:t.underlyingMeasureName}}if(e.indexOf(" => ")>-1){const t=e.split(" => "),r=[];for(let e=0;e<t.length;e++){const[n,i,a]=(0,De.unquote)(t[e]),s=r.at(-1);(0,O.q)({dimensionName:n,hierarchyName:i},s)?s.expandedDownTo=a:r.push({dimensionName:n,hierarchyName:i,levelName:a})}return 1===r.length?{type:"hierarchy",...r[0]}:{type:"compositeHierarchy",hierarchies:r}}if(Rt.test(e)){const t=(0,De.unquote)(e);if(1===t.length)return{type:"namedSet",name:t[0]};const[r,n,i]=t;return{levelName:i,dimensionName:r,hierarchyName:n,type:"hierarchy"}}throw new $t(e,t)}));e.mapping[t]=n})),e})):e}(function(e){const t={...e,filters:e.filters?.map(Vt.w)};return void 0===t.filters&&delete t.filters,Oe(e)&&Oe(t)&&e.query.mdx&&(t.query={...e.query,mdx:(0,De.parse)(e.query.mdx)}),t}(function(e){if(!Pt(e))return e;const t=e.style?.tupleImpactingRowStyle;if(!t)return e;const r={...e.style,tupleImpactingRowStyle:t.map((e=>{const t=(0,De.unquote)(e);return 2===t.length&&"Measures"===t[0]?{dimensionName:"Measures",hierarchyName:"Measures",namePath:[t[1]]}:{dimensionName:t[0],hierarchyName:t[1],namePath:t.slice(2)}}))};return{...e,style:r}}(e)));return t}function Ht(e){const{formatMessage:t}=(0,$.useIntl)();return e.name??t({id:`aui.plugins.widget.${e.widgetKey}.defaultName`})}var zt=r(54610),Ut=r(13304),Qt=r(93720),Gt=r(12673),_t=r(48979),Jt=r(54571),Xt=r(58891),Zt=r(17797);function er({initialCubeName:e,serverKey:t,...r}){const n=(0,Ie.A)();return We({cubeName:Oe(r)&&r.query.mdx?(0,De.getCubeName)(r.query.mdx):e,serverKey:t,dataModels:(0,M.W)(),lastUsedCube:n})}const tr=[],rr=({dragItem:e})=>e&&((0,_t.a)(e)||(0,Ut.x)(e)||(0,Qt.G)(e)||(0,Jt.Y)(e)||(0,Gt.f)(e));function nr(e,t){e.filters=t,je(e)}const ir=(0,Zt.n)((e=>{const{widgetState:t,onWidgetChange:r}=e,{cube:n,serverKey:a}=er(t),s=(0,zt.M)(e),{dashboardState:l,leafKey:d,pageKey:u,onDashboardChange:p}=s?e:{},[h,m]=(0,i.useState)(),g=Be({dashboardState:l,pageKey:u,widgetState:t}),[y]=(0,He.J)("canUseUserFilters"),[f,b]=(0,ze.v)("userFilters"),v=f??tr,x=Je({widgetState:t,dashboardState:l,pageKey:u}),C=rt({widgetState:t,dashboardState:l,pageKey:u}),M=({serverKey:e,cubeName:t,dimension:r,hierarchy:n,position:i})=>{m({serverKey:e,cubeName:t,hierarchyCoordinates:{dimensionName:r.name,hierarchyName:n.name},position:i,levelIndex:n.slicing?0:1,type:"create-filter"})},N=(0,i.useCallback)((({serverKey:e,cubeName:t,dimension:r,position:n})=>{const i=r.hierarchies[r.defaultHierarchy];M({serverKey:e,cubeName:t,dimension:r,hierarchy:i,position:n})}),[]),T=(0,i.useCallback)(((e,t)=>{const r=x.widget.length;switch(e.type){case"dimension":N({serverKey:e.serverKey,cubeName:e.cubeName,dimension:e.dimension,position:{sectionName:"widget",tileIndex:r}}),t.preventDefault();break;case"hierarchy":case"level":M({serverKey:e.serverKey,cubeName:e.cubeName,dimension:e.dimension,hierarchy:e.hierarchy,position:{sectionName:"widget",tileIndex:r}}),t.preventDefault()}}),[x.widget.length,N]);(0,c.z4)(T);const O=["widget"];s&&O.unshift("dashboard","page"),y&&O.unshift("user");const Y=l&&p?e=>{const t=(0,w.produce)(l,(t=>{t.pinnedDefaultFilters=e}));p?.(t)}:void 0;return(0,o.Y)(Xt.l,{areCubeFiltersVisible:!0,pinnedDefaultFilters:l?.pinnedDefaultFilters,onPinnedDefaultFiltersChanged:Y,serverKey:a,cubeName:n.name,filters:x,queryContextBySection:C,onFiltersChange:e=>{const n=e.user;y&&!(0,S.isEqual)(n,v)&&b(n);const i=e.widget;if(l&&p){const t=(0,w.produce)(l,(t=>{const r=e.dashboard;(0,S.isEqual)(r,l.filters)||(t.filters=r,(0,K.y)(t,je));const n=(0,F.W)(t,u),a=e.page;if(n&&!(0,S.isEqual)(a,n.filters)&&(n.filters=a,(0,D.T)(n,je)),d){const e=(0,k.B)(t,u,d);e&&nr(e,i)}return t}));return void p(t)}const a=(0,w.produce)(t,(e=>{nr(e,i)}));r(a)},canDrop:rr,popoverConfiguration:h,onPopoverConfigurationChanged:m,mdxInViews:g,visibleSectionNames:O})})),ar=e=>{const{widgetState:t,queryType:r="select",...n}=e;return Oe(t)?(0,o.Y)(ir,{widgetState:t,queryType:r,...n}):null};var sr=r(41575);function or({isDeferred:e,pageKey:t}){const r=(0,sr.g)(),n=Boolean(t&&r&&t!==r);return e||n}function lr({serverKey:e,queryId:t,query:r,pageKey:n,isDeferred:a}){const s=(0,Z.mF)(e),o=or({isDeferred:a,pageKey:n});return(0,i.useEffect)((()=>{if(!s||!t||!o)return;const e=s.getQuery(t);e&&"realTime"===e.updateMode&&s.setQuery(t,{...e,updateMode:"once"})}),[t,o,s]),(0,ct.J)({serverKey:e,queryId:t,query:o?void 0:r})}var dr=r(25155);function cr(e,{areFiltersDrivenByMdx:t,cube:r,filters:n}){if(!e.mdx||t)return e;const i=n.reduce(((e,t)=>{if(!L(t,r))return e;const n=(0,dr.l)(t,r);return n?(e.push({mdx:n,nonVisualTotals:t.nonVisualTotals}),e):e}),[]);return{...e,mdx:(0,De.setFilters)(e.mdx,{filters:i,cube:r})}}const ur=[];function pr({dashboardState:e,widgetState:t,pageKey:r,userFilters:n}){return{user:n??ur,dashboard:e?.filters??ur,page:(0,F.W)(e,r)?.filters??ur,widget:t?.filters??ur}}function hr(e){if(e.mdx)return{...e,mdx:(0,De.stringify)(e.mdx,{indent:!0})}}function mr(e,{dashboardState:t,pageKey:r,queryRanges:n,userFilters:i,userQueryContext:a,dataModels:s,lastUsedCube:o}){if(!e.query.mdx)return;const l=Ze({dashboardState:t,widgetState:e,pageKey:r,userQueryContext:a}),d=(0,R.D)({sectionName:"widget",queryContextBySection:l}),c={...e.query,context:d},u=(0,S.flatMap)(pr({dashboardState:t,widgetState:e,pageKey:r,userFilters:i})),{cube:p}=We({cubeName:(0,De.getCubeName)(e.query.mdx),serverKey:e.serverKey,dataModels:s,lastUsedCube:o}),h=hr(cr(c,{filters:u,cube:p,areFiltersDrivenByMdx:e.areFiltersDrivenByMdx}));return h?{...h,ranges:n}:void 0}function gr({serverKey:e,queryId:t,widgetState:r,dashboardState:n,pageKey:a,cube:s,queryRanges:o,isDeferred:l}){const d=(0,M.W)(),c=function(e,{dashboardState:t,pageKey:r,queryRanges:n,dataModels:a}){const s=Qe(),o=tt(),l=(0,Ie.A)();return(0,i.useMemo)((()=>mr(e,{dashboardState:t,pageKey:r,userFilters:s,userQueryContext:o,queryRanges:n,dataModels:a,lastUsedCube:l})),[t,s,r,o,e,n,a,l])}(r,{dashboardState:n,pageKey:a,queryRanges:o,dataModels:(0,i.useMemo)((()=>{if(e){if(!d[e])throw new N.d({serverKey:e,existingServerKeys:Object.keys(d)});return{[e]:d[e]}}{const e=Le({cubeName:s.name,dataModels:d});return{[e]:d[e]}}}),[s,e,d])});return lr({serverKey:e,queryId:t,query:c,pageKey:a,isDeferred:l})}function yr({cleanedUpProperty:e,getTrigger:t}){return r=>n=>(0,o.Y)(r,{...n,onWidgetChange:r=>{const i=t(r)!==t(n.widgetState)?(0,w.produce)(r,(t=>{delete t[e]})):r;n.onWidgetChange(i)}})}const fr=e=>"measure"===e.type;function br(e){return"kpiProperty"===e.type}const vr=e=>"hierarchy"===e.type,xr=e=>"namedSet"===e.type,wr=e=>"compositeHierarchy"===e.type;var Sr=r(59068);class Cr extends Error{constructor(e){super(`Expected an MdxSelect or an MdxDrillthrough, but received an MDX of type "${e.elementType}".`)}}class Mr extends Error{constructor(){super("The provided MDX is incompatible with the dashboard or page filters.")}}class Nr extends Error{}var kr=r(20852),Kr=r(16860);const Fr=({dimensionName:e,hierarchyName:t,levelName:r})=>(0,De.quote)(e,t,r),Dr=({levels:e,expansionChains:t,cube:r})=>{const n=[],i=e.slice(),a=t.slice();for(;i.length>0;){const t=i.shift(),s=(0,S.remove)(a,(([e])=>(0,kr.M)(e,t)));if(s.length>1)throw new Nr(`The level ${Fr(t)} belongs to several expansion chains: ${JSON.stringify(s.map((e=>e.map(Fr))),null,2)}`);if(0===s.length)n.push({type:"hierarchy",...t});else{const a=[t];s[0].slice(1).forEach((t=>{if(!(0,S.remove)(i,(e=>(0,kr.M)(e,t)))[0]){const r=Fr(t),n=JSON.stringify(e.map(Fr));throw new Nr(`The level ${r} is in an expansion chain, but does not contribute to the axis dimensionality: ${n}.`)}const n=a.at(-1);if((0,O.q)(n,t)){const e=(0,Kr.r)(t,r).name;n.expandedDownTo=e}else a.push(t)})),n.push(a.length>1?{type:"compositeHierarchy",hierarchies:a}:{type:"hierarchy",...a[0]})}}if(a.length>0)throw new Nr(`Some expansion chains are incompatible with the levels used on the axis:\n      Incompatible expansion chains: ${JSON.stringify(a.map((e=>e.map(Fr))))}\n      Levels used on axis: ${JSON.stringify(e.map(Fr))}\n      `);return n},Tr=(e,t)=>(0,kr.M)(e.at(-1),t.fromLevel)?"right":!!(0,kr.M)((0,S.first)(e),t.toLevel)&&"left";function Or(e,t=[]){if(0===e.length)return t;if(0===t.length){const r=e.pop();t.push([r.fromLevel,r.toLevel])}for(let r=0;r<e.length;r++){const n=e[r];for(const i of t){const a=Tr(i,n);if(a)return e.splice(r,1),"right"===a?i.push(n.toLevel):i.unshift(n.fromLevel),Or(e,t)}}return[...t,...Or(e)]}function Yr(e){return Or(e.slice())}const Ir=(e,t)=>(0,S.uniqWith)(e.map((({tupleCoordinates:e,toLevel:r})=>{const n=e.at(-1);if((0,Y.t)(n))throw new Nr("'Expand by' under a measure is not supported.");const{dimensionName:i,hierarchyName:a,namePath:s}=n,o=(0,P.q)({dimensionName:i,hierarchyName:a},t),l=s.length-1;return{fromLevel:{dimensionName:i,hierarchyName:a,levelName:Object.keys(o.levels)[l]},toLevel:r}})),S.isEqual),Pr=["value","goal","start","expiry","status","trend"];function qr({mdx:e,cube:t,widgetPlugin:r}){const{attributes:n,doesSupportMeasuresRedirection:i}=r;if(!n)throw new Error("Cannot derive a mapping from Mdx for a widget plugin which does not define attributes.");if(!e)return r.initialState.mapping;const a=function({mdx:e,cube:t,shouldIncludeAllMeasures:r=!0}){const[n,i]=["ROWS","COLUMNS"].map((r=>{const n=(e?.axes||[]).find((({name:e})=>e.toUpperCase()===r));if(void 0===n)return[];const i=(0,De.getLevels)(n,{cube:t}).filter((e=>(0,P.q)(e,t).slicing||"ALL"!==e.levelName));try{const e=(0,De.getExpandedTuples)(n,t),r=Yr(Ir(e,t));return Dr({levels:i,expansionChains:r,cube:t})}catch(e){if(e instanceof Nr)return i.map((e=>({...e,type:"hierarchy"})));throw e}})),a=(0,De.getMeasureNames)(e),s=(0,De.getCalculatedMeasures)(e),o=a.map((e=>{const r=(0,De.quote)("Measures",e),n=!1===(0,I.D)(e,t)?.visible;let i;const a=s[e]?.properties.find((({name:e})=>"MEMBER_CAPTION"===e||"CAPTION"===e))?.expression;if(void 0!==a&&(0,De.isMdxLiteral)(a)&&(i=a.value),n)for(const n of Object.values(t.kpis))for(const t of Pr)if(n[t]===r)return[{type:"kpiProperty",kpiName:n.name,propertyName:`KPI${(0,S.capitalize)(t)}`,underlyingMeasureName:e}];return i?[{measureName:e,type:"measure",caption:i}]:[{measureName:e,type:"measure"}]}));if(r)if(0===a.length)i.unshift({type:"allMeasures"});else{const t=(0,De.getMeasuresAxisName)(e),r=(0,De.getMeasuresPositionOnAxis)(e.axes.find((e=>e.name===t)));("ROWS"===t?n:i).splice(r,0,{type:"allMeasures"})}return{numeric:{primaryNumeric:o},ordinal:{primaryOrdinal:[n],secondaryOrdinal:[i]}}}({mdx:e,cube:t,shouldIncludeAllMeasures:i});return ft(a,r)}function Er({widgetState:e,mdx:t,dashboardState:r,pageKey:n,leafKey:i,dataModels:a,widgetPlugin:s,lastUsedCube:o,shouldRemoveFiltersFromQuery:l}){const d=void 0!==r;if(d&&(void 0===n||void 0===i))throw new Error("Must pass a page key and leaf key along with the dashboard state.");if("Select"!==t.elementType&&"Drillthrough"!==t.elementType)throw new Cr(t);const{serverKey:c,cube:u}=function({dataModels:e,lastUsedCube:t,mdx:r,widgetState:n}){const i=r?(0,De.getCubeName)(r):void 0;if(n.serverKey&&i)try{const t=n.serverKey;return{serverKey:t,dataModel:e[t],cube:(0,qe.W)(e[t],i)}}catch(r){if(r instanceof Ee.N)return We({serverKey:void 0,dataModels:e,cubeName:i,lastUsedCube:t});throw r}return We({dataModels:e,serverKey:n.serverKey,cubeName:i,lastUsedCube:t})}({dataModels:a,widgetState:e,lastUsedCube:o,mdx:t}),p=(0,De.getFilters)(t,{cube:u});let h=0;if(d){const e=[...r.filters??[],...r.pages[n].filters??[]];if(h=e.length,!e.every(((e,t)=>{if(!p[t])return!1;const{mdx:r,nonVisualTotals:n}=p[t],i=(0,Sr.H)(r,{cube:u,nonVisualTotals:n});return"custom"===e.type?"custom"===i.type&&(0,S.isEqual)(e.mdx,r):(0,S.isEqual)((0,S.omit)(e,["isExclusionFilter","isPinned"]),(0,S.omit)(i,["isExclusionFilter","isPinned"]))&&Boolean(i.isExclusionFilter)===Boolean(e.isExclusionFilter)&&Boolean(i.isPinned)===Boolean(e.isPinned)})))throw new Mr}const m=(0,w.produce)(e,(e=>{Oe(e)&&t&&("Drillthrough"===t.elementType&&function(e,t){const r=e.query.mdx;if("Drillthrough"!==r?.elementType)return;const n=(0,De.getDrillthroughColumns)(t),i=(0,De.getDrillthroughColumns)(r);(0,S.isEqual)(n,i)||delete e.shouldUseDefaultColumns}(e,t),l??1?e.query.mdx=(0,De.setFilters)(t,{filters:[],cube:u}):(e.query.mdx=t,e.areFiltersDrivenByMdx=!0)),e.filters=(d&&h?p.slice(h):p).map((({mdx:e,nonVisualTotals:t})=>(0,Sr.H)(e,{cube:u,nonVisualTotals:t}))),e.serverKey=c,xt(e,s)&&"Select"===t.elementType&&(e.mapping=qr({widgetPlugin:s,mdx:t,cube:u}))})),g=d?(0,w.produce)(r,(e=>{e.pages[n].content[i]=m})):void 0;return{widgetStateDerivedFromMdx:m,dashboardStateDerivedFromMdx:g}}function Lr({kpiName:e,propertyName:t}){return`${e} ${t.slice(3)}`}const Wr=({isQueryLazyLoaded:e,selectedWidgetState:t,widgetOption:r})=>{const{formatMessage:n}=(0,$.useIntl)(),a=void 0===t?"":t.name??n({id:`aui.plugins.widget.${Oe(t)&&!t.widgetKey.startsWith("drillthrough")?t.switchedTo??t.widgetKey:t.widgetKey}.defaultName`}),s=n({id:`aui.plugins.widget.${r.key}.key`}),l=void 0!==r.lazyLoading;return(0,o.Y)(i.Fragment,{children:n({id:"aui.dataVisualization.switchDisabled"},{maxNumberOfFields:r.maxNumberOfFields,nameOfSelectedWidget:a,nameOfTargetWidgetPlugin:s,reason:e&&!l?"lazyLoading":"tooManyFields",type:r.disabledType})})};function Br(e,t){return(0,S.mapValues)(t,((t,r)=>e[r]??[]))}function $r(e,t,r){const n=rt({widgetState:e,dashboardState:t,pageKey:r}),{query:a}=e,s=(0,i.useMemo)((()=>(0,R.D)({sectionName:"widget",queryContextBySection:n})),[n]);return(0,i.useMemo)((()=>({...a,context:s})),[a,s])}var Rr=r(46363);const Ar=({serverKey:e,queryId:t,onWidgetReset:r,isLoading:a,timeBeforeContinueLoadingButtonAppears:s})=>{const l=(0,B.DP)(),{formatMessage:d}=(0,$.useIntl)(),c=(0,Z.mF)(e),[p,h]=(0,i.useState)(void 0);return(0,i.useEffect)((()=>{if(a&&"loading"!==p){h(void 0);const e=setTimeout((()=>h("loading")),s??2e4);return()=>clearTimeout(e)}a||"loading"!==p||h(void 0)}),[a,p,s]),p&&(0,o.Y)("div",{css:n.css`
          background: transparent;
          position: absolute;
          width: 100%;
          z-index: 3;
          display: flex;
          justify-content: center;
        `,children:(0,o.Y)("div",{css:n.css`
            background: ${l.backgroundColor};
            width: calc(100% - 4px);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 8px;
            padding-bottom: 8px;
          `,children:"loading"===p?(0,o.FD)(o.FK,{children:[(0,o.Y)(u.Text,{style:{marginBottom:8},children:d({id:"aui.longLoading"})}),(0,o.FD)(g.Button.Group,{css:{gap:10},children:[(0,o.Y)(g.Button,{type:"primary",onClick:()=>h(void 0),children:d({id:"aui.continueLoading"})}),(0,o.Y)(g.Button,{type:"default",onClick:()=>{t&&c?.cancelQuery(t),h("canceled")},children:d({id:"aui.stopQuery"})})]})]}):(0,o.FD)(o.FK,{children:[(0,o.FD)(u.Text,{style:{marginBottom:8},children:[(0,o.Y)(Rr.A,{style:{width:"12px",height:"12px",color:"red",marginRight:"6px"}}),d({id:"aui.queryCanceled"})]}),(0,o.FD)(g.Button.Group,{css:{gap:10},children:[(0,o.Y)(g.Button,{type:"primary",onClick:()=>{if(t){const e=c?.getQuery(t);e&&c?.setQuery(t,e)}h(void 0)},children:d({id:"aui.runQueryagain"})}),(0,o.Y)(g.Button,{type:"default",onClick:()=>{r?.(),h(void 0)},children:d({id:"aui.reset"})})]})]})})})},Vr=(0,i.createContext)(Ar),jr=Vr.Provider,Hr=(0,i.forwardRef)(((e,t)=>{const r=(0,i.useContext)(Vr)??Ar;return(0,o.FD)("div",{ref:t,className:e.className,css:{height:"100%",position:"relative",padding:"0px 2px 3px"},children:[(0,o.Y)(r,{...e}),e.children]})}));function zr(e){const{error:t,onLoaded:r}=e,n=(0,Z.d5)();(0,i.useEffect)((()=>{r?.()}),[r]);const{formatMessage:a}=(0,$.useIntl)(),{widgetState:l}=e,{widgetKey:d}=l,[c]=(0,s.useWidgetPlugins)(d?[d]:[]);let p,h,m=t.message??t.stack,g="error";if(!c)return(0,o.Y)(u.ErrorPlaceholder,{Icon:p,title:h,message:m,type:g});if(!Oe(l))return(0,o.Y)(u.ErrorPlaceholder,{Icon:p,title:h,message:m,type:g});const{serverKey:y}=l;return(y?[n[y]]:Object.values(n)).some((e=>e.isDataModelLoading))&&t instanceof N.d?(p=c.Icon,g="info",m=a({id:"aui.dataVisualization.loadingWidget"})):t instanceof Ee.N&&(p=V.IconCubeError,m=a({id:"aui.error.cubeNotFoundMessage"},{cubeName:t.cubeName}),h=a({id:"aui.error.cubeNotFound"})),(0,o.Y)(u.ErrorPlaceholder,{Icon:p,title:h,message:m,type:g})}function Ur(e){if(!(e.error instanceof dt.QueryError))throw e.error;return(0,o.Y)(zr,{...e})}function Qr(e){const t=t=>(0,o.Y)(C.ErrorBoundary,{fallbackRender:e=>(0,o.Y)(Ur,{...e,...t}),resetKeys:[t.queryResult],children:(0,o.Y)(e,{...t})});return t.displayName=`withWidgetQueryErrorBoundary(${e.displayName})`,t}function Gr(e,t){const r=e.findIndex((({key:e})=>e===t.key));-1===r?e.push(t):e[r]=t}function _r(e,{levelsWithHiddenTotals:t}){Gr(e,{value:(0,S.uniqWith)(t,kr.M).map(De.getLevelUniqueName).join(","),key:"mdx.hiddensubtotals"})}function Jr(e){const t=e?.find((({key:e})=>"mdx.hiddensubtotals"===e))?.value;return(t?t.split(","):[]).map((e=>{const[t,r,n]=(0,De.unquote)(e);return{dimensionName:t,hierarchyName:r,levelName:n}}))}function Xr(e,{cube:t,queryContext:r}){const n={},i=function(e){const t=e?.find((({key:e})=>"mdx.hiddengrandtotals"===e))?.value;return t?t.split(","):[]}(r),a=Jr(r);return e?.axes.forEach((e=>{const r=(0,De.getAxisTotalsMetaData)(e,t),s=r.isGrandTotalHidden||i.includes(String((0,De.getAxisId)(e.name))),o=(0,S.intersectionWith)(r.levelsWithToggleableTotals,[...r.levelsWithHiddenTotals,...a],kr.M);n[e.name]={...r,isGrandTotalHidden:s,levelsWithHiddenTotals:o}})),n}function Zr(e,{mdx:t,cube:r}){if(!e)return;const n=Jr(e),i=Xr(t,{cube:r,queryContext:e}),a=Object.values(i).flatMap((e=>e.levelsWithToggleableTotals));_r(e,{levelsWithHiddenTotals:(0,S.intersectionWith)(n,a,kr.M)})}const en="\nposition: absolute;\nborder-radius: 2px;\nheight: 3px;\nz-index: 2;\n",tn=()=>{const e=(0,B.DP)();return(0,o.Y)("div",{css:n.css`
        ${en}
        width: calc(100% - 4px);
        background-color: ${e.isDark?e.grayScale[5]:"#f5f9ff"};
      `,children:(0,o.Y)("div",{css:n.css`
          ${en}
          background-color: ${(0,Te.j)(e.primaryColor,.5)};
          animation: loadingBar 0.9s linear infinite;
          @keyframes loadingBar {
            0% {
              left: 0%;
              right: 100%;
              width: 0%;
            }
            50% {
              left: 0%;
              right: 0%;
              width: 100%;
            }

            100% {
              left: 100%;
              right: 0%;
              width: 0%;
            }
          }
        `})})},rn=700;function nn(e){const t=(0,i.forwardRef)(((t,r)=>{const[n,a]=(0,i.useState)(!1),{queryId:s,widgetState:l}=t,d=Oe(l)?l.serverKey:void 0,c=(0,ct.J)({queryId:s,serverKey:d});return(0,i.useEffect)((()=>{if(c.isLoading){const e=setTimeout((()=>{a(!0)}),rn);return()=>{clearTimeout(e)}}a(!1)}),[c.isLoading]),(0,o.FD)(o.FK,{children:[n&&(0,o.Y)(tn,{}),(0,o.Y)(e,{ref:r,...t})]})}));return t.displayName=`withWidgetLoadingBar(${e.displayName})`,t}function an(e){const t=t=>{const r=(0,i.useRef)((0,o.Y)("div",{}));return t.queryResult.isLoading||(r.current=(0,o.Y)(e,{...t})),r.current},r=e.displayName||e.name||"Unknown";return t.displayName=`withoutIrrelevantRenders(${r})`,t}function sn(e){const t=t=>{const[r]=(0,s.useWidgetPlugins)([t.widgetState.widgetKey]);return(0,o.Y)(Hr,{isLoading:t.queryResult.isLoading,style:{...t.style,height:"100%"},serverKey:t.widgetState.serverKey,queryId:t.queryId,onWidgetReset:()=>{r&&t.onChange(r.initialState)},children:(0,o.Y)(e,{...t})})},r=e.displayName||e.name||"Unknown";return t.displayName=`withLoadingOverlay(${r})`,t}const on=({activeRowIndex:e,key:t,optionsLength:r})=>"ArrowDown"===t&&e<r?e+1:"ArrowUp"===t&&e>0?e-1:e,ln=(0,De.getAxisId)("ROWS"),dn=(0,De.getAxisId)("COLUMNS"),cn=({widgetState:e,onStateChange:t})=>{const{formatMessage:r}=(0,$.useIntl)(),{backgroundColor:n}=(0,B.DP)(),i=e.query.mdx;if(void 0===i)return;const{[dn]:a,[ln]:s}=(0,De.getNonEmpty)(i),l=r=>{const n=(0,w.produce)(e,(e=>{e.query.mdx=(0,De.setNonEmpty)(i,r)}));t(n)};return(0,o.Y)("div",{style:{position:"absolute",zIndex:1,inset:0,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,o.FD)("div",{style:{backgroundColor:n,textAlign:"center",display:"flex",flexDirection:"column",padding:12,gap:12},children:[r({id:"aui.dataVisualization.noData"}),(0,o.FD)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",gap:4},children:[void 0!==s&&(0,o.Y)(g.Checkbox,{checked:!s,onChange:e=>l({[ln]:!e.target.checked}),children:r({id:"aui.showEmptyRows"})}),void 0!==a&&(0,o.Y)(g.Checkbox,{checked:!a,onChange:e=>{l({[dn]:!e.target.checked})},children:r({id:"aui.showEmptyColumns"})})]})]})})},un=({children:e,widgetKey:t,keys:r,actionProps:n})=>{const[a,s]=(0,i.useState)(!1);return(0,o.Y)(b,{keys:r,actionProps:n,onClick:e=>{e.domEvent.isDefaultPrevented()||s(!1)},children:(0,o.Y)(u.Dropdown,{open:a,onOpenChange:s,dropdownRender:()=>(0,o.Y)(v,{}),trigger:["click"],placement:"bottomRight",children:e},t)})};var pn=r(89658);function hn({selection:e,cube:t,isExclusionFilter:r}){return function(e,t){const r=(0,S.flatten)(e),n=(0,S.uniqWith)(r,((e,t)=>(0,O.q)(e,t)&&(0,S.isEqual)(e.namePath,t.namePath))),i=(0,S.groupBy)(n,(e=>(0,De.quote)(e.dimensionName,e.hierarchyName))),a=[];return Object.keys(i).forEach((e=>{if("[Measures].[Measures]"!==e){const r=i[e];a.push({dimensionName:r[0].dimensionName,hierarchyName:r[0].hierarchyName,type:"members",members:(0,S.map)(r,"namePath"),isExclusionFilter:t})}})),a}((0,pn.q)(e,t),r)}function mn({existingFilters:e,addedFilters:t}){t.forEach((t=>{const r=e.findIndex((e=>"members"===e.type&&(0,O.q)(t,e)));-1!==r?e[r]=t:e.push(t)}))}function gn(e,t){e.filters||(e.filters=[]),mn({existingFilters:e.filters,addedFilters:t}),je(e)}function yn({addedFilters:e,widgetState:t}){return(0,w.produce)(t,(t=>{gn(t,e)}))}},92673:(e,t,r)=>{r.d(t,{A:()=>n});const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"}},20952:(e,t,r)=>{r.d(t,{A:()=>n});const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"}},74389:(e,t,r)=>{r.d(t,{FD:()=>o,FK:()=>a,Y:()=>s});var n=r(65723),i=r(42369),a=(r(93345),r(77619),r(4674),r(21880),r(48785),n.Fragment);function s(e,t,r){return i.h.call(t,"css")?n.jsx(i.E,(0,i.c)(e,t),r):n.jsx(e,t,r)}function o(e,t,r){return i.h.call(t,"css")?n.jsxs(i.E,(0,i.c)(e,t),r):n.jsxs(e,t,r)}},17628:e=>{e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,a;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,a[i]))return!1;for(i=n;0!=i--;){var s=a[i];if(!("_owner"===s&&t.$$typeof||e(t[s],r[s])))return!1}return!0}return t!=t&&r!=r}},22431:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(93345),i=(r(17628),function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.addEventListener.apply(e,t)}),a=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.removeEventListener.apply(e,t)},s=["mousedown","touchstart"];const o=function(e,t,r){void 0===r&&(r=s);var o=(0,n.useRef)(t);(0,n.useEffect)((function(){o.current=t}),[t]),(0,n.useEffect)((function(){for(var t=function(t){var r=e.current;r&&!r.contains(t.target)&&o.current(t)},n=0,s=r;n<s.length;n++){var l=s[n];i(document,l,t)}return function(){for(var e=0,n=r;e<n.length;e++){var i=n[e];a(document,i,t)}}}),[r,e])}},62921:(e,t,r)=>{var n=r(93345),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,r){var n,a={},d=null,c=null;for(n in void 0!==r&&(d=""+r),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)s.call(t,n)&&!l.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:i,type:e,key:d,ref:c,props:a,_owner:o.current}}t.Fragment=a,t.jsx=d,t.jsxs=d},65723:(e,t,r)=>{e.exports=r(62921)}}]);