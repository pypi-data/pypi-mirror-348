---
description: Details the structure and functions in the main module
globs: 
alwaysApply: false
---
---
rule-type: file-hint
display-name: Main Module Structure
priority: 900
enable-rule: true
description: Details the structure and functions in the main module
file-pattern: src/tapo_chatter/main.py
---

# Main Module Structure

The [main.py](mdc:src/tapo_chatter/main.py) module is responsible for connecting to a Tapo H100 Hub and retrieving/displaying information about connected devices.

## Key Functions

### Network & Hub Communication
- **`check_host_connectivity`**: Verifies if the hub is reachable on the network
- **`get_child_devices`**: Retrieves device information from the H100 hub
  - Connects to the hub
  - Retrieves raw device data
  - Processes and normalizes the data into a consistent format

### Data Display
- **`print_additional_device_info_table`**: Displays extended device information
  - Hardware version
  - MAC address
  - Region
  - Signal levels
  - Battery status
  - Jamming RSSI (color-coded)
  - Report interval
  - Last onboarded timestamp
  
- **`print_device_table`**: Displays main device information
  - Device name, ID, and type
  - Online/offline status
  - RSSI (color-coded)
  - Sensor-specific details (motion, contact state, temperature, etc.)

### Main Flow
- **`main`**: Entry point that orchestrates the entire process
  - Loads configuration
  - Initializes API client
  - Retrieves device data
  - Displays information in tables

## Color-Coding Logic
- Signal strength (RSSI):
  - Good (> -65): Green
  - Fair (-75 to -65): Yellow
  - Poor (< -75): Red
  
- Critical sensor states:
  - "Motion: Detected": Bold Red
  - "Contact: Open": Bold Red
