"use strict";(self.webpackChunk_jupyterlite_xeus_extension=self.webpackChunk_jupyterlite_xeus_extension||[]).push([[961],{961:(e,n,t)=>{t.r(n),t.d(n,{IEmpackEnvMetaFile:()=>c,default:()=>g});var s=t(240),r=t(367),a=t(425),o=t(363),i=t(225);const c=new(t(262).Token)("@jupyterlite/xeus:IEmpackEnvMetaFile");async function l(e){const n=r.URLExt.join(r.PageConfig.getBaseUrl(),e),t=await fetch(n,{method:"GET"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}const u={id:"@jupyterlite/xeus-kernel:register",autoStart:!0,requires:[o.IKernelSpecs],optional:[a.IServiceWorkerManager,c,s.ILoggerRegistry],activate:async(e,n,t,s,a)=>{let o=[];try{o=await l("xeus/kernels.json")}catch(e){throw console.log(`Could not fetch xeus/kernels.json: ${e}`),e}const c=e.serviceManager.contents,u=o.map((e=>e.kernel)),g=u.filter(((e,n)=>u.indexOf(e)!==n));for(const e of o){const{env_name:a,kernel:o}=e,u=await l(`xeus/${a}/${o}/kernel.json`);u.name=o,u.dir=o,u.envName=a,g.includes(o)&&(u.name=`${o} (${a})`,u.display_name=`${u.display_name} [${a}]`);for(const[e,n]of Object.entries(u.resources))u.resources[e]=r.URLExt.join(r.PageConfig.getBaseUrl(),n);n.register({spec:u,create:async e=>{const n=u.name.indexOf(" ");n>0&&(u.name=u.name.slice(0,n));const r=!(!(null==t?void 0:t.enabled)&&!crossOriginIsolated);r?console.info(`${u.name} contents will be synced with Jupyter Contents`):console.warn(`${u.name} contents will NOT be synced with Jupyter Contents`);const a=s?await s.getLink(u):"";return new i.WebWorkerKernel({...e,contentsManager:c,mountDrive:r,kernelSpec:u,empackEnvMetaLink:a,browsingContextId:(null==t?void 0:t.browsingContextId)||""})}})}await e.serviceManager.kernelspecs.refreshSpecs(),a&&(new BroadcastChannel("/xeus-kernel-logs-broadcast").onmessage=n=>{var t;const{kernelId:s,payload:r}=n.data,{sessions:o}=e.serviceManager;let i="";for(const e of o.running())if((null===(t=e.kernel)||void 0===t?void 0:t.id)===s){i=e.path;break}a.getLogger(i).log(r)})}},g=[{id:"@jupyterlite/xeus:empack-env-meta",autoStart:!0,provides:c,activate:()=>({getLink:async e=>{const{envName:n}=e;return`${r.URLExt.join(r.PageConfig.getBaseUrl(),`xeus/${n}`)}`}})},u]}}]);