
import numpy as np
from numpy import nan

add_legend_handle = [
    'ATLAS Data',
    'Theory [TYPE=BSM]',
    'SM as BG [TYPE=BSM]'
]

xpoints = {
    'ATLAS Data' : [-0.95, -0.8500000000000001, -0.75, -0.6499999999999999, -0.55, -0.45, -0.35, -0.25, -0.15000000000000002, -0.05, 0.05, 0.15000000000000002, 0.25, 0.35, 0.45, 0.55, 0.6499999999999999, 0.75, 0.8500000000000001, 0.95],
    'Theory [TYPE=BSM]' : [-0.95, -0.85, -0.75, -0.65, -0.55, -0.45, -0.35, -0.25, -0.15, -0.05, 0.05, 0.15, 0.25, 0.35, 0.45, 0.55, 0.65, 0.75, 0.85, 0.95],
    'SM as BG [TYPE=BSM]' : [-0.95, -0.8500000000000001, -0.75, -0.6499999999999999, -0.55, -0.45, -0.35, -0.25, -0.15000000000000002, -0.05, 0.05, 0.15000000000000002, 0.25, 0.35, 0.45, 0.55, 0.6499999999999999, 0.75, 0.8500000000000001, 0.95],
}
xedges = {
    'ATLAS Data' : [-1.0, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, 0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0],
    'Theory [TYPE=BSM]' : [-1.0, -0.9, -0.8, -0.7000000000000001, -0.6000000000000001, -0.5, -0.39999999999999997, -0.3, -0.2, -0.1, 0.0, 0.09999999999999999, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.7999999999999999, 0.8999999999999999, 1.0],
    'SM as BG [TYPE=BSM]' : [-1.0, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, 0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0],
}
ref_xerrs = [
  [abs(xpoints['ATLAS Data'][i]   - xedges['ATLAS Data'][i]) for i in range(len(xpoints['ATLAS Data']))],
  [abs(xedges['ATLAS Data'][i+1] - xpoints['ATLAS Data'][i]) for i in range(len(xpoints['ATLAS Data']))]
]

yvals = {
    'ATLAS Data' : [0.98965, 1.0172, 0.99312, 1.0515, 1.0872, 1.1101, 1.1145, 1.1473, 1.1504, 1.1538, 1.1612, 1.1589, 1.1168, 1.1186, 1.0933, 1.084, 1.057, 0.98823, 1.0103, 1.0458],
    'Theory [TYPE=BSM]' : [0.95832, 0.99817, 0.97336, 1.0072, 1.0217, 1.0308, 1.0257, 1.022, 1.0181, 1.0038, 1.0071, 1.0119, 1.0212, 1.0234, 1.026, 1.0263, 1.0071, 0.97268, 0.99423, 0.9581],
    'SM as BG [TYPE=BSM]' : [0.9588247, 0.999431, 0.9745518, 1.008474, 1.022779, 1.03185, 1.026679, 1.022966, 1.019048, 1.004633, 1.007974, 1.012698, 1.022117, 1.024368, 1.027084, 1.027508, 1.008518, 0.9737873, 0.9955309, 0.9590366],
}
xerrs = {
    'ATLAS Data' : [
        [0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.04999999999999999, 0.04999999999999999, 0.04999999999999999, 0.05000000000000002, 0.05, 0.05, 0.04999999999999999, 0.04999999999999999, 0.050000000000000044, 0.04999999999999999, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044],
        [0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.04999999999999999, 0.050000000000000044, 0.04999999999999999, 0.04999999999999999, 0.05, 0.05, 0.05000000000000002, 0.04999999999999999, 0.04999999999999999, 0.04999999999999999, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993],
    ],
    'Theory [TYPE=BSM]' : [
        [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05],
        [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05],
    ],
    'SM as BG [TYPE=BSM]' : [
        [0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.04999999999999999, 0.04999999999999999, 0.04999999999999999, 0.05000000000000002, 0.05, 0.05, 0.04999999999999999, 0.04999999999999999, 0.050000000000000044, 0.04999999999999999, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044],
        [0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.04999999999999999, 0.050000000000000044, 0.04999999999999999, 0.04999999999999999, 0.05, 0.05, 0.05000000000000002, 0.04999999999999999, 0.04999999999999999, 0.04999999999999999, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993],
    ],
}
yerrs = {
    'ATLAS Data' : [
        [0.10378138743091653, 0.07317077553166777, 0.04146857925090393, 0.02607713302708716, 0.027994412228330497, 0.02604730424152037, 0.03295104531161631, 0.03603012718331557, 0.04004415228108547, 0.0394984614983766, 0.04314937106988971, 0.04097602103796224, 0.04117783563406696, 0.0326335076258172, 0.027163394331065065, 0.02702316491950827, 0.025119734194237915, 0.048280692874915335, 0.05657552215521344, 0.050683123061201533],
        [0.10378138743091653, 0.07317077553166777, 0.04146857925090393, 0.02607713302708716, 0.027994412228330497, 0.02604730424152037, 0.03295104531161631, 0.03603012718331557, 0.04004415228108547, 0.0394984614983766, 0.04314937106988971, 0.04097602103796224, 0.04117783563406696, 0.0326335076258172, 0.027163394331065065, 0.02702316491950827, 0.025119734194237915, 0.048280692874915335, 0.05657552215521344, 0.050683123061201533],
    ],
    'Theory [TYPE=BSM]' : [
        [0.06666424, 0.03571399, 0.03558183, 0.03087196, 0.02818046, 0.02850815, 0.02851154, 0.02788978, 0.02892007, 0.02831845, 0.02926581, 0.02750987, 0.02887535, 0.02894067, 0.02807378, 0.02775975, 0.0321459, 0.03643274, 0.03888829, 0.06311203],
        [0.06666424, 0.03571399, 0.03558183, 0.03087196, 0.02818046, 0.02850815, 0.02851154, 0.02788978, 0.02892007, 0.02831845, 0.02926581, 0.02750987, 0.02887535, 0.02894067, 0.02807378, 0.02775975, 0.0321459, 0.03643274, 0.03888829, 0.06311203],
    ],
    'SM as BG [TYPE=BSM]' : [
        [0.06667059939239235, 0.0357177857463863, 0.03558380755935998, 0.03087318681668655, 0.028181093723052084, 0.028508816523533487, 0.028512136886532733, 0.02789063895376773, 0.028920884344158456, 0.02831938747439613, 0.02926671751632026, 0.027510818991975182, 0.028876130730561722, 0.028941290670036795, 0.02807435102003125, 0.02776030708235709, 0.03214690198087935, 0.036434740121374494, 0.03889165345372891, 0.06311878700639695],
        [0.06667059939239235, 0.0357177857463863, 0.03558380755935998, 0.03087318681668655, 0.028181093723052084, 0.028508816523533487, 0.028512136886532733, 0.02789063895376773, 0.028920884344158456, 0.02831938747439613, 0.02926671751632026, 0.027510818991975182, 0.028876130730561722, 0.028941290670036795, 0.02807435102003125, 0.02776030708235709, 0.03214690198087935, 0.036434740121374494, 0.03889165345372891, 0.06311878700639695],
    ],
}
variation_yvals = {
}


# lists for ratio plot
ratio0_yvals = {
    'ATLAS Data' : [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    'Theory [TYPE=BSM]' : [-0.3018845746387358, -0.260076510898317, -0.4765053531359957, -1.698806381590498, -2.3397526429832856, -3.0444609263477256, -2.694906919043783, -3.4776452317943103, -3.3038531836392733, -3.7976162693365905, -3.571315089399605, -3.5874639917773337, -2.3216373208529877, -2.9172469319444163, -2.477599050389411, -2.1352051164941797, -1.9864859880343055, -0.32207491388507403, -0.2840451026843802, -1.7303590367566632],
    'SM as BG [TYPE=BSM]' : [-0.29702146755861525, -0.2428428545534529, -0.44776552115889734, -1.649951317704577, -2.3012092368492536, -3.0041496530480396, -2.665196177222348, -3.450834335593884, -3.280179315021814, -3.7765268403208725, -3.5510598694895816, -3.5679891872505407, -2.2993680591038057, -2.8875841690229693, -2.437692402980461, -2.0905027286133273, -1.9300363461298466, -0.29914028030662054, -0.26105105949320884, -1.7118795125397146],
}
ratio0_yerrs = {
    'ATLAS Data' : [
        [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
        [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
    ],
    'Theory [TYPE=BSM]' : [
        [0.6423525609963149, 0.48809090433301816, 0.8580431411627008, 1.1838709404109837, 1.0066458895493875, 1.094476024684234, 0.8652696668760539, 0.7740683194955494, 0.7222045755145168, 0.7169507096159655, 0.6782441846625692, 0.6713650887311259, 0.7012352532708408, 0.8868390836755868, 1.0335151659560375, 1.027257543025983, 1.2797070124800038, 0.7546026751187938, 0.6873695287037919, 1.2452277244989451],
        [0.6423525609963149, 0.48809090433301816, 0.8580431411627008, 1.1838709404109837, 1.0066458895493875, 1.094476024684234, 0.8652696668760539, 0.7740683194955494, 0.7222045755145168, 0.7169507096159655, 0.6782441846625692, 0.6713650887311259, 0.7012352532708408, 0.8868390836755868, 1.0335151659560375, 1.027257543025983, 1.2797070124800038, 0.7546026751187938, 0.6873695287037919, 1.2452277244989451],
    ],
    'SM as BG [TYPE=BSM]' : [
        [0.642413837806635, 0.4881427795025612, 0.858090829301424, 1.183917986099836, 1.0066685270331437, 1.0945016136483474, 0.8652877812189249, 0.7740921593716442, 0.7222249116712854, 0.7169744440694245, 0.6782652166335518, 0.6713882484218705, 0.7012542132416528, 0.8868581030848366, 1.0335361876304383, 1.0272781580190362, 1.2797469006759379, 0.7546441020589514, 0.6874289793920185, 1.2453610431657682],
        [0.642413837806635, 0.4881427795025612, 0.858090829301424, 1.183917986099836, 1.0066685270331437, 1.0945016136483474, 0.8652877812189249, 0.7740921593716442, 0.7222249116712854, 0.7169744440694245, 0.6782652166335518, 0.6713882484218705, 0.7012542132416528, 0.8868581030848366, 1.0335361876304383, 1.0272781580190362, 1.2797469006759379, 0.7546441020589514, 0.6874289793920185, 1.2453610431657682],
    ],
}
ratio0_variation_vals = {
}
ratio_band_edges = {
    'ratio0_ATLAS Data_1sigma-band_dn' : [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0],
    'ratio0_ATLAS Data_1sigma-band_up' : [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
    'ratio0_Theory [TYPE=BSM]_1sigma-band_dn' : [-0.9442371356350507, -0.9442371356350507, -0.7481674152313352, -1.3345484942986965, -2.8826773220014816, -3.3463985325326733, -4.138936951031959, -3.560176585919837, -4.25171355128986, -4.02605775915379, -4.514566978952556, -4.249559274062174, -4.25882908050846, -3.0228725741238285, -3.8040860156200034, -3.5111142163454483, -3.1624626595201626, -3.2661930005143094, -1.0766775890038678, -0.9714146313881721, -2.975586761255608],
    'ratio0_Theory [TYPE=BSM]_1sigma-band_up' : [0.3404679863575791, 0.3404679863575791, 0.22801439343470115, 0.38153778802670507, -0.5149354411795141, -1.333106753433898, -1.9499849016634918, -1.8296372521677289, -2.703576912298761, -2.5816486081247567, -3.080665559720625, -2.8930709047370358, -2.916098903046208, -1.6204020675821469, -2.0304078482688297, -1.4440838844333734, -1.1079475734681967, -0.7067789755543017, 0.4325277612337198, 0.40332442601941165, -0.48513131225771805],
    'ratio0_SM as BG [TYPE=BSM]_1sigma-band_dn' : [-0.9394353053652502, -0.9394353053652502, -0.7309856340560141, -1.3058563504603213, -2.833869303804413, -3.3078777638823973, -4.098651266696387, -3.530483958441273, -4.224926494965528, -4.002404226693099, -4.493501284390297, -4.229325086123134, -4.239377435672411, -3.0006222723454585, -3.7744422721078057, -3.4712285906108997, -3.1177808866323637, -3.209783246805785, -1.053784382365572, -0.9484800388852274, -2.9572405557054826],
    'ratio0_SM as BG [TYPE=BSM]_1sigma-band_up' : [0.34539237024801966, 0.34539237024801966, 0.24529992494910832, 0.41032530814252666, -0.4660333316047412, -1.2945407098161104, -1.9096480393996924, -1.799908396003423, -2.6767421762222403, -2.5579544033505286, -3.059552396251448, -2.8727946528560295, -2.89660093882867, -1.5981138458621529, -2.0007260659381325, -1.4041562153500224, -1.0632245705942913, -0.6502894454539089, 0.45550382175233084, 0.42637791989880963, -0.46651846937394625],
}