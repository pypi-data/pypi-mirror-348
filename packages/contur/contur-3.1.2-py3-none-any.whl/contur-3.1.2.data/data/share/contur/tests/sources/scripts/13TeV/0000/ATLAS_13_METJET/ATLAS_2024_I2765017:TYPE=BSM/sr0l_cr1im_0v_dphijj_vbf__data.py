
import numpy as np
from numpy import nan

add_legend_handle = [
    'ATLAS Data',
    'Theory [TYPE=BSM]',
    'SM as BG [TYPE=BSM]'
]

xpoints = {
    'ATLAS Data' : [-0.95, -0.8500000000000001, -0.75, -0.6499999999999999, -0.55, -0.45, -0.35, -0.25, -0.15000000000000002, -0.05, 0.05, 0.15000000000000002, 0.25, 0.35, 0.45, 0.55, 0.6499999999999999, 0.75, 0.8500000000000001, 0.95],
    'Theory [TYPE=BSM]' : [-0.95, -0.85, -0.75, -0.65, -0.55, -0.45, -0.35, -0.25, -0.15, -0.05, 0.05, 0.15, 0.25, 0.35, 0.45, 0.55, 0.65, 0.75, 0.85, 0.95],
    'SM as BG [TYPE=BSM]' : [-0.95, -0.8500000000000001, -0.75, -0.6499999999999999, -0.55, -0.45, -0.35, -0.25, -0.15000000000000002, -0.05, 0.05, 0.15000000000000002, 0.25, 0.35, 0.45, 0.55, 0.6499999999999999, 0.75, 0.8500000000000001, 0.95],
}
xedges = {
    'ATLAS Data' : [-1.0, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, 0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0],
    'Theory [TYPE=BSM]' : [-1.0, -0.9, -0.8, -0.7000000000000001, -0.6000000000000001, -0.5, -0.39999999999999997, -0.3, -0.2, -0.1, 0.0, 0.09999999999999999, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.7999999999999999, 0.8999999999999999, 1.0],
    'SM as BG [TYPE=BSM]' : [-1.0, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, 0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0],
}
ref_xerrs = [
  [abs(xpoints['ATLAS Data'][i]   - xedges['ATLAS Data'][i]) for i in range(len(xpoints['ATLAS Data']))],
  [abs(xedges['ATLAS Data'][i+1] - xpoints['ATLAS Data'][i]) for i in range(len(xpoints['ATLAS Data']))]
]

yvals = {
    'ATLAS Data' : [563.97, 1866.7, 2155.1, 2235.6, 2319.0, 2333.6, 2180.0, 1928.5, 1789.1, 1745.9, 1712.3, 1801.3, 1957.3, 2190.2, 2375.5, 2350.5, 2279.7, 2178.2, 1918.9, 559.44],
    'Theory [TYPE=BSM]' : [557.3, 2234.9, 2428.5, 2529.5, 2641.9, 2656.8, 2513.0, 2257.8, 2068.4, 1975.3, 1985.4, 2092.2, 2272.6, 2492.8, 2648.0, 2607.6, 2511.3, 2444.1, 2241.6, 549.23],
    'SM as BG [TYPE=BSM]' : [557.3, 2235.1522382000003, 2428.57567147, 2529.6008953, 2641.95044765, 2656.85044765, 2513.1261191, 2257.85044765, 2068.45044765, 1975.3, 1985.4504476500001, 2092.25044765, 2272.65044765, 2492.8252238200002, 2648.07567147, 2607.67567147, 2511.35044765, 2444.15044765, 2241.7008953, 549.23],
}
xerrs = {
    'ATLAS Data' : [
        [0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.04999999999999999, 0.04999999999999999, 0.04999999999999999, 0.05000000000000002, 0.05, 0.05, 0.04999999999999999, 0.04999999999999999, 0.050000000000000044, 0.04999999999999999, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044],
        [0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.04999999999999999, 0.050000000000000044, 0.04999999999999999, 0.04999999999999999, 0.05, 0.05, 0.05000000000000002, 0.04999999999999999, 0.04999999999999999, 0.04999999999999999, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993],
    ],
    'Theory [TYPE=BSM]' : [
        [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05],
        [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05],
    ],
    'SM as BG [TYPE=BSM]' : [
        [0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.04999999999999999, 0.04999999999999999, 0.04999999999999999, 0.05000000000000002, 0.05, 0.05, 0.04999999999999999, 0.04999999999999999, 0.050000000000000044, 0.04999999999999999, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044],
        [0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993, 0.04999999999999999, 0.050000000000000044, 0.04999999999999999, 0.04999999999999999, 0.05, 0.05, 0.05000000000000002, 0.04999999999999999, 0.04999999999999999, 0.04999999999999999, 0.050000000000000044, 0.04999999999999993, 0.050000000000000044, 0.050000000000000044, 0.04999999999999993],
    ],
}
yerrs = {
    'ATLAS Data' : [
        [22.45847270746414, 51.496163577761514, 71.33683885340167, 96.26751821131663, 110.94151775158696, 127.83557534487763, 123.11229422953204, 117.83814333263017, 109.31983539344046, 109.96609791444834, 124.13717650914062, 112.22448635842484, 109.54534543933576, 118.38882803341802, 117.68506801040235, 116.2050655115884, 94.66369326958613, 74.50371393116708, 52.73586773708372, 23.931146269126533],
        [22.45847270746414, 51.496163577761514, 71.33683885340167, 96.26751821131663, 110.94151775158696, 127.83557534487763, 123.11229422953204, 117.83814333263017, 109.31983539344046, 109.96609791444834, 124.13717650914062, 112.22448635842484, 109.54534543933576, 118.38882803341802, 117.68506801040235, 116.2050655115884, 94.66369326958613, 74.50371393116708, 52.73586773708372, 23.931146269126533],
    ],
    'Theory [TYPE=BSM]' : [
        [87.57008, 354.5174, 396.2046, 424.1818, 452.8949, 451.0577, 425.4366, 380.9551, 349.1441, 330.8925, 332.739, 353.8408, 385.5278, 419.188, 446.3449, 439.459, 419.2145, 398.2346, 356.4295, 85.91773],
        [87.57008, 354.5174, 396.2046, 424.1818, 452.8949, 451.0577, 425.4366, 380.9551, 349.1441, 330.8925, 332.739, 353.8408, 385.5278, 419.188, 446.3449, 439.459, 419.2145, 398.2346, 356.4295, 85.91773],
    ],
    'SM as BG [TYPE=BSM]' : [
        [87.57008, 354.51740897334247, 396.2046024087599, 424.18180299985215, 452.8949014048318, 451.0577014105538, 425.4366037387544, 380.9551016701211, 349.1441018222881, 330.8925, 332.7390019121328, 353.8408017981, 385.527801650312, 419.1880007588971, 446.34490213817105, 439.4590021716741, 419.2145015176983, 398.23460159765415, 356.42950357008243, 85.91773],
        [87.57008, 354.51740897334247, 396.2046024087599, 424.18180299985215, 452.8949014048318, 451.0577014105538, 425.4366037387544, 380.9551016701211, 349.1441018222881, 330.8925, 332.7390019121328, 353.8408017981, 385.527801650312, 419.1880007588971, 446.34490213817105, 439.4590021716741, 419.2145015176983, 398.23460159765415, 356.42950357008243, 85.91773],
    ],
}
variation_yvals = {
}


# lists for ratio plot
ratio0_yvals = {
    'ATLAS Data' : [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    'Theory [TYPE=BSM]' : [-0.29699259103150316, 7.150047196117853, 3.832521939496666, 3.0529508338924956, 2.9105424780920774, 2.5282477051326615, 2.7048476521699025, 2.794511103849129, 2.5548885890177537, 2.086097482321042, 2.199985594000448, 2.5921259204601528, 2.878260128127556, 2.555984420376088, 2.315501912068516, 2.2124680956731697, 2.446555717411562, 3.568949599555014, 6.119174934388688, -0.42664065837798637],
    'SM as BG [TYPE=BSM]' : [-0.29699259103150316, 7.154945390128351, 3.8335827023678046, 3.053998905992771, 2.910997201003954, 2.5286423343261695, 2.7058720754477656, 2.7949392135305384, 2.555350057422078, 2.086097482321042, 2.200391980317735, 2.5925754449056373, 2.878720646553033, 2.5561974795001547, 2.316144911824385, 2.213119284755736, 2.447088631861206, 3.569626715464251, 6.121088154068756, -0.42664065837798637],
}
ratio0_yerrs = {
    'ATLAS Data' : [
        [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
        [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
    ],
    'Theory [TYPE=BSM]' : [
        [3.899200143333693, 6.884345849660487, 5.5539971544604985, 4.406281660537664, 4.082285055934541, 3.5284207763224487, 3.455679245216655, 3.2328674674095192, 3.193785452964099, 3.0090410251478454, 2.680413791878852, 3.152973218963071, 3.5193444180930387, 3.5407732888585937, 3.792706309695525, 3.7817542468161642, 4.428461277188375, 5.345164408420273, 6.758768088864872, 3.59020537644877],
        [3.899200143333693, 6.884345849660487, 5.5539971544604985, 4.406281660537664, 4.082285055934541, 3.5284207763224487, 3.455679245216655, 3.2328674674095192, 3.193785452964099, 3.0090410251478454, 2.680413791878852, 3.152973218963071, 3.5193444180930387, 3.5407732888585937, 3.792706309695525, 3.7817542468161642, 4.428461277188375, 5.345164408420273, 6.758768088864872, 3.59020537644877],
    ],
    'SM as BG [TYPE=BSM]' : [
        [3.899200143333693, 6.884346023913127, 5.553997188226501, 4.406281691699287, 4.082285068597354, 3.5284207873565747, 3.4556792755853065, 3.2328674815825287, 3.1937854696334265, 3.0090410251478454, 2.6804138072822377, 3.152973234985421, 3.5193444331581425, 3.5407732952688025, 3.7927063278641096, 3.7817542655044556, 4.428461293220903, 5.3451644298642265, 6.758768156562296, 3.59020537644877],
        [3.899200143333693, 6.884346023913127, 5.553997188226501, 4.406281691699287, 4.082285068597354, 3.5284207873565747, 3.4556792755853065, 3.2328674815825287, 3.1937854696334265, 3.0090410251478454, 2.6804138072822377, 3.152973234985421, 3.5193444331581425, 3.5407732952688025, 3.7927063278641096, 3.7817542655044556, 4.428461293220903, 5.3451644298642265, 6.758768156562296, 3.59020537644877],
    ],
}
ratio0_variation_vals = {
}
ratio_band_edges = {
    'ratio0_ATLAS Data_1sigma-band_dn' : [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0],
    'ratio0_ATLAS Data_1sigma-band_up' : [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
    'ratio0_Theory [TYPE=BSM]_1sigma-band_dn' : [-4.196192734365196, -4.196192734365196, 0.2657013464573666, -1.7214752149638326, -1.3533308266451682, -1.1717425778424635, -1.0001730711897876, -0.7508315930467521, -0.4383563635603905, -0.6388968639463454, -0.9229435428268035, -0.4804281978784045, -0.5608472985029179, -0.6410842899654824, -0.9847888684825052, -1.477204397627009, -1.5692861511429945, -1.981905559776813, -1.7762148088652594, -0.639593154476184, -4.016846034826757],
    'ratio0_Theory [TYPE=BSM]_1sigma-band_up' : [3.6022075523021897, 3.6022075523021897, 14.034393045778339, 9.386519093957164, 7.45923249443016, 6.992827534026618, 6.056668481455111, 6.160526897386557, 6.027378571258648, 5.748674041981853, 5.095138507468887, 4.880399385879301, 5.745099139423223, 6.397604546220595, 6.096757709234682, 6.108208221764042, 5.994222342489334, 6.875016994599938, 8.914114007975288, 12.87794302325356, 3.1635647180707838],
    'ratio0_SM as BG [TYPE=BSM]_1sigma-band_dn' : [-4.196192734365196, -4.196192734365196, 0.270599366215224, -1.7204144858586965, -1.352282785706516, -1.1712878675934004, -0.9997784530304049, -0.7498072001375408, -0.4379282680519902, -0.6384354122113485, -0.9229435428268035, -0.48002182696450263, -0.5603977900797839, -0.6406237866051097, -0.9845758157686474, -1.4765614160397245, -1.5686349807487192, -1.981372661359697, -1.7755377143999758, -0.6376800024935404, -4.016846034826757],
    'ratio0_SM as BG [TYPE=BSM]_1sigma-band_up' : [3.6022075523021897, 3.6022075523021897, 14.039291414041479, 9.387579890594306, 7.460280597692058, 6.993282269601308, 6.057063121682744, 6.161551351033073, 6.0278066951130675, 5.749135527055505, 5.095138507468887, 4.880805787599973, 5.745548679891058, 6.398065079711176, 6.096970774768956, 6.108851239688494, 5.994873550260191, 6.875549925082109, 8.914791145328477, 12.879856310631054, 3.1635647180707838],
}